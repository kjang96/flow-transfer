{"episode_reward_max": -669.7979477267415, "episode_reward_min": -7824.252685637549, "episode_reward_mean": -3277.9667107459018, "episode_len_mean": 500.0, "episodes_this_iter": 37, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 5.375385821455807, "mean_processing_ms": 2.1899581828453862, "mean_inference_ms": 0.6957825509676888}, "off_policy_estimator": {}, "info": {"num_steps_trained": 19968, "num_steps_sampled": 20000, "sample_time_ms": 19354.715, "load_time_ms": 64.963, "grad_time_ms": 2813.122, "update_time_ms": 637.28, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 56644.3203125, "policy_loss": -0.0026982282288372517, "vf_loss": 56644.3203125, "vf_explained_var": 1.6407706425525248e-05, "kl": 0.002576468512415886, "entropy": 2.8338589668273926, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 20000, "episodes_total": 37, "training_iteration": 1, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-14-44", "timestamp": 1567224884, "time_this_iter_s": 22.921292304992676, "time_total_s": 22.921292304992676, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 22.921292304992676, "timesteps_since_restore": 20000, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 37.9969696969697, "ram_util_percent": 12.193939393939393}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": -50.59274120541962, "episode_reward_min": -7824.252685637549, "episode_reward_mean": -2672.5261280748773, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 5.039173487038565, "mean_processing_ms": 2.2128276136819984, "mean_inference_ms": 0.6872100198877292}, "off_policy_estimator": {}, "info": {"num_steps_trained": 39936, "num_steps_sampled": 40000, "sample_time_ms": 17448.207, "load_time_ms": 40.632, "grad_time_ms": 2614.792, "update_time_ms": 320.933, "learner": {"default_policy": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 36753.3125, "policy_loss": -0.00536648603156209, "vf_loss": 36753.3203125, "vf_explained_var": 7.0199753281485755e-06, "kl": 0.008545615710318089, "entropy": 2.82539963722229, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 40000, "episodes_total": 76, "training_iteration": 2, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-15-02", "timestamp": 1567224902, "time_this_iter_s": 17.993308067321777, "time_total_s": 40.91460037231445, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 40.91460037231445, "timesteps_since_restore": 40000, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 35.56923076923077, "ram_util_percent": 12.415384615384616}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 27.799426673092, "episode_reward_min": -6514.8337464893975, "episode_reward_mean": -1864.2787427064538, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.729089255255235, "mean_processing_ms": 2.2404654058383473, "mean_inference_ms": 0.6800621295379392}, "off_policy_estimator": {}, "info": {"num_steps_trained": 59904, "num_steps_sampled": 60000, "sample_time_ms": 16155.758, "load_time_ms": 32.515, "grad_time_ms": 2548.938, "update_time_ms": 215.533, "learner": {"default_policy": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 10581.3935546875, "policy_loss": -0.007810916751623154, "vf_loss": 10581.400390625, "vf_explained_var": 5.838962806592463e-06, "kl": 0.010794407688081264, "entropy": 2.8182852268218994, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 60000, "episodes_total": 115, "training_iteration": 3, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-15-18", "timestamp": 1567224918, "time_this_iter_s": 16.02241349220276, "time_total_s": 56.93701386451721, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 56.93701386451721, "timesteps_since_restore": 60000, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 36.15652173913043, "ram_util_percent": 12.417391304347827}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 160.4076826878056, "episode_reward_min": -6348.6875005439615, "episode_reward_mean": -906.563253543442, "episode_len_mean": 500.0, "episodes_this_iter": 42, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.310204787116866, "mean_processing_ms": 2.270138848319811, "mean_inference_ms": 0.6711441819764312}, "off_policy_estimator": {}, "info": {"num_steps_trained": 79872, "num_steps_sampled": 80000, "sample_time_ms": 15595.728, "load_time_ms": 27.648, "grad_time_ms": 2510.7, "update_time_ms": 162.866, "learner": {"default_policy": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 4179.22900390625, "policy_loss": -0.007044043391942978, "vf_loss": 4179.2353515625, "vf_explained_var": 3.1559895887767198e-06, "kl": 0.00687030702829361, "entropy": 2.812143564224243, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 80000, "episodes_total": 157, "training_iteration": 4, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-15-34", "timestamp": 1567224934, "time_this_iter_s": 16.34315800666809, "time_total_s": 73.2801718711853, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 73.2801718711853, "timesteps_since_restore": 80000, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 33.343478260869574, "ram_util_percent": 12.421739130434785}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 160.4076826878056, "episode_reward_min": -4750.56472553273, "episode_reward_mean": -420.92625049467324, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.069239095805605, "mean_processing_ms": 2.2921281911962477, "mean_inference_ms": 0.6656852409031018}, "off_policy_estimator": {}, "info": {"num_steps_trained": 99840, "num_steps_sampled": 100000, "sample_time_ms": 15171.981, "load_time_ms": 24.847, "grad_time_ms": 2488.271, "update_time_ms": 131.205, "learner": {"default_policy": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 3070.5673828125, "policy_loss": -0.007684821728616953, "vf_loss": 3070.574462890625, "vf_explained_var": 2.138507625204511e-06, "kl": 0.010731677524745464, "entropy": 2.794745922088623, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 100000, "episodes_total": 197, "training_iteration": 5, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-15-50", "timestamp": 1567224950, "time_this_iter_s": 15.907852172851562, "time_total_s": 89.18802404403687, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 89.18802404403687, "timesteps_since_restore": 100000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 33.74782608695653, "ram_util_percent": 12.421739130434785}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 160.56938462959116, "episode_reward_min": -2905.5852079267142, "episode_reward_mean": -259.35548773054506, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.8931566617226765, "mean_processing_ms": 2.3073454491649557, "mean_inference_ms": 0.6625202477887236}, "off_policy_estimator": {}, "info": {"num_steps_trained": 119808, "num_steps_sampled": 120000, "sample_time_ms": 14894.415, "load_time_ms": 22.997, "grad_time_ms": 2471.211, "update_time_ms": 110.05, "learner": {"default_policy": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 568.0884399414062, "policy_loss": -0.006020159460604191, "vf_loss": 568.09423828125, "vf_explained_var": 1.2696553994828719e-06, "kl": 0.009602314792573452, "entropy": 2.763580083847046, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 120000, "episodes_total": 238, "training_iteration": 6, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-16-06", "timestamp": 1567224966, "time_this_iter_s": 15.923820495605469, "time_total_s": 105.11184453964233, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 105.11184453964233, "timesteps_since_restore": 120000, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 34.8, "ram_util_percent": 12.409090909090908}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 217.43485627209128, "episode_reward_min": -2309.8513916713678, "episode_reward_mean": -144.6200718435141, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.7788498516002993, "mean_processing_ms": 2.312393341760967, "mean_inference_ms": 0.6606166481306321}, "off_policy_estimator": {}, "info": {"num_steps_trained": 139776, "num_steps_sampled": 140000, "sample_time_ms": 14683.888, "load_time_ms": 21.656, "grad_time_ms": 2460.609, "update_time_ms": 94.974, "learner": {"default_policy": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 723.080322265625, "policy_loss": -0.005046151578426361, "vf_loss": 723.0852661132812, "vf_explained_var": 7.48114700854785e-07, "kl": 0.007819917984306812, "entropy": 2.745593547821045, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 140000, "episodes_total": 278, "training_iteration": 7, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-16-22", "timestamp": 1567224982, "time_this_iter_s": 15.849510431289673, "time_total_s": 120.961354970932, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 120.961354970932, "timesteps_since_restore": 140000, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 33.37391304347826, "ram_util_percent": 12.41304347826087}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 217.43485627209128, "episode_reward_min": -1350.3239138636875, "episode_reward_mean": -63.49420278062999, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.684451227252464, "mean_processing_ms": 2.3187805992745996, "mean_inference_ms": 0.6598548193080426}, "off_policy_estimator": {}, "info": {"num_steps_trained": 159744, "num_steps_sampled": 160000, "sample_time_ms": 14508.927, "load_time_ms": 20.619, "grad_time_ms": 2453.248, "update_time_ms": 83.719, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 341.5758361816406, "policy_loss": -0.005960994865745306, "vf_loss": 341.5816955566406, "vf_explained_var": -3.362313236721093e-07, "kl": 0.006332398392260075, "entropy": 2.747499704360962, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 160000, "episodes_total": 318, "training_iteration": 8, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-16-38", "timestamp": 1567224998, "time_this_iter_s": 15.718453884124756, "time_total_s": 136.67980885505676, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 136.67980885505676, "timesteps_since_restore": 160000, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 34.554545454545455, "ram_util_percent": 12.413636363636364}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 217.43485627209128, "episode_reward_min": -831.337946394005, "episode_reward_mean": 5.788816772626148, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.6269625206289935, "mean_processing_ms": 2.320830578054721, "mean_inference_ms": 0.6597494808380203}, "off_policy_estimator": {}, "info": {"num_steps_trained": 179712, "num_steps_sampled": 180000, "sample_time_ms": 14387.654, "load_time_ms": 19.93, "grad_time_ms": 2447.439, "update_time_ms": 74.983, "learner": {"default_policy": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 389.9443054199219, "policy_loss": -0.0053433324210345745, "vf_loss": 389.9496154785156, "vf_explained_var": -1.2669808029386331e-06, "kl": 0.008013276383280754, "entropy": 2.747073173522949, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 180000, "episodes_total": 358, "training_iteration": 9, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-16-53", "timestamp": 1567225013, "time_this_iter_s": 15.85144329071045, "time_total_s": 152.5312521457672, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 152.5312521457672, "timesteps_since_restore": 180000, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 34.66956521739131, "ram_util_percent": 12.41304347826087}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 238.27227699910924, "episode_reward_min": -831.337946394005, "episode_reward_mean": 13.988256046632817, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.5971637340016342, "mean_processing_ms": 2.324374738569536, "mean_inference_ms": 0.6599201025124037}, "off_policy_estimator": {}, "info": {"num_steps_trained": 199680, "num_steps_sampled": 200000, "sample_time_ms": 14314.628, "load_time_ms": 19.286, "grad_time_ms": 2442.133, "update_time_ms": 67.949, "learner": {"default_policy": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 415.4540710449219, "policy_loss": -0.006596290972083807, "vf_loss": 415.4606628417969, "vf_explained_var": -4.218174751713377e-07, "kl": 0.008443932048976421, "entropy": 2.738208532333374, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 200000, "episodes_total": 398, "training_iteration": 10, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-17-10", "timestamp": 1567225030, "time_this_iter_s": 16.083189010620117, "time_total_s": 168.61444115638733, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 168.61444115638733, "timesteps_since_restore": 200000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 34.85652173913043, "ram_util_percent": 12.41304347826087}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 238.27227699910924, "episode_reward_min": -581.522498617002, "episode_reward_mean": 32.158464871198106, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.569306458228026, "mean_processing_ms": 2.3257648809772125, "mean_inference_ms": 0.6604222545099894}, "off_policy_estimator": {}, "info": {"num_steps_trained": 219648, "num_steps_sampled": 220000, "sample_time_ms": 13746.431, "load_time_ms": 14.135, "grad_time_ms": 2400.115, "update_time_ms": 4.681, "learner": {"default_policy": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 292.4892272949219, "policy_loss": -0.008668011985719204, "vf_loss": 292.4978942871094, "vf_explained_var": 0.1453736573457718, "kl": 0.01162678748369217, "entropy": 2.74226713180542, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 220000, "episodes_total": 438, "training_iteration": 11, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-17-26", "timestamp": 1567225046, "time_this_iter_s": 16.097291707992554, "time_total_s": 184.71173286437988, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 184.71173286437988, "timesteps_since_restore": 220000, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 35.24347826086956, "ram_util_percent": 12.417391304347827}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 243.49647079510632, "episode_reward_min": -581.522498617002, "episode_reward_mean": 51.850412957133805, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.549621206632356, "mean_processing_ms": 2.326696793750312, "mean_inference_ms": 0.6611491319961434}, "off_policy_estimator": {}, "info": {"num_steps_trained": 239616, "num_steps_sampled": 240000, "sample_time_ms": 13569.915, "load_time_ms": 13.858, "grad_time_ms": 2398.458, "update_time_ms": 4.703, "learner": {"default_policy": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 326.5409240722656, "policy_loss": -0.007181417662650347, "vf_loss": 326.5480651855469, "vf_explained_var": 0.24567805230617523, "kl": 0.01052865944802761, "entropy": 2.704136848449707, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 240000, "episodes_total": 478, "training_iteration": 12, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-17-42", "timestamp": 1567225062, "time_this_iter_s": 16.208476543426514, "time_total_s": 200.9202094078064, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 200.9202094078064, "timesteps_since_restore": 240000, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 34.97391304347827, "ram_util_percent": 12.41304347826087}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 243.49647079510632, "episode_reward_min": -304.5688494438782, "episode_reward_mean": 98.85453491919317, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.5173896179584028, "mean_processing_ms": 2.3288210713712774, "mean_inference_ms": 0.6617746926331622}, "off_policy_estimator": {}, "info": {"num_steps_trained": 259584, "num_steps_sampled": 260000, "sample_time_ms": 13556.536, "load_time_ms": 13.619, "grad_time_ms": 2395.965, "update_time_ms": 4.771, "learner": {"default_policy": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 117.62334442138672, "policy_loss": -0.013589776121079922, "vf_loss": 117.63694763183594, "vf_explained_var": 0.26250940561294556, "kl": 0.013317770324647427, "entropy": 2.691685914993286, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 260000, "episodes_total": 518, "training_iteration": 13, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-17-58", "timestamp": 1567225078, "time_this_iter_s": 15.862236738204956, "time_total_s": 216.78244614601135, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 216.78244614601135, "timesteps_since_restore": 260000, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 34.82173913043478, "ram_util_percent": 12.417391304347827}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 262.2725418081556, "episode_reward_min": -1110.189302565276, "episode_reward_mean": 125.96667575505029, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.5064834705582326, "mean_processing_ms": 2.328777121112584, "mean_inference_ms": 0.6618166789152785}, "off_policy_estimator": {}, "info": {"num_steps_trained": 279552, "num_steps_sampled": 280000, "sample_time_ms": 13510.528, "load_time_ms": 13.659, "grad_time_ms": 2396.332, "update_time_ms": 4.769, "learner": {"default_policy": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 472.114990234375, "policy_loss": -0.01032080315053463, "vf_loss": 472.12530517578125, "vf_explained_var": 0.23726524412631989, "kl": 0.01528586819767952, "entropy": 2.671846866607666, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 280000, "episodes_total": 558, "training_iteration": 14, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-18-14", "timestamp": 1567225094, "time_this_iter_s": 15.886910915374756, "time_total_s": 232.6693570613861, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 232.6693570613861, "timesteps_since_restore": 280000, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 36.15, "ram_util_percent": 12.413636363636364}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 296.8144552930148, "episode_reward_min": -1110.189302565276, "episode_reward_mean": 157.0842056399872, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.4940951176606747, "mean_processing_ms": 2.329683227385356, "mean_inference_ms": 0.6618722889048899}, "off_policy_estimator": {}, "info": {"num_steps_trained": 299520, "num_steps_sampled": 300000, "sample_time_ms": 13504.69, "load_time_ms": 13.613, "grad_time_ms": 2396.557, "update_time_ms": 4.798, "learner": {"default_policy": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 154.45042419433594, "policy_loss": -0.009370082058012486, "vf_loss": 154.4597930908203, "vf_explained_var": 0.12869389355182648, "kl": 0.013586267828941345, "entropy": 2.641162157058716, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 300000, "episodes_total": 598, "training_iteration": 15, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-18-29", "timestamp": 1567225109, "time_this_iter_s": 15.851985216140747, "time_total_s": 248.52134227752686, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 248.52134227752686, "timesteps_since_restore": 300000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 34.61739130434783, "ram_util_percent": 12.417391304347827}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 296.8144552930148, "episode_reward_min": 7.8679154961253515, "episode_reward_mean": 201.17627624401266, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.482115875858518, "mean_processing_ms": 2.3293030236585013, "mean_inference_ms": 0.6618009471363971}, "off_policy_estimator": {}, "info": {"num_steps_trained": 319488, "num_steps_sampled": 320000, "sample_time_ms": 13489.394, "load_time_ms": 13.609, "grad_time_ms": 2396.91, "update_time_ms": 4.821, "learner": {"default_policy": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 194.92730712890625, "policy_loss": -0.008341834880411625, "vf_loss": 194.93563842773438, "vf_explained_var": 0.06524336338043213, "kl": 0.009902489371597767, "entropy": 2.611152410507202, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 320000, "episodes_total": 637, "training_iteration": 16, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-18-45", "timestamp": 1567225125, "time_this_iter_s": 15.775613069534302, "time_total_s": 264.29695534706116, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 264.29695534706116, "timesteps_since_restore": 320000, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 35.42727272727273, "ram_util_percent": 12.413636363636364}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 299.81815701936705, "episode_reward_min": 7.8679154961253515, "episode_reward_mean": 222.22475132450094, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.466893688082214, "mean_processing_ms": 2.3297592302755654, "mean_inference_ms": 0.6613553259936386}, "off_policy_estimator": {}, "info": {"num_steps_trained": 339456, "num_steps_sampled": 340000, "sample_time_ms": 13482.891, "load_time_ms": 13.595, "grad_time_ms": 2397.323, "update_time_ms": 4.843, "learner": {"default_policy": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 170.89346313476562, "policy_loss": -0.0062497020699083805, "vf_loss": 170.89971923828125, "vf_explained_var": 0.014928264543414116, "kl": 0.007172361947596073, "entropy": 2.593574047088623, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 340000, "episodes_total": 678, "training_iteration": 17, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-19-01", "timestamp": 1567225141, "time_this_iter_s": 15.788771152496338, "time_total_s": 280.0857264995575, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 280.0857264995575, "timesteps_since_restore": 340000, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 33.67826086956523, "ram_util_percent": 12.41304347826087}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 318.77957339855055, "episode_reward_min": 131.1883169126698, "episode_reward_mean": 234.81875096982273, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.44058752684273, "mean_processing_ms": 2.328678414883064, "mean_inference_ms": 0.6611017724346102}, "off_policy_estimator": {}, "info": {"num_steps_trained": 359424, "num_steps_sampled": 360000, "sample_time_ms": 13478.197, "load_time_ms": 13.803, "grad_time_ms": 2396.014, "update_time_ms": 4.826, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 180.2200164794922, "policy_loss": -0.008119570091366768, "vf_loss": 180.22813415527344, "vf_explained_var": 0.00509638711810112, "kl": 0.013131138868629932, "entropy": 2.5602478981018066, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 360000, "episodes_total": 717, "training_iteration": 18, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-19-17", "timestamp": 1567225157, "time_this_iter_s": 15.659416198730469, "time_total_s": 295.74514269828796, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 295.74514269828796, "timesteps_since_restore": 360000, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 35.25454545454546, "ram_util_percent": 12.413636363636364}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 335.7525436648054, "episode_reward_min": 131.1883169126698, "episode_reward_mean": 244.42576746256552, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.4243091685999834, "mean_processing_ms": 2.3295474993051144, "mean_inference_ms": 0.6611110682122963}, "off_policy_estimator": {}, "info": {"num_steps_trained": 379392, "num_steps_sampled": 380000, "sample_time_ms": 13468.744, "load_time_ms": 13.686, "grad_time_ms": 2395.261, "update_time_ms": 4.807, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 192.1621856689453, "policy_loss": -0.010155257768929005, "vf_loss": 192.17234802246094, "vf_explained_var": 0.004697851836681366, "kl": 0.020573338493704796, "entropy": 2.548008918762207, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 380000, "episodes_total": 758, "training_iteration": 19, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-19-32", "timestamp": 1567225172, "time_this_iter_s": 15.747989177703857, "time_total_s": 311.4931318759918, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 311.4931318759918, "timesteps_since_restore": 380000, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 34.778260869565216, "ram_util_percent": 12.430434782608694}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 362.08713068780986, "episode_reward_min": 114.29759093087539, "episode_reward_mean": 252.07451627423862, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.4136497617201407, "mean_processing_ms": 2.330889662119223, "mean_inference_ms": 0.6609496198039508}, "off_policy_estimator": {}, "info": {"num_steps_trained": 399360, "num_steps_sampled": 400000, "sample_time_ms": 13395.74, "load_time_ms": 13.64, "grad_time_ms": 2395.675, "update_time_ms": 4.808, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 208.37831115722656, "policy_loss": -0.006980944890528917, "vf_loss": 208.3852996826172, "vf_explained_var": 0.003768742782995105, "kl": 0.010381422005593777, "entropy": 2.528489828109741, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 400000, "episodes_total": 797, "training_iteration": 20, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-19-48", "timestamp": 1567225188, "time_this_iter_s": 15.357152223587036, "time_total_s": 326.85028409957886, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 326.85028409957886, "timesteps_since_restore": 400000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 35.190909090909095, "ram_util_percent": 12.41818181818182}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 367.1862829353544, "episode_reward_min": 66.00845772546784, "episode_reward_mean": 254.83080716534707, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.3967743045185324, "mean_processing_ms": 2.330855785769757, "mean_inference_ms": 0.6607337392223812}, "off_policy_estimator": {}, "info": {"num_steps_trained": 419328, "num_steps_sampled": 420000, "sample_time_ms": 13336.933, "load_time_ms": 13.68, "grad_time_ms": 2395.947, "update_time_ms": 4.875, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 207.9269256591797, "policy_loss": -0.007242243271321058, "vf_loss": 207.9341583251953, "vf_explained_var": 0.006733690854161978, "kl": 0.011091149412095547, "entropy": 2.5212581157684326, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 420000, "episodes_total": 837, "training_iteration": 21, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-20-03", "timestamp": 1567225203, "time_this_iter_s": 15.513383865356445, "time_total_s": 342.3636679649353, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 342.3636679649353, "timesteps_since_restore": 420000, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 34.40909090909091, "ram_util_percent": 12.422727272727274}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 367.1862829353544, "episode_reward_min": 66.00845772546784, "episode_reward_mean": 262.91074270154496, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.387612893151365, "mean_processing_ms": 2.3322718322840243, "mean_inference_ms": 0.6602711823454362}, "off_policy_estimator": {}, "info": {"num_steps_trained": 439296, "num_steps_sampled": 440000, "sample_time_ms": 13272.791, "load_time_ms": 13.667, "grad_time_ms": 2393.953, "update_time_ms": 4.871, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 214.32894897460938, "policy_loss": -0.006939427927136421, "vf_loss": 214.3358917236328, "vf_explained_var": 0.0036838483065366745, "kl": 0.011625082232058048, "entropy": 2.4647021293640137, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 440000, "episodes_total": 878, "training_iteration": 22, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-20-19", "timestamp": 1567225219, "time_this_iter_s": 15.546822309494019, "time_total_s": 357.9104902744293, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 357.9104902744293, "timesteps_since_restore": 440000, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 33.43636363636364, "ram_util_percent": 12.41818181818182}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 348.949950730972, "episode_reward_min": 192.39338495997725, "episode_reward_mean": 273.2416118431671, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.3694584951480544, "mean_processing_ms": 2.3334421445469418, "mean_inference_ms": 0.6598436624607076}, "off_policy_estimator": {}, "info": {"num_steps_trained": 459264, "num_steps_sampled": 460000, "sample_time_ms": 13237.83, "load_time_ms": 13.592, "grad_time_ms": 2394.077, "update_time_ms": 4.883, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 220.23452758789062, "policy_loss": -0.007171532139182091, "vf_loss": 220.24168395996094, "vf_explained_var": 0.0016747965710237622, "kl": 0.011354072019457817, "entropy": 2.4363880157470703, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 460000, "episodes_total": 919, "training_iteration": 23, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-20-34", "timestamp": 1567225234, "time_this_iter_s": 15.513205766677856, "time_total_s": 373.4236960411072, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 373.4236960411072, "timesteps_since_restore": 460000, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 33.37272727272727, "ram_util_percent": 12.431818181818182}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 363.9512029136114, "episode_reward_min": 206.50358482609462, "episode_reward_mean": 277.28864322347096, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.352456672892619, "mean_processing_ms": 2.3343302468282072, "mean_inference_ms": 0.6597219324993313}, "off_policy_estimator": {}, "info": {"num_steps_trained": 479232, "num_steps_sampled": 480000, "sample_time_ms": 13199.109, "load_time_ms": 13.603, "grad_time_ms": 2393.666, "update_time_ms": 4.845, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 230.96890258789062, "policy_loss": -0.009574014693498611, "vf_loss": 230.97848510742188, "vf_explained_var": 0.0012879386777058244, "kl": 0.023098329082131386, "entropy": 2.420856475830078, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 480000, "episodes_total": 958, "training_iteration": 24, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-20-50", "timestamp": 1567225250, "time_this_iter_s": 15.496116876602173, "time_total_s": 388.91981291770935, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 388.91981291770935, "timesteps_since_restore": 480000, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 33.65, "ram_util_percent": 12.42727272727273}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 363.9512029136114, "episode_reward_min": 226.2590152169866, "episode_reward_mean": 281.14004166707315, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.3376309852871744, "mean_processing_ms": 2.334897663312492, "mean_inference_ms": 0.6595049121522084}, "off_policy_estimator": {}, "info": {"num_steps_trained": 499200, "num_steps_sampled": 500000, "sample_time_ms": 13157.382, "load_time_ms": 13.6, "grad_time_ms": 2393.721, "update_time_ms": 4.915, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 233.61764526367188, "policy_loss": -0.008219555951654911, "vf_loss": 233.6258544921875, "vf_explained_var": 0.0012805768055841327, "kl": 0.024664001539349556, "entropy": 2.4397356510162354, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 500000, "episodes_total": 999, "training_iteration": 25, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-21-05", "timestamp": 1567225265, "time_this_iter_s": 15.435735702514648, "time_total_s": 404.355548620224, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 404.355548620224, "timesteps_since_restore": 500000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 33.268181818181816, "ram_util_percent": 12.431818181818182}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 363.9512029136114, "episode_reward_min": 214.4874295611815, "episode_reward_mean": 283.0349846369513, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.32362161490473, "mean_processing_ms": 2.3345442956244407, "mean_inference_ms": 0.6597143553948979}, "off_policy_estimator": {}, "info": {"num_steps_trained": 519168, "num_steps_sampled": 520000, "sample_time_ms": 13135.742, "load_time_ms": 13.554, "grad_time_ms": 2394.046, "update_time_ms": 4.902, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 240.1940155029297, "policy_loss": -0.006955461576581001, "vf_loss": 240.2009735107422, "vf_explained_var": 0.001487765577621758, "kl": 0.012676790356636047, "entropy": 2.42855167388916, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 520000, "episodes_total": 1038, "training_iteration": 26, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-21-21", "timestamp": 1567225281, "time_this_iter_s": 15.56181287765503, "time_total_s": 419.917361497879, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 419.917361497879, "timesteps_since_restore": 520000, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 34.05909090909091, "ram_util_percent": 12.445454545454545}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 359.98083933633546, "episode_reward_min": 214.4874295611815, "episode_reward_mean": 287.16305780142653, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.3100003756748735, "mean_processing_ms": 2.334585118735276, "mean_inference_ms": 0.6598641770600387}, "off_policy_estimator": {}, "info": {"num_steps_trained": 539136, "num_steps_sampled": 540000, "sample_time_ms": 13089.338, "load_time_ms": 13.507, "grad_time_ms": 2392.41, "update_time_ms": 4.989, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 246.65652465820312, "policy_loss": -0.006757210474461317, "vf_loss": 246.6632843017578, "vf_explained_var": 0.000783515686634928, "kl": 0.009814856573939323, "entropy": 2.396075963973999, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 540000, "episodes_total": 1079, "training_iteration": 27, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-21-36", "timestamp": 1567225296, "time_this_iter_s": 15.308408498764038, "time_total_s": 435.22576999664307, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 435.22576999664307, "timesteps_since_restore": 540000, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 33.46363636363637, "ram_util_percent": 12.45}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 362.8406738123137, "episode_reward_min": 214.4874295611815, "episode_reward_mean": 289.3565497004991, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.298036974639083, "mean_processing_ms": 2.3342266363349466, "mean_inference_ms": 0.6601792273612513}, "off_policy_estimator": {}, "info": {"num_steps_trained": 559104, "num_steps_sampled": 560000, "sample_time_ms": 13053.948, "load_time_ms": 13.29, "grad_time_ms": 2392.213, "update_time_ms": 4.99, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 250.14273071289062, "policy_loss": -0.009920615702867508, "vf_loss": 250.15264892578125, "vf_explained_var": 0.0016669478500261903, "kl": 0.02173580229282379, "entropy": 2.4112589359283447, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 560000, "episodes_total": 1118, "training_iteration": 28, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-21-52", "timestamp": 1567225312, "time_this_iter_s": 15.301743030548096, "time_total_s": 450.52751302719116, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 450.52751302719116, "timesteps_since_restore": 560000, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 34.08181818181818, "ram_util_percent": 12.454545454545455}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 377.76634605922715, "episode_reward_min": 231.01238294359786, "episode_reward_mean": 295.39715250797974, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.288258010916887, "mean_processing_ms": 2.333986053692485, "mean_inference_ms": 0.6604640337582863}, "off_policy_estimator": {}, "info": {"num_steps_trained": 579072, "num_steps_sampled": 580000, "sample_time_ms": 13040.762, "load_time_ms": 13.28, "grad_time_ms": 2392.83, "update_time_ms": 5.004, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 270.1507873535156, "policy_loss": -0.008199312724173069, "vf_loss": 270.15899658203125, "vf_explained_var": 0.0010985812405124307, "kl": 0.026771778240799904, "entropy": 2.3942675590515137, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 580000, "episodes_total": 1158, "training_iteration": 29, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-22-07", "timestamp": 1567225327, "time_this_iter_s": 15.62253713607788, "time_total_s": 466.15005016326904, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 466.15005016326904, "timesteps_since_restore": 580000, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 34.52727272727273, "ram_util_percent": 12.45}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 385.1806314595819, "episode_reward_min": 231.01238294359786, "episode_reward_mean": 303.5177476600362, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.2903563931499296, "mean_processing_ms": 2.3338177762126757, "mean_inference_ms": 0.6611247271959156}, "off_policy_estimator": {}, "info": {"num_steps_trained": 599040, "num_steps_sampled": 600000, "sample_time_ms": 13070.442, "load_time_ms": 13.327, "grad_time_ms": 2391.666, "update_time_ms": 4.96, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 276.9504699707031, "policy_loss": -0.00908659864217043, "vf_loss": 276.95953369140625, "vf_explained_var": 0.0008309234981425107, "kl": 0.03169247880578041, "entropy": 2.40716552734375, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 600000, "episodes_total": 1198, "training_iteration": 30, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-22-23", "timestamp": 1567225343, "time_this_iter_s": 15.642462253570557, "time_total_s": 481.7925124168396, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 481.7925124168396, "timesteps_since_restore": 600000, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 34.073913043478264, "ram_util_percent": 12.47826086956522}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 385.1806314595819, "episode_reward_min": 225.40553583236607, "episode_reward_mean": 312.64744194868763, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.284312100557439, "mean_processing_ms": 2.3339870267024008, "mean_inference_ms": 0.6614062403090023}, "off_policy_estimator": {}, "info": {"num_steps_trained": 619008, "num_steps_sampled": 620000, "sample_time_ms": 13079.021, "load_time_ms": 13.306, "grad_time_ms": 2394.213, "update_time_ms": 4.943, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 288.9265441894531, "policy_loss": -0.007089406251907349, "vf_loss": 288.93365478515625, "vf_explained_var": 0.006357430014759302, "kl": 0.01271781139075756, "entropy": 2.371980667114258, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 620000, "episodes_total": 1238, "training_iteration": 31, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-22-39", "timestamp": 1567225359, "time_this_iter_s": 15.624025106430054, "time_total_s": 497.41653752326965, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 497.41653752326965, "timesteps_since_restore": 620000, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 33.72272727272727, "ram_util_percent": 12.477272727272727}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 406.5345072962672, "episode_reward_min": 225.40553583236607, "episode_reward_mean": 319.60106274222784, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.2765887352709537, "mean_processing_ms": 2.334343416238276, "mean_inference_ms": 0.6614192981272644}, "off_policy_estimator": {}, "info": {"num_steps_trained": 638976, "num_steps_sampled": 640000, "sample_time_ms": 13056.825, "load_time_ms": 13.296, "grad_time_ms": 2396.16, "update_time_ms": 4.909, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 303.43609619140625, "policy_loss": -0.0068570757284760475, "vf_loss": 303.4429626464844, "vf_explained_var": 0.003717455780133605, "kl": 0.014431742951273918, "entropy": 2.3696999549865723, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 640000, "episodes_total": 1278, "training_iteration": 32, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-22-54", "timestamp": 1567225374, "time_this_iter_s": 15.34389328956604, "time_total_s": 512.7604308128357, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 512.7604308128357, "timesteps_since_restore": 640000, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 33.48636363636364, "ram_util_percent": 12.45909090909091}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 406.5345072962672, "episode_reward_min": 259.0963354981185, "episode_reward_mean": 326.6770267689367, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.267404986526692, "mean_processing_ms": 2.334592012691023, "mean_inference_ms": 0.6615520638555978}, "off_policy_estimator": {}, "info": {"num_steps_trained": 658944, "num_steps_sampled": 660000, "sample_time_ms": 13042.708, "load_time_ms": 13.34, "grad_time_ms": 2396.434, "update_time_ms": 4.833, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 316.4583740234375, "policy_loss": -0.0062410468235611916, "vf_loss": 316.464599609375, "vf_explained_var": 0.0002578015555627644, "kl": 0.01757279969751835, "entropy": 2.3649494647979736, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 660000, "episodes_total": 1318, "training_iteration": 33, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-23-09", "timestamp": 1567225389, "time_this_iter_s": 15.37458848953247, "time_total_s": 528.1350193023682, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 528.1350193023682, "timesteps_since_restore": 660000, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 33.88636363636363, "ram_util_percent": 12.481818181818182}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 401.29981346800054, "episode_reward_min": 265.32885933360717, "episode_reward_mean": 330.4204660023544, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.258383452509172, "mean_processing_ms": 2.3346607070223473, "mean_inference_ms": 0.6616712519021547}, "off_policy_estimator": {}, "info": {"num_steps_trained": 678912, "num_steps_sampled": 680000, "sample_time_ms": 13018.731, "load_time_ms": 13.834, "grad_time_ms": 2395.847, "update_time_ms": 4.853, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 323.6359558105469, "policy_loss": -0.00659699784591794, "vf_loss": 323.642578125, "vf_explained_var": 0.012480010278522968, "kl": 0.012414957396686077, "entropy": 2.3388285636901855, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 680000, "episodes_total": 1358, "training_iteration": 34, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-23-25", "timestamp": 1567225405, "time_this_iter_s": 15.255047082901001, "time_total_s": 543.3900663852692, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 543.3900663852692, "timesteps_since_restore": 680000, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 33.28636363636364, "ram_util_percent": 12.500000000000002}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 406.2769297126739, "episode_reward_min": 261.647466392432, "episode_reward_mean": 331.4533840396752, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.2497914458248984, "mean_processing_ms": 2.3346981464652146, "mean_inference_ms": 0.6616323669563188}, "off_policy_estimator": {}, "info": {"num_steps_trained": 698880, "num_steps_sampled": 700000, "sample_time_ms": 12989.439, "load_time_ms": 13.849, "grad_time_ms": 2395.929, "update_time_ms": 4.736, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 322.5611572265625, "policy_loss": -0.006068404298275709, "vf_loss": 322.56719970703125, "vf_explained_var": 0.025414230301976204, "kl": 0.01636883243918419, "entropy": 2.3024399280548096, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 700000, "episodes_total": 1398, "training_iteration": 35, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-23-40", "timestamp": 1567225420, "time_this_iter_s": 15.141944169998169, "time_total_s": 558.5320105552673, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 558.5320105552673, "timesteps_since_restore": 700000, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 34.476190476190474, "ram_util_percent": 12.49047619047619}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 406.7917459355306, "episode_reward_min": 261.647466392432, "episode_reward_mean": 332.1833628906866, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.2416005113665367, "mean_processing_ms": 2.334774526934628, "mean_inference_ms": 0.6614610187292267}, "off_policy_estimator": {}, "info": {"num_steps_trained": 718848, "num_steps_sampled": 720000, "sample_time_ms": 12950.607, "load_time_ms": 13.839, "grad_time_ms": 2395.473, "update_time_ms": 4.77, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 323.1942138671875, "policy_loss": -0.008878719992935658, "vf_loss": 323.203125, "vf_explained_var": 0.04101123660802841, "kl": 0.03377222269773483, "entropy": 2.3518917560577393, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 720000, "episodes_total": 1438, "training_iteration": 36, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-23-55", "timestamp": 1567225435, "time_this_iter_s": 15.173828363418579, "time_total_s": 573.7058389186859, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 573.7058389186859, "timesteps_since_restore": 720000, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 33.39090909090909, "ram_util_percent": 12.5}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 410.960770772945, "episode_reward_min": 250.43238548758146, "episode_reward_mean": 331.7168345890778, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.2339826349965994, "mean_processing_ms": 2.334870004502231, "mean_inference_ms": 0.6612810294375034}, "off_policy_estimator": {}, "info": {"num_steps_trained": 738816, "num_steps_sampled": 740000, "sample_time_ms": 12960.438, "load_time_ms": 13.858, "grad_time_ms": 2397.49, "update_time_ms": 4.676, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 326.06439208984375, "policy_loss": -0.008530511520802975, "vf_loss": 326.07293701171875, "vf_explained_var": 0.0590214841067791, "kl": 0.03191212937235832, "entropy": 2.380183219909668, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 740000, "episodes_total": 1478, "training_iteration": 37, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-24-10", "timestamp": 1567225450, "time_this_iter_s": 15.426305532455444, "time_total_s": 589.1321444511414, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 589.1321444511414, "timesteps_since_restore": 740000, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 33.345454545454544, "ram_util_percent": 12.509090909090911}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 410.960770772945, "episode_reward_min": 250.43238548758146, "episode_reward_mean": 329.3404809904878, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.226538619958947, "mean_processing_ms": 2.3350027158726783, "mean_inference_ms": 0.6610621476873969}, "off_policy_estimator": {}, "info": {"num_steps_trained": 758784, "num_steps_sampled": 760000, "sample_time_ms": 12935.471, "load_time_ms": 13.86, "grad_time_ms": 2399.745, "update_time_ms": 4.637, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 323.55865478515625, "policy_loss": -0.005434168968349695, "vf_loss": 323.5640869140625, "vf_explained_var": 0.08136113733053207, "kl": 0.0169419776648283, "entropy": 2.383852481842041, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 760000, "episodes_total": 1518, "training_iteration": 38, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-24-25", "timestamp": 1567225465, "time_this_iter_s": 15.075137615203857, "time_total_s": 604.2072820663452, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 604.2072820663452, "timesteps_since_restore": 760000, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 34.8047619047619, "ram_util_percent": 12.5}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 410.5120029359797, "episode_reward_min": 239.44975681140153, "episode_reward_mean": 323.3080626988677, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.2194286019954133, "mean_processing_ms": 2.3351778436258943, "mean_inference_ms": 0.6609512659565793}, "off_policy_estimator": {}, "info": {"num_steps_trained": 778752, "num_steps_sampled": 780000, "sample_time_ms": 12867.205, "load_time_ms": 13.895, "grad_time_ms": 2400.353, "update_time_ms": 4.572, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 313.1584167480469, "policy_loss": -0.004564533941447735, "vf_loss": 313.1629638671875, "vf_explained_var": 0.0920022577047348, "kl": 0.010962339118123055, "entropy": 2.3625688552856445, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 780000, "episodes_total": 1558, "training_iteration": 39, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-24-40", "timestamp": 1567225480, "time_this_iter_s": 14.946961164474487, "time_total_s": 619.1542432308197, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 619.1542432308197, "timesteps_since_restore": 780000, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 34.14090909090908, "ram_util_percent": 12.509090909090911}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 410.5120029359797, "episode_reward_min": 239.44975681140153, "episode_reward_mean": 318.5022985791353, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.217619237055112, "mean_processing_ms": 2.3359833864405357, "mean_inference_ms": 0.6611080597071939}, "off_policy_estimator": {}, "info": {"num_steps_trained": 798720, "num_steps_sampled": 800000, "sample_time_ms": 12858.208, "load_time_ms": 13.889, "grad_time_ms": 2401.623, "update_time_ms": 4.661, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 318.56414794921875, "policy_loss": -0.005991898477077484, "vf_loss": 318.5700988769531, "vf_explained_var": 0.11232467740774155, "kl": 0.019389677792787552, "entropy": 2.355454444885254, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 800000, "episodes_total": 1599, "training_iteration": 40, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-24-56", "timestamp": 1567225496, "time_this_iter_s": 15.566711664199829, "time_total_s": 634.7209548950195, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 634.7209548950195, "timesteps_since_restore": 800000, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 33.16818181818183, "ram_util_percent": 12.513636363636364}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 422.21852833586473, "episode_reward_min": 212.52566385427323, "episode_reward_mean": 312.6615311415863, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.2122307410477138, "mean_processing_ms": 2.3367515098034186, "mean_inference_ms": 0.6614547028862744}, "off_policy_estimator": {}, "info": {"num_steps_trained": 818688, "num_steps_sampled": 820000, "sample_time_ms": 12842.545, "load_time_ms": 13.818, "grad_time_ms": 2398.845, "update_time_ms": 4.695, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 308.6360168457031, "policy_loss": -0.005499638617038727, "vf_loss": 308.6414794921875, "vf_explained_var": 0.12752744555473328, "kl": 0.00949480477720499, "entropy": 2.3559532165527344, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 820000, "episodes_total": 1639, "training_iteration": 41, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-25-11", "timestamp": 1567225511, "time_this_iter_s": 15.44075083732605, "time_total_s": 650.1617057323456, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 650.1617057323456, "timesteps_since_restore": 820000, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 35.17272727272727, "ram_util_percent": 12.495454545454548}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 430.9394912038441, "episode_reward_min": 201.80972968402733, "episode_reward_mean": 310.99518382724403, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.2043223962990193, "mean_processing_ms": 2.337128959549309, "mean_inference_ms": 0.661876801260545}, "off_policy_estimator": {}, "info": {"num_steps_trained": 838656, "num_steps_sampled": 840000, "sample_time_ms": 12884.222, "load_time_ms": 13.813, "grad_time_ms": 2398.951, "update_time_ms": 4.724, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 311.0221862792969, "policy_loss": -0.005588768515735865, "vf_loss": 311.0278015136719, "vf_explained_var": 0.12243825942277908, "kl": 0.012326864525675774, "entropy": 2.3333611488342285, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 840000, "episodes_total": 1679, "training_iteration": 42, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-25-27", "timestamp": 1567225527, "time_this_iter_s": 15.761900663375854, "time_total_s": 665.9236063957214, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 665.9236063957214, "timesteps_since_restore": 840000, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 35.381818181818176, "ram_util_percent": 12.509090909090911}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 430.9394912038441, "episode_reward_min": 201.80972968402733, "episode_reward_mean": 315.2483288889986, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.2022298241077634, "mean_processing_ms": 2.3372219837606547, "mean_inference_ms": 0.6624326457586356}, "off_policy_estimator": {}, "info": {"num_steps_trained": 858624, "num_steps_sampled": 860000, "sample_time_ms": 12914.014, "load_time_ms": 13.799, "grad_time_ms": 2398.261, "update_time_ms": 4.708, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 321.4248962402344, "policy_loss": -0.005988754332065582, "vf_loss": 321.4308776855469, "vf_explained_var": 0.1242637038230896, "kl": 0.012414904311299324, "entropy": 2.358487129211426, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 860000, "episodes_total": 1719, "training_iteration": 43, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-25-43", "timestamp": 1567225543, "time_this_iter_s": 15.665461540222168, "time_total_s": 681.5890679359436, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 681.5890679359436, "timesteps_since_restore": 860000, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 33.79565217391304, "ram_util_percent": 12.504347826086958}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 423.6506053964383, "episode_reward_min": 224.02653208933017, "episode_reward_mean": 316.8590529030158, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.194727503581211, "mean_processing_ms": 2.337325986468488, "mean_inference_ms": 0.662782030627612}, "off_policy_estimator": {}, "info": {"num_steps_trained": 878592, "num_steps_sampled": 880000, "sample_time_ms": 12943.909, "load_time_ms": 13.297, "grad_time_ms": 2399.072, "update_time_ms": 4.705, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 324.3138122558594, "policy_loss": -0.00712913041934371, "vf_loss": 324.3209228515625, "vf_explained_var": 0.13257324695587158, "kl": 0.019231971353292465, "entropy": 2.3458755016326904, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 880000, "episodes_total": 1759, "training_iteration": 44, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-25-58", "timestamp": 1567225558, "time_this_iter_s": 15.557754755020142, "time_total_s": 697.1468226909637, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 697.1468226909637, "timesteps_since_restore": 880000, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 34.87272727272728, "ram_util_percent": 12.509090909090911}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 423.6506053964383, "episode_reward_min": 190.10549862585574, "episode_reward_mean": 317.4599946791413, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.192431101238048, "mean_processing_ms": 2.3373383863688075, "mean_inference_ms": 0.6631874647753129}, "off_policy_estimator": {}, "info": {"num_steps_trained": 898560, "num_steps_sampled": 900000, "sample_time_ms": 12984.138, "load_time_ms": 13.303, "grad_time_ms": 2399.157, "update_time_ms": 4.712, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 331.7153015136719, "policy_loss": -0.005828534718602896, "vf_loss": 331.7211608886719, "vf_explained_var": 0.13172228634357452, "kl": 0.016724785789847374, "entropy": 2.312649965286255, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 900000, "episodes_total": 1799, "training_iteration": 45, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-26-14", "timestamp": 1567225574, "time_this_iter_s": 15.545958995819092, "time_total_s": 712.6927816867828, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 712.6927816867828, "timesteps_since_restore": 900000, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 35.07727272727273, "ram_util_percent": 12.504545454545456}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 423.6506053964383, "episode_reward_min": 190.10549862585574, "episode_reward_mean": 318.4106418385982, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1954767587329242, "mean_processing_ms": 2.3374619694285665, "mean_inference_ms": 0.6638874089621919}, "off_policy_estimator": {}, "info": {"num_steps_trained": 918528, "num_steps_sampled": 920000, "sample_time_ms": 13013.425, "load_time_ms": 13.292, "grad_time_ms": 2400.23, "update_time_ms": 4.686, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 331.7040710449219, "policy_loss": -0.004612186923623085, "vf_loss": 331.7087097167969, "vf_explained_var": 0.1420343667268753, "kl": 0.015858830884099007, "entropy": 2.257514715194702, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 920000, "episodes_total": 1839, "training_iteration": 46, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-26-29", "timestamp": 1567225589, "time_this_iter_s": 15.472713947296143, "time_total_s": 728.165495634079, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 728.165495634079, "timesteps_since_restore": 920000, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 34.98636363636364, "ram_util_percent": 12.509090909090911}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 423.3737414757453, "episode_reward_min": 203.0418253324303, "episode_reward_mean": 321.0208917089982, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1939088352644625, "mean_processing_ms": 2.3375932840905063, "mean_inference_ms": 0.6641900249779848}, "off_policy_estimator": {}, "info": {"num_steps_trained": 938496, "num_steps_sampled": 940000, "sample_time_ms": 13035.598, "load_time_ms": 13.285, "grad_time_ms": 2399.109, "update_time_ms": 4.657, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 336.05474853515625, "policy_loss": -0.005370831582695246, "vf_loss": 336.0600891113281, "vf_explained_var": 0.15151961147785187, "kl": 0.014916855841875076, "entropy": 2.2496514320373535, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 940000, "episodes_total": 1879, "training_iteration": 47, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-26-45", "timestamp": 1567225605, "time_this_iter_s": 15.63698935508728, "time_total_s": 743.8024849891663, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 743.8024849891663, "timesteps_since_restore": 940000, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 34.15652173913043, "ram_util_percent": 12.504347826086958}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 423.3737414757453, "episode_reward_min": 238.65604696908582, "episode_reward_mean": 322.3894243468452, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1925986296398365, "mean_processing_ms": 2.3377165830155504, "mean_inference_ms": 0.6647458638997054}, "off_policy_estimator": {}, "info": {"num_steps_trained": 958464, "num_steps_sampled": 960000, "sample_time_ms": 13112.04, "load_time_ms": 13.273, "grad_time_ms": 2398.893, "update_time_ms": 4.695, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 347.2090759277344, "policy_loss": -0.0041945395059883595, "vf_loss": 347.2133483886719, "vf_explained_var": 0.1396917700767517, "kl": 0.012664628215134144, "entropy": 2.264096736907959, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 960000, "episodes_total": 1919, "training_iteration": 48, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-27-01", "timestamp": 1567225621, "time_this_iter_s": 15.837676286697388, "time_total_s": 759.6401612758636, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 759.6401612758636, "timesteps_since_restore": 960000, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 35.07272727272727, "ram_util_percent": 12.509090909090911}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 423.3737414757453, "episode_reward_min": 186.30830701576974, "episode_reward_mean": 320.82145783761985, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1911785473843226, "mean_processing_ms": 2.3377903171175354, "mean_inference_ms": 0.6652014357772537}, "off_policy_estimator": {}, "info": {"num_steps_trained": 978432, "num_steps_sampled": 980000, "sample_time_ms": 13195.095, "load_time_ms": 13.237, "grad_time_ms": 2398.618, "update_time_ms": 4.738, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 343.67156982421875, "policy_loss": -0.004382472950965166, "vf_loss": 343.67596435546875, "vf_explained_var": 0.15432925522327423, "kl": 0.012932534329593182, "entropy": 2.266059637069702, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 980000, "episodes_total": 1959, "training_iteration": 49, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-27-17", "timestamp": 1567225637, "time_this_iter_s": 15.773559331893921, "time_total_s": 775.4137206077576, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 775.4137206077576, "timesteps_since_restore": 980000, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 33.56086956521739, "ram_util_percent": 12.517391304347827}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 422.71019823958324, "episode_reward_min": 186.30830701576974, "episode_reward_mean": 318.94066419031896, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.18962209820182, "mean_processing_ms": 2.337987035025789, "mean_inference_ms": 0.665583869275855}, "off_policy_estimator": {}, "info": {"num_steps_trained": 998400, "num_steps_sampled": 1000000, "sample_time_ms": 13219.673, "load_time_ms": 13.257, "grad_time_ms": 2399.286, "update_time_ms": 4.724, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 351.5438232421875, "policy_loss": -0.005102077033370733, "vf_loss": 351.5489501953125, "vf_explained_var": 0.16245529055595398, "kl": 0.019661955535411835, "entropy": 2.253437042236328, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1000000, "episodes_total": 1999, "training_iteration": 50, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-27-32", "timestamp": 1567225652, "time_this_iter_s": 15.818484783172607, "time_total_s": 791.2322053909302, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 791.2322053909302, "timesteps_since_restore": 1000000, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 34.92727272727273, "ram_util_percent": 12.513636363636364}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 423.18151279535255, "episode_reward_min": 208.33964847677245, "episode_reward_mean": 324.6908180245535, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1882496610500892, "mean_processing_ms": 2.3381213623644075, "mean_inference_ms": 0.6659704962167049}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1018368, "num_steps_sampled": 1020000, "sample_time_ms": 13262.746, "load_time_ms": 13.268, "grad_time_ms": 2400.79, "update_time_ms": 4.655, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 370.49444580078125, "policy_loss": -0.0039985291659832, "vf_loss": 370.4983825683594, "vf_explained_var": 0.13824626803398132, "kl": 0.01945732720196247, "entropy": 2.207974672317505, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1020000, "episodes_total": 2039, "training_iteration": 51, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-27-48", "timestamp": 1567225668, "time_this_iter_s": 15.886260747909546, "time_total_s": 807.1184661388397, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 807.1184661388397, "timesteps_since_restore": 1020000, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 33.90869565217391, "ram_util_percent": 12.517391304347827}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 424.5494346250631, "episode_reward_min": 243.98273849738462, "episode_reward_mean": 325.63651793111353, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.186359899026353, "mean_processing_ms": 2.33834245768418, "mean_inference_ms": 0.6663323878814701}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1038336, "num_steps_sampled": 1040000, "sample_time_ms": 13220.295, "load_time_ms": 13.244, "grad_time_ms": 2400.894, "update_time_ms": 4.715, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 368.68133544921875, "policy_loss": -0.006931784097105265, "vf_loss": 368.6882629394531, "vf_explained_var": 0.16688023507595062, "kl": 0.01690787822008133, "entropy": 2.2078657150268555, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1040000, "episodes_total": 2079, "training_iteration": 52, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-28-04", "timestamp": 1567225684, "time_this_iter_s": 15.339221239089966, "time_total_s": 822.4576873779297, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 822.4576873779297, "timesteps_since_restore": 1040000, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 34.690909090909095, "ram_util_percent": 12.51818181818182}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 424.5494346250631, "episode_reward_min": 243.98273849738462, "episode_reward_mean": 317.36933252497164, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1823254080768595, "mean_processing_ms": 2.338505681220961, "mean_inference_ms": 0.6664993353927678}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1058304, "num_steps_sampled": 1060000, "sample_time_ms": 13172.68, "load_time_ms": 13.214, "grad_time_ms": 2401.629, "update_time_ms": 4.772, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 363.337890625, "policy_loss": -0.004552407190203667, "vf_loss": 363.34246826171875, "vf_explained_var": 0.1782332807779312, "kl": 0.019975190982222557, "entropy": 2.20109486579895, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1060000, "episodes_total": 2119, "training_iteration": 53, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-28-19", "timestamp": 1567225699, "time_this_iter_s": 15.196878433227539, "time_total_s": 837.6545658111572, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 837.6545658111572, "timesteps_since_restore": 1060000, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 34.780952380952385, "ram_util_percent": 12.514285714285714}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 418.34534565068896, "episode_reward_min": 242.98940092579826, "episode_reward_mean": 312.86759122689455, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1794140401564994, "mean_processing_ms": 2.338458778059222, "mean_inference_ms": 0.66674471603743}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1078272, "num_steps_sampled": 1080000, "sample_time_ms": 13114.108, "load_time_ms": 13.2, "grad_time_ms": 2401.643, "update_time_ms": 4.756, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 367.4917907714844, "policy_loss": -0.00540470564737916, "vf_loss": 367.4971923828125, "vf_explained_var": 0.17496871948242188, "kl": 0.017825603485107422, "entropy": 2.193087100982666, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1080000, "episodes_total": 2159, "training_iteration": 54, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-28-34", "timestamp": 1567225714, "time_this_iter_s": 14.97216010093689, "time_total_s": 852.6267259120941, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 852.6267259120941, "timesteps_since_restore": 1080000, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 34.84090909090909, "ram_util_percent": 12.51818181818182}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 418.45600994272945, "episode_reward_min": 236.34566872337845, "episode_reward_mean": 313.4893551039361, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1781616149844756, "mean_processing_ms": 2.3378874274800627, "mean_inference_ms": 0.6671578220054022}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1098240, "num_steps_sampled": 1100000, "sample_time_ms": 13096.069, "load_time_ms": 13.186, "grad_time_ms": 2400.622, "update_time_ms": 4.782, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 370.8892822265625, "policy_loss": -0.0046790787018835545, "vf_loss": 370.8939514160156, "vf_explained_var": 0.1831175535917282, "kl": 0.019808053970336914, "entropy": 2.172168731689453, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1100000, "episodes_total": 2198, "training_iteration": 55, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-28-49", "timestamp": 1567225729, "time_this_iter_s": 15.354497909545898, "time_total_s": 867.98122382164, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 867.98122382164, "timesteps_since_restore": 1100000, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 34.68181818181818, "ram_util_percent": 12.51818181818182}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 429.038598887514, "episode_reward_min": 234.04778796038914, "episode_reward_mean": 311.6724235284084, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1739018699183594, "mean_processing_ms": 2.337971500922572, "mean_inference_ms": 0.6674321714697611}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1118208, "num_steps_sampled": 1120000, "sample_time_ms": 13056.787, "load_time_ms": 13.22, "grad_time_ms": 2400.241, "update_time_ms": 4.776, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 383.6126403808594, "policy_loss": -0.004351925104856491, "vf_loss": 383.6169738769531, "vf_explained_var": 0.18977999687194824, "kl": 0.013705253601074219, "entropy": 2.1489098072052, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1120000, "episodes_total": 2239, "training_iteration": 56, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-29-04", "timestamp": 1567225744, "time_this_iter_s": 15.075495481491089, "time_total_s": 883.0567193031311, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 883.0567193031311, "timesteps_since_restore": 1120000, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 35.28095238095238, "ram_util_percent": 12.519047619047617}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 429.038598887514, "episode_reward_min": 205.64180798520215, "episode_reward_mean": 311.7326105467042, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1777745097294496, "mean_processing_ms": 2.338236495043929, "mean_inference_ms": 0.6681324730942712}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1138176, "num_steps_sampled": 1140000, "sample_time_ms": 13017.223, "load_time_ms": 13.225, "grad_time_ms": 2401.003, "update_time_ms": 4.84, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 388.6528015136719, "policy_loss": -0.004096402786672115, "vf_loss": 388.6568908691406, "vf_explained_var": 0.18327099084854126, "kl": 0.020913483574986458, "entropy": 2.1192054748535156, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1140000, "episodes_total": 2279, "training_iteration": 57, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-29-20", "timestamp": 1567225760, "time_this_iter_s": 15.249358654022217, "time_total_s": 898.3060779571533, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 898.3060779571533, "timesteps_since_restore": 1140000, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 35.32272727272727, "ram_util_percent": 12.522727272727273}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 423.92163013149946, "episode_reward_min": -165.29320207100722, "episode_reward_mean": 307.7348193514833, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.169589919284634, "mean_processing_ms": 2.338522772232866, "mean_inference_ms": 0.6683806726569373}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1158144, "num_steps_sampled": 1160000, "sample_time_ms": 12954.143, "load_time_ms": 13.222, "grad_time_ms": 2400.517, "update_time_ms": 4.852, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 424.7981872558594, "policy_loss": -0.0014908879529684782, "vf_loss": 424.7996826171875, "vf_explained_var": 0.17424143850803375, "kl": 0.0167472492903471, "entropy": 2.101992130279541, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1160000, "episodes_total": 2319, "training_iteration": 58, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-29-35", "timestamp": 1567225775, "time_this_iter_s": 15.201331853866577, "time_total_s": 913.5074098110199, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 913.5074098110199, "timesteps_since_restore": 1160000, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 34.97272727272727, "ram_util_percent": 12.531818181818183}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 423.92163013149946, "episode_reward_min": -165.29320207100722, "episode_reward_mean": 309.59834304472804, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.167613838803218, "mean_processing_ms": 2.3385920745975466, "mean_inference_ms": 0.6688578709931047}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1178112, "num_steps_sampled": 1180000, "sample_time_ms": 12900.633, "load_time_ms": 13.232, "grad_time_ms": 2400.227, "update_time_ms": 4.851, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 393.7818908691406, "policy_loss": -0.004980161320418119, "vf_loss": 393.786865234375, "vf_explained_var": 0.19571679830551147, "kl": 0.017649469897150993, "entropy": 2.092633008956909, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1180000, "episodes_total": 2359, "training_iteration": 59, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-29-50", "timestamp": 1567225790, "time_this_iter_s": 15.23682975769043, "time_total_s": 928.7442395687103, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 928.7442395687103, "timesteps_since_restore": 1180000, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 36.19047619047619, "ram_util_percent": 12.538095238095238}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 422.0896955288556, "episode_reward_min": 186.99948801131183, "episode_reward_mean": 308.9272302615221, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1677012200609314, "mean_processing_ms": 2.33823323135349, "mean_inference_ms": 0.6692357862638846}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1198080, "num_steps_sampled": 1200000, "sample_time_ms": 12845.855, "load_time_ms": 13.208, "grad_time_ms": 2400.366, "update_time_ms": 4.832, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 394.1896057128906, "policy_loss": -0.00408030254766345, "vf_loss": 394.19366455078125, "vf_explained_var": 0.19872789084911346, "kl": 0.01649375446140766, "entropy": 2.0768749713897705, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1200000, "episodes_total": 2398, "training_iteration": 60, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-30-05", "timestamp": 1567225805, "time_this_iter_s": 15.271418571472168, "time_total_s": 944.0156581401825, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 944.0156581401825, "timesteps_since_restore": 1200000, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 34.395454545454534, "ram_util_percent": 12.540909090909093}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 422.0896955288556, "episode_reward_min": 186.99948801131183, "episode_reward_mean": 300.80736077566434, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1620754130175954, "mean_processing_ms": 2.338458115516446, "mean_inference_ms": 0.6693042999213553}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1218048, "num_steps_sampled": 1220000, "sample_time_ms": 12812.892, "load_time_ms": 13.207, "grad_time_ms": 2399.233, "update_time_ms": 4.86, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 397.9239807128906, "policy_loss": -0.004120437428355217, "vf_loss": 397.9280700683594, "vf_explained_var": 0.20353072881698608, "kl": 0.0223948173224926, "entropy": 2.0745441913604736, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1220000, "episodes_total": 2439, "training_iteration": 61, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-30-21", "timestamp": 1567225821, "time_this_iter_s": 15.544731855392456, "time_total_s": 959.560389995575, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 959.560389995575, "timesteps_since_restore": 1220000, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 33.1409090909091, "ram_util_percent": 12.536363636363637}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 417.4373046031223, "episode_reward_min": 181.32607713539537, "episode_reward_mean": 290.1543533622913, "episode_len_mean": 500.0, "episodes_this_iter": 38, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.162593715447753, "mean_processing_ms": 2.338124766738072, "mean_inference_ms": 0.6693776061626795}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1238016, "num_steps_sampled": 1240000, "sample_time_ms": 12821.876, "load_time_ms": 13.218, "grad_time_ms": 2398.843, "update_time_ms": 4.785, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 373.4909973144531, "policy_loss": -0.00402845861390233, "vf_loss": 373.49505615234375, "vf_explained_var": 0.21624179184436798, "kl": 0.01912142150104046, "entropy": 2.0506269931793213, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1240000, "episodes_total": 2477, "training_iteration": 62, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-30-36", "timestamp": 1567225836, "time_this_iter_s": 15.424808263778687, "time_total_s": 974.9851982593536, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 974.9851982593536, "timesteps_since_restore": 1240000, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 33.67272727272728, "ram_util_percent": 12.531818181818183}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 411.8468582464308, "episode_reward_min": 181.32607713539537, "episode_reward_mean": 289.90900762167746, "episode_len_mean": 500.0, "episodes_this_iter": 42, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1526111147951577, "mean_processing_ms": 2.3381713958217514, "mean_inference_ms": 0.6689340521664238}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1257984, "num_steps_sampled": 1260000, "sample_time_ms": 12833.959, "load_time_ms": 13.235, "grad_time_ms": 2398.583, "update_time_ms": 4.737, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 418.3661804199219, "policy_loss": -0.0019307791953906417, "vf_loss": 418.36810302734375, "vf_explained_var": 0.21272419393062592, "kl": 0.018437953665852547, "entropy": 2.01928973197937, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1260000, "episodes_total": 2519, "training_iteration": 63, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-30-52", "timestamp": 1567225852, "time_this_iter_s": 15.31542706489563, "time_total_s": 990.3006253242493, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 990.3006253242493, "timesteps_since_restore": 1260000, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 32.77272727272727, "ram_util_percent": 12.545454545454549}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 426.68244367558214, "episode_reward_min": 181.32607713539537, "episode_reward_mean": 298.13582859142997, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.158233873149135, "mean_processing_ms": 2.3385745546585337, "mean_inference_ms": 0.6691902371300321}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1277952, "num_steps_sampled": 1280000, "sample_time_ms": 12870.999, "load_time_ms": 13.248, "grad_time_ms": 2400.151, "update_time_ms": 4.832, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 425.45672607421875, "policy_loss": -0.003176088212057948, "vf_loss": 425.4599304199219, "vf_explained_var": 0.2082699090242386, "kl": 0.01927906461060047, "entropy": 1.9755773544311523, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1280000, "episodes_total": 2559, "training_iteration": 64, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-31-07", "timestamp": 1567225867, "time_this_iter_s": 15.358977794647217, "time_total_s": 1005.6596031188965, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1005.6596031188965, "timesteps_since_restore": 1280000, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 33.981818181818184, "ram_util_percent": 12.55909090909091}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 426.68244367558214, "episode_reward_min": 218.98225213282757, "episode_reward_mean": 302.6289837723671, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.148815718655421, "mean_processing_ms": 2.3387643135340124, "mean_inference_ms": 0.6689139438390476}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1297920, "num_steps_sampled": 1300000, "sample_time_ms": 12866.165, "load_time_ms": 13.247, "grad_time_ms": 2401.028, "update_time_ms": 4.786, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 435.4987487792969, "policy_loss": -0.001478461897931993, "vf_loss": 435.5002136230469, "vf_explained_var": 0.21400539577007294, "kl": 0.021992703899741173, "entropy": 1.9553622007369995, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1300000, "episodes_total": 2599, "training_iteration": 65, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-31-22", "timestamp": 1567225882, "time_this_iter_s": 15.314595699310303, "time_total_s": 1020.9741988182068, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1020.9741988182068, "timesteps_since_restore": 1300000, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 33.377272727272725, "ram_util_percent": 12.577272727272726}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 421.25006843675186, "episode_reward_min": 218.98225213282757, "episode_reward_mean": 304.420617587868, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.145562284032762, "mean_processing_ms": 2.3385995733245135, "mean_inference_ms": 0.6689717850114784}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1317888, "num_steps_sampled": 1320000, "sample_time_ms": 12880.129, "load_time_ms": 13.228, "grad_time_ms": 2402.178, "update_time_ms": 4.815, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 445.0869445800781, "policy_loss": -4.816332148038782e-05, "vf_loss": 445.0869445800781, "vf_explained_var": 0.20522953569889069, "kl": 0.02407466433942318, "entropy": 1.9497170448303223, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1320000, "episodes_total": 2639, "training_iteration": 66, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-31-38", "timestamp": 1567225898, "time_this_iter_s": 15.227545499801636, "time_total_s": 1036.2017443180084, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1036.2017443180084, "timesteps_since_restore": 1320000, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 33.61818181818182, "ram_util_percent": 12.55909090909091}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 421.25006843675186, "episode_reward_min": 244.10347195886962, "episode_reward_mean": 305.57401804408306, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1422982019015335, "mean_processing_ms": 2.3384567552173787, "mean_inference_ms": 0.6690400984873526}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1337856, "num_steps_sampled": 1340000, "sample_time_ms": 12887.022, "load_time_ms": 13.254, "grad_time_ms": 2402.152, "update_time_ms": 4.746, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 448.55169677734375, "policy_loss": -0.00011391995212761685, "vf_loss": 448.5517883300781, "vf_explained_var": 0.2074120044708252, "kl": 0.023947687819600105, "entropy": 1.9200267791748047, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1340000, "episodes_total": 2678, "training_iteration": 67, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-31-53", "timestamp": 1567225913, "time_this_iter_s": 15.318403005599976, "time_total_s": 1051.5201473236084, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1051.5201473236084, "timesteps_since_restore": 1340000, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 34.77619047619047, "ram_util_percent": 12.585714285714284}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 419.8579221595824, "episode_reward_min": 230.74572325318968, "episode_reward_mean": 307.904006059398, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1456893889768445, "mean_processing_ms": 2.3378816530744753, "mean_inference_ms": 0.6692408616955982}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1357824, "num_steps_sampled": 1360000, "sample_time_ms": 12896.954, "load_time_ms": 13.281, "grad_time_ms": 2401.889, "update_time_ms": 4.753, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 465.1356201171875, "policy_loss": -0.0016580206574872136, "vf_loss": 465.13720703125, "vf_explained_var": 0.1985989660024643, "kl": 0.023333173245191574, "entropy": 1.8944448232650757, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1360000, "episodes_total": 2718, "training_iteration": 68, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-32-08", "timestamp": 1567225928, "time_this_iter_s": 15.29924201965332, "time_total_s": 1066.8193893432617, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1066.8193893432617, "timesteps_since_restore": 1360000, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 33.24090909090909, "ram_util_percent": 12.577272727272726}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 427.17366141100786, "episode_reward_min": 230.74572325318968, "episode_reward_mean": 310.4602717387051, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1402178990965113, "mean_processing_ms": 2.3378004174628573, "mean_inference_ms": 0.6689682022105452}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1377792, "num_steps_sampled": 1380000, "sample_time_ms": 12915.202, "load_time_ms": 13.32, "grad_time_ms": 2401.393, "update_time_ms": 4.718, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 474.0138854980469, "policy_loss": 0.001402929425239563, "vf_loss": 474.0124816894531, "vf_explained_var": 0.18930459022521973, "kl": 0.02845090441405773, "entropy": 1.88726806640625, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1380000, "episodes_total": 2758, "training_iteration": 69, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-32-24", "timestamp": 1567225944, "time_this_iter_s": 15.413866519927979, "time_total_s": 1082.2332558631897, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1082.2332558631897, "timesteps_since_restore": 1380000, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 33.85909090909091, "ram_util_percent": 12.590909090909088}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 427.17366141100786, "episode_reward_min": 230.74572325318968, "episode_reward_mean": 313.09559163562255, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1416106932182366, "mean_processing_ms": 2.338140641309495, "mean_inference_ms": 0.6688999305970009}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1397760, "num_steps_sampled": 1400000, "sample_time_ms": 12938.889, "load_time_ms": 13.294, "grad_time_ms": 2400.518, "update_time_ms": 4.742, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 485.3283386230469, "policy_loss": 0.0006582331843674183, "vf_loss": 485.32763671875, "vf_explained_var": 0.1924332082271576, "kl": 0.0279949102550745, "entropy": 1.882551908493042, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1400000, "episodes_total": 2799, "training_iteration": 70, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-32-39", "timestamp": 1567225959, "time_this_iter_s": 15.499896049499512, "time_total_s": 1097.7331519126892, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1097.7331519126892, "timesteps_since_restore": 1400000, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 33.97272727272728, "ram_util_percent": 12.586363636363636}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 426.10684973790984, "episode_reward_min": 252.4727094111451, "episode_reward_mean": 312.56791810238315, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.140328151999685, "mean_processing_ms": 2.3384683683614607, "mean_inference_ms": 0.668808981914481}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1417728, "num_steps_sampled": 1420000, "sample_time_ms": 12921.189, "load_time_ms": 13.317, "grad_time_ms": 2400.954, "update_time_ms": 4.694, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 484.1921081542969, "policy_loss": 0.0004896964528597891, "vf_loss": 484.1916198730469, "vf_explained_var": 0.19892090559005737, "kl": 0.031139330938458443, "entropy": 1.917197585105896, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1420000, "episodes_total": 2839, "training_iteration": 71, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-32-55", "timestamp": 1567225975, "time_this_iter_s": 15.370641231536865, "time_total_s": 1113.103793144226, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1113.103793144226, "timesteps_since_restore": 1420000, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 34.272727272727266, "ram_util_percent": 12.586363636363636}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 426.10684973790984, "episode_reward_min": 241.10269971917802, "episode_reward_mean": 309.4471984275005, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1412708927478543, "mean_processing_ms": 2.3383116093415346, "mean_inference_ms": 0.6686363924799195}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1437696, "num_steps_sampled": 1440000, "sample_time_ms": 12886.69, "load_time_ms": 13.34, "grad_time_ms": 2401.535, "update_time_ms": 4.76, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 492.8349304199219, "policy_loss": -0.00011415970948291942, "vf_loss": 492.8350830078125, "vf_explained_var": 0.19926364719867706, "kl": 0.025405801832675934, "entropy": 1.9051662683486938, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1440000, "episodes_total": 2878, "training_iteration": 72, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-33-10", "timestamp": 1567225990, "time_this_iter_s": 15.08636999130249, "time_total_s": 1128.1901631355286, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1128.1901631355286, "timesteps_since_restore": 1440000, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 33.75909090909091, "ram_util_percent": 12.599999999999996}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 424.4581275004847, "episode_reward_min": 239.33906785694003, "episode_reward_mean": 302.02844136610105, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.136319067614354, "mean_processing_ms": 2.3383031624691846, "mean_inference_ms": 0.6685297951073715}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1457664, "num_steps_sampled": 1460000, "sample_time_ms": 12854.256, "load_time_ms": 13.292, "grad_time_ms": 2402.375, "update_time_ms": 4.745, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 512.2476806640625, "policy_loss": 0.0015147048979997635, "vf_loss": 512.2462158203125, "vf_explained_var": 0.20518368482589722, "kl": 0.029950017109513283, "entropy": 1.894136905670166, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1460000, "episodes_total": 2919, "training_iteration": 73, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-33-25", "timestamp": 1567226005, "time_this_iter_s": 14.999070167541504, "time_total_s": 1143.18923330307, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1143.18923330307, "timesteps_since_restore": 1460000, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 34.47142857142857, "ram_util_percent": 12.599999999999998}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 424.4581275004847, "episode_reward_min": 223.50875079648077, "episode_reward_mean": 296.57758916963337, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.133659105258189, "mean_processing_ms": 2.3382804165210174, "mean_inference_ms": 0.6686397901350674}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1477632, "num_steps_sampled": 1480000, "sample_time_ms": 12845.277, "load_time_ms": 13.234, "grad_time_ms": 2401.869, "update_time_ms": 4.65, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 500.154296875, "policy_loss": 0.0018181577324867249, "vf_loss": 500.1524353027344, "vf_explained_var": 0.20462307333946228, "kl": 0.03231681138277054, "entropy": 1.893248200416565, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1480000, "episodes_total": 2959, "training_iteration": 74, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-33-40", "timestamp": 1567226020, "time_this_iter_s": 15.262146234512329, "time_total_s": 1158.4513795375824, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1158.4513795375824, "timesteps_since_restore": 1480000, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 34.27272727272727, "ram_util_percent": 12.595454545454544}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 365.06659912193066, "episode_reward_min": 223.45403361073136, "episode_reward_mean": 293.28450588343514, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1318992404543438, "mean_processing_ms": 2.338423843859382, "mean_inference_ms": 0.669168699798434}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1497600, "num_steps_sampled": 1500000, "sample_time_ms": 12849.087, "load_time_ms": 13.223, "grad_time_ms": 2401.235, "update_time_ms": 4.723, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 512.9927978515625, "policy_loss": 0.00021904193272348493, "vf_loss": 512.9926147460938, "vf_explained_var": 0.20275568962097168, "kl": 0.027280274778604507, "entropy": 1.8896057605743408, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1500000, "episodes_total": 2999, "training_iteration": 75, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-33-55", "timestamp": 1567226035, "time_this_iter_s": 15.346767902374268, "time_total_s": 1173.7981474399567, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1173.7981474399567, "timesteps_since_restore": 1500000, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 34.20454545454546, "ram_util_percent": 12.609090909090906}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 369.54742047950236, "episode_reward_min": 223.45403361073136, "episode_reward_mean": 293.43111845169227, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.125937979841714, "mean_processing_ms": 2.33854050424286, "mean_inference_ms": 0.6694226677292733}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1517568, "num_steps_sampled": 1520000, "sample_time_ms": 12872.741, "load_time_ms": 13.222, "grad_time_ms": 2399.595, "update_time_ms": 4.782, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 521.9472045898438, "policy_loss": 0.002478303387761116, "vf_loss": 521.94482421875, "vf_explained_var": 0.20110061764717102, "kl": 0.03544997051358223, "entropy": 1.8701839447021484, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1520000, "episodes_total": 3039, "training_iteration": 76, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-34-11", "timestamp": 1567226051, "time_this_iter_s": 15.447438478469849, "time_total_s": 1189.2455859184265, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1189.2455859184265, "timesteps_since_restore": 1520000, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 34.18636363636363, "ram_util_percent": 12.604545454545452}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 369.54742047950236, "episode_reward_min": 223.45403361073136, "episode_reward_mean": 294.21607221952263, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.124194311857713, "mean_processing_ms": 2.338527223560078, "mean_inference_ms": 0.6697201712716223}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1537536, "num_steps_sampled": 1540000, "sample_time_ms": 12882.529, "load_time_ms": 13.238, "grad_time_ms": 2399.468, "update_time_ms": 4.85, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 532.4734497070312, "policy_loss": 0.00017491771723143756, "vf_loss": 532.4733276367188, "vf_explained_var": 0.2029554545879364, "kl": 0.02899514138698578, "entropy": 1.867409586906433, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1540000, "episodes_total": 3079, "training_iteration": 77, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-34-26", "timestamp": 1567226066, "time_this_iter_s": 15.415112733840942, "time_total_s": 1204.6606986522675, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1204.6606986522675, "timesteps_since_restore": 1540000, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 34.11818181818182, "ram_util_percent": 12.609090909090906}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 360.7864028776647, "episode_reward_min": 223.51436046383105, "episode_reward_mean": 293.29724046970676, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.122213103533881, "mean_processing_ms": 2.3385405886550017, "mean_inference_ms": 0.6699946775990537}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1557504, "num_steps_sampled": 1560000, "sample_time_ms": 12862.12, "load_time_ms": 13.246, "grad_time_ms": 2399.663, "update_time_ms": 4.843, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 540.3234252929688, "policy_loss": 0.002692157169803977, "vf_loss": 540.3207397460938, "vf_explained_var": 0.21058779954910278, "kl": 0.03766925632953644, "entropy": 1.8560521602630615, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1560000, "episodes_total": 3119, "training_iteration": 78, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-34-41", "timestamp": 1567226081, "time_this_iter_s": 15.09604024887085, "time_total_s": 1219.7567389011383, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1219.7567389011383, "timesteps_since_restore": 1560000, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 35.3952380952381, "ram_util_percent": 12.6047619047619}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 362.9398717866173, "episode_reward_min": 223.51436046383105, "episode_reward_mean": 290.9717563317157, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1197677338933, "mean_processing_ms": 2.3385498789692254, "mean_inference_ms": 0.670307484644506}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1577472, "num_steps_sampled": 1580000, "sample_time_ms": 12828.69, "load_time_ms": 13.221, "grad_time_ms": 2400.345, "update_time_ms": 4.941, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 550.4901123046875, "policy_loss": 0.004301500041037798, "vf_loss": 550.4859008789062, "vf_explained_var": 0.21196942031383514, "kl": 0.04165266081690788, "entropy": 1.859921932220459, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1580000, "episodes_total": 3159, "training_iteration": 79, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-34-56", "timestamp": 1567226096, "time_this_iter_s": 15.087395429611206, "time_total_s": 1234.8441343307495, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1234.8441343307495, "timesteps_since_restore": 1580000, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 34.18181818181818, "ram_util_percent": 12.609090909090908}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 367.5893408232259, "episode_reward_min": 236.2307856572532, "episode_reward_mean": 287.01859418164656, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.117104297804965, "mean_processing_ms": 2.3386294686037354, "mean_inference_ms": 0.6706532185877714}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1597440, "num_steps_sampled": 1600000, "sample_time_ms": 12780.191, "load_time_ms": 13.226, "grad_time_ms": 2399.852, "update_time_ms": 4.908, "learner": {"default_policy": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 559.0747680664062, "policy_loss": 0.004732867702841759, "vf_loss": 559.0700073242188, "vf_explained_var": 0.2115609347820282, "kl": 0.04785959795117378, "entropy": 1.8423352241516113, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1600000, "episodes_total": 3199, "training_iteration": 80, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-35-11", "timestamp": 1567226111, "time_this_iter_s": 15.009416341781616, "time_total_s": 1249.8535506725311, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1249.8535506725311, "timesteps_since_restore": 1600000, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 35.2904761904762, "ram_util_percent": 12.6047619047619}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 367.5893408232259, "episode_reward_min": 236.76386011164533, "episode_reward_mean": 284.3371074569786, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.115527912763307, "mean_processing_ms": 2.33844280294558, "mean_inference_ms": 0.6709723917392587}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1617408, "num_steps_sampled": 1620000, "sample_time_ms": 12770.443, "load_time_ms": 13.244, "grad_time_ms": 2397.979, "update_time_ms": 4.95, "learner": {"default_policy": {"cur_kl_coeff": 0.00010986327833961695, "cur_lr": 4.999999873689376e-05, "total_loss": 548.8440551757812, "policy_loss": 0.0024673868902027607, "vf_loss": 548.8416137695312, "vf_explained_var": 0.21189792454242706, "kl": 0.041449643671512604, "entropy": 1.8304494619369507, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1620000, "episodes_total": 3238, "training_iteration": 81, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-35-27", "timestamp": 1567226127, "time_this_iter_s": 15.256175756454468, "time_total_s": 1265.1097264289856, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1265.1097264289856, "timesteps_since_restore": 1620000, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 33.61818181818182, "ram_util_percent": 12.609090909090908}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 358.44078882711574, "episode_reward_min": 238.42070724729817, "episode_reward_mean": 284.2242301191791, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1097504460327188, "mean_processing_ms": 2.338593387021197, "mean_inference_ms": 0.6709874641517835}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1637376, "num_steps_sampled": 1640000, "sample_time_ms": 12792.395, "load_time_ms": 13.218, "grad_time_ms": 2397.701, "update_time_ms": 4.87, "learner": {"default_policy": {"cur_kl_coeff": 0.00016479492478538305, "cur_lr": 4.999999873689376e-05, "total_loss": 575.4083251953125, "policy_loss": 0.007786796428263187, "vf_loss": 575.4005126953125, "vf_explained_var": 0.19868901371955872, "kl": 0.053284693509340286, "entropy": 1.7978640794754028, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1640000, "episodes_total": 3279, "training_iteration": 82, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-35-42", "timestamp": 1567226142, "time_this_iter_s": 15.302355766296387, "time_total_s": 1280.412082195282, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1280.412082195282, "timesteps_since_restore": 1640000, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 34.06818181818182, "ram_util_percent": 12.613636363636362}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 342.01744760391085, "episode_reward_min": 239.00274465941445, "episode_reward_mean": 288.95957038209247, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.108602054888851, "mean_processing_ms": 2.3385262881795827, "mean_inference_ms": 0.6709674175308347}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1657344, "num_steps_sampled": 1660000, "sample_time_ms": 12827.67, "load_time_ms": 13.248, "grad_time_ms": 2396.875, "update_time_ms": 4.905, "learner": {"default_policy": {"cur_kl_coeff": 0.0002471923944540322, "cur_lr": 4.999999873689376e-05, "total_loss": 570.6800537109375, "policy_loss": 0.07736065238714218, "vf_loss": 570.60205078125, "vf_explained_var": 0.19690120220184326, "kl": 2.497967004776001, "entropy": 1.8584750890731812, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1660000, "episodes_total": 3318, "training_iteration": 83, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-35-57", "timestamp": 1567226157, "time_this_iter_s": 15.343255519866943, "time_total_s": 1295.755337715149, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1295.755337715149, "timesteps_since_restore": 1660000, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 34.4909090909091, "ram_util_percent": 12.618181818181817}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 340.20157001967254, "episode_reward_min": 134.12536290148972, "episode_reward_mean": 286.9954133246613, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1081095147203177, "mean_processing_ms": 2.3386428122458245, "mean_inference_ms": 0.6711098393740721}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1677312, "num_steps_sampled": 1680000, "sample_time_ms": 12847.422, "load_time_ms": 13.275, "grad_time_ms": 2396.247, "update_time_ms": 5.021, "learner": {"default_policy": {"cur_kl_coeff": 0.0003707885625772178, "cur_lr": 4.999999873689376e-05, "total_loss": 596.3140869140625, "policy_loss": 0.010835619643330574, "vf_loss": 596.3032836914062, "vf_explained_var": 0.19745704531669617, "kl": 0.09180567413568497, "entropy": 1.7887749671936035, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1680000, "episodes_total": 3359, "training_iteration": 84, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-36-13", "timestamp": 1567226173, "time_this_iter_s": 15.454636812210083, "time_total_s": 1311.209974527359, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1311.209974527359, "timesteps_since_restore": 1680000, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 33.86818181818182, "ram_util_percent": 12.618181818181817}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 345.8016511739959, "episode_reward_min": 134.12536290148972, "episode_reward_mean": 286.2020769578331, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.10548162945773, "mean_processing_ms": 2.3385503089982422, "mean_inference_ms": 0.6708612506554108}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1697280, "num_steps_sampled": 1700000, "sample_time_ms": 12852.292, "load_time_ms": 13.273, "grad_time_ms": 2397.46, "update_time_ms": 4.966, "learner": {"default_policy": {"cur_kl_coeff": 0.0005561828729696572, "cur_lr": 4.999999873689376e-05, "total_loss": 580.2548828125, "policy_loss": 0.0037738352548331022, "vf_loss": 580.2510986328125, "vf_explained_var": 0.19479268789291382, "kl": 0.04891453683376312, "entropy": 1.7647967338562012, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1700000, "episodes_total": 3398, "training_iteration": 85, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-36-28", "timestamp": 1567226188, "time_this_iter_s": 15.407047510147095, "time_total_s": 1326.617022037506, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1326.617022037506, "timesteps_since_restore": 1700000, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 34.28181818181818, "ram_util_percent": 12.618181818181817}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 346.127928020057, "episode_reward_min": 246.1943805845916, "episode_reward_mean": 289.25524408283485, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.106171652601438, "mean_processing_ms": 2.3384928963738068, "mean_inference_ms": 0.6709688776167425}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1717248, "num_steps_sampled": 1720000, "sample_time_ms": 12841.925, "load_time_ms": 13.317, "grad_time_ms": 2398.225, "update_time_ms": 4.969, "learner": {"default_policy": {"cur_kl_coeff": 0.0008342742803506553, "cur_lr": 4.999999873689376e-05, "total_loss": 616.0592041015625, "policy_loss": 0.004081209655851126, "vf_loss": 616.0551147460938, "vf_explained_var": 0.18822520971298218, "kl": 0.04427723214030266, "entropy": 1.799826979637146, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1720000, "episodes_total": 3439, "training_iteration": 86, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-36-44", "timestamp": 1567226204, "time_this_iter_s": 15.35254430770874, "time_total_s": 1341.9695663452148, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1341.9695663452148, "timesteps_since_restore": 1720000, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 34.099999999999994, "ram_util_percent": 12.618181818181817}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 346.127928020057, "episode_reward_min": 244.13176975789838, "episode_reward_mean": 288.44939495059543, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.104988211837949, "mean_processing_ms": 2.3384092271657955, "mean_inference_ms": 0.6707706632010283}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1737216, "num_steps_sampled": 1740000, "sample_time_ms": 12839.241, "load_time_ms": 13.304, "grad_time_ms": 2397.154, "update_time_ms": 4.92, "learner": {"default_policy": {"cur_kl_coeff": 0.0012514113914221525, "cur_lr": 4.999999873689376e-05, "total_loss": 607.7120361328125, "policy_loss": 0.0030770127195864916, "vf_loss": 607.7088623046875, "vf_explained_var": 0.19028107821941376, "kl": 0.047744233161211014, "entropy": 1.7975921630859375, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1740000, "episodes_total": 3478, "training_iteration": 87, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-36-59", "timestamp": 1567226219, "time_this_iter_s": 15.37719988822937, "time_total_s": 1357.3467662334442, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1357.3467662334442, "timesteps_since_restore": 1740000, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 34.522727272727266, "ram_util_percent": 12.618181818181817}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 340.7944785352331, "episode_reward_min": 244.13176975789838, "episode_reward_mean": 290.30561744789514, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.105437849186432, "mean_processing_ms": 2.3385129244984255, "mean_inference_ms": 0.6709133779465748}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1757184, "num_steps_sampled": 1760000, "sample_time_ms": 12867.171, "load_time_ms": 13.288, "grad_time_ms": 2395.684, "update_time_ms": 4.914, "learner": {"default_policy": {"cur_kl_coeff": 0.0018771172035485506, "cur_lr": 4.999999873689376e-05, "total_loss": 636.8941040039062, "policy_loss": 0.0023791140411049128, "vf_loss": 636.8916015625, "vf_explained_var": 0.18804024159908295, "kl": 0.038814421743154526, "entropy": 1.7857712507247925, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1760000, "episodes_total": 3519, "training_iteration": 88, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-37-14", "timestamp": 1567226234, "time_this_iter_s": 15.361323833465576, "time_total_s": 1372.7080900669098, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1372.7080900669098, "timesteps_since_restore": 1760000, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 33.75, "ram_util_percent": 12.62272727272727}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 340.7944785352331, "episode_reward_min": 256.2042305573788, "episode_reward_mean": 291.8020242371177, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1011689075104916, "mean_processing_ms": 2.338578568319944, "mean_inference_ms": 0.6707789276854456}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1777152, "num_steps_sampled": 1780000, "sample_time_ms": 12888.553, "load_time_ms": 13.3, "grad_time_ms": 2396.53, "update_time_ms": 4.855, "learner": {"default_policy": {"cur_kl_coeff": 0.0018771172035485506, "cur_lr": 4.999999873689376e-05, "total_loss": 626.2876586914062, "policy_loss": 0.012543189339339733, "vf_loss": 626.2748413085938, "vf_explained_var": 0.18889358639717102, "kl": 0.13262860476970673, "entropy": 1.8250795602798462, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1780000, "episodes_total": 3558, "training_iteration": 89, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-37-30", "timestamp": 1567226250, "time_this_iter_s": 15.30816912651062, "time_total_s": 1388.0162591934204, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1388.0162591934204, "timesteps_since_restore": 1780000, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 35.15238095238095, "ram_util_percent": 12.614285714285714}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 338.8157791888349, "episode_reward_min": 256.2042305573788, "episode_reward_mean": 293.23516676109966, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.099885356179197, "mean_processing_ms": 2.3384145793301934, "mean_inference_ms": 0.6707142069359665}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1797120, "num_steps_sampled": 1800000, "sample_time_ms": 12906.144, "load_time_ms": 13.32, "grad_time_ms": 2397.295, "update_time_ms": 4.87, "learner": {"default_policy": {"cur_kl_coeff": 0.002815675688907504, "cur_lr": 4.999999873689376e-05, "total_loss": 645.669677734375, "policy_loss": 0.0020431140437722206, "vf_loss": 645.66748046875, "vf_explained_var": 0.18191270530223846, "kl": 0.036479417234659195, "entropy": 1.816184401512146, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1800000, "episodes_total": 3598, "training_iteration": 90, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-37-45", "timestamp": 1567226265, "time_this_iter_s": 15.194219589233398, "time_total_s": 1403.2104787826538, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1403.2104787826538, "timesteps_since_restore": 1800000, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 33.831818181818186, "ram_util_percent": 12.631818181818181}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 339.44816811442655, "episode_reward_min": 263.63740260545126, "episode_reward_mean": 292.7070387735913, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0990160860433202, "mean_processing_ms": 2.3381301961666865, "mean_inference_ms": 0.6708530982314922}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1817088, "num_steps_sampled": 1820000, "sample_time_ms": 12907.286, "load_time_ms": 13.328, "grad_time_ms": 2398.751, "update_time_ms": 4.842, "learner": {"default_policy": {"cur_kl_coeff": 0.002815675688907504, "cur_lr": 4.999999873689376e-05, "total_loss": 650.9659423828125, "policy_loss": -0.0004740408912766725, "vf_loss": 650.9663696289062, "vf_explained_var": 0.19153065979480743, "kl": 0.02665180340409279, "entropy": 1.852200984954834, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1820000, "episodes_total": 3637, "training_iteration": 91, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-38-00", "timestamp": 1567226280, "time_this_iter_s": 15.281003952026367, "time_total_s": 1418.4914827346802, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1418.4914827346802, "timesteps_since_restore": 1820000, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 33.10454545454545, "ram_util_percent": 12.62272727272727}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 339.44816811442655, "episode_reward_min": 263.63740260545126, "episode_reward_mean": 290.8178674595539, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0939791758761186, "mean_processing_ms": 2.338030002199809, "mean_inference_ms": 0.670576223684145}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1837056, "num_steps_sampled": 1840000, "sample_time_ms": 12875.047, "load_time_ms": 13.381, "grad_time_ms": 2398.63, "update_time_ms": 4.86, "learner": {"default_policy": {"cur_kl_coeff": 0.002815675688907504, "cur_lr": 4.999999873689376e-05, "total_loss": 682.6575317382812, "policy_loss": 0.0037994026206433773, "vf_loss": 682.6536254882812, "vf_explained_var": 0.18349885940551758, "kl": 0.041784174740314484, "entropy": 1.9043346643447876, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1840000, "episodes_total": 3678, "training_iteration": 92, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-38-15", "timestamp": 1567226295, "time_this_iter_s": 14.978626012802124, "time_total_s": 1433.4701087474823, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1433.4701087474823, "timesteps_since_restore": 1840000, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 33.53333333333333, "ram_util_percent": 12.628571428571428}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 337.86727680721, "episode_reward_min": 263.341315978001, "episode_reward_mean": 287.8459930739698, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0922619828350797, "mean_processing_ms": 2.3381183544940303, "mean_inference_ms": 0.670385243531285}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1857024, "num_steps_sampled": 1860000, "sample_time_ms": 12834.152, "load_time_ms": 13.411, "grad_time_ms": 2399.201, "update_time_ms": 4.819, "learner": {"default_policy": {"cur_kl_coeff": 0.004223513416945934, "cur_lr": 4.999999873689376e-05, "total_loss": 680.2989501953125, "policy_loss": 0.005462543107569218, "vf_loss": 680.2932739257812, "vf_explained_var": 0.19424891471862793, "kl": 0.054092857986688614, "entropy": 1.8953638076782227, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1860000, "episodes_total": 3718, "training_iteration": 93, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-38-30", "timestamp": 1567226310, "time_this_iter_s": 14.940119504928589, "time_total_s": 1448.410228252411, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1448.410228252411, "timesteps_since_restore": 1860000, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 32.336363636363636, "ram_util_percent": 12.636363636363633}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 359.7537280042809, "episode_reward_min": 263.341315978001, "episode_reward_mean": 288.09139962042326, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.088554640259324, "mean_processing_ms": 2.3381102537708136, "mean_inference_ms": 0.6701789330064077}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1876992, "num_steps_sampled": 1880000, "sample_time_ms": 12784.362, "load_time_ms": 13.495, "grad_time_ms": 2399.335, "update_time_ms": 4.703, "learner": {"default_policy": {"cur_kl_coeff": 0.006335270591080189, "cur_lr": 4.999999873689376e-05, "total_loss": 697.0067749023438, "policy_loss": 0.002123409416526556, "vf_loss": 697.00439453125, "vf_explained_var": 0.19312484562397003, "kl": 0.03531266376376152, "entropy": 1.875496506690979, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1880000, "episodes_total": 3758, "training_iteration": 94, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-38-45", "timestamp": 1567226325, "time_this_iter_s": 14.95854926109314, "time_total_s": 1463.368777513504, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1463.368777513504, "timesteps_since_restore": 1880000, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 33.24761904761904, "ram_util_percent": 12.628571428571428}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 359.7537280042809, "episode_reward_min": 243.7940331603228, "episode_reward_mean": 290.7666734770362, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0903960365348553, "mean_processing_ms": 2.3383018524508277, "mean_inference_ms": 0.6701707452229085}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1896960, "num_steps_sampled": 1900000, "sample_time_ms": 12725.972, "load_time_ms": 13.526, "grad_time_ms": 2399.441, "update_time_ms": 4.761, "learner": {"default_policy": {"cur_kl_coeff": 0.006335270591080189, "cur_lr": 4.999999873689376e-05, "total_loss": 714.5665893554688, "policy_loss": 0.003028897102922201, "vf_loss": 714.5632934570312, "vf_explained_var": 0.19073408842086792, "kl": 0.04206090047955513, "entropy": 1.9007235765457153, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1900000, "episodes_total": 3799, "training_iteration": 95, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-39-00", "timestamp": 1567226340, "time_this_iter_s": 14.828080654144287, "time_total_s": 1478.1968581676483, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1478.1968581676483, "timesteps_since_restore": 1900000, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 33.34761904761905, "ram_util_percent": 12.647619047619045}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 359.128778908941, "episode_reward_min": 37.916989170877244, "episode_reward_mean": 288.99068677390244, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.08163208417537, "mean_processing_ms": 2.3385603065644847, "mean_inference_ms": 0.6700673807749857}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1916928, "num_steps_sampled": 1920000, "sample_time_ms": 12692.663, "load_time_ms": 13.517, "grad_time_ms": 2399.586, "update_time_ms": 4.88, "learner": {"default_policy": {"cur_kl_coeff": 0.009502905420958996, "cur_lr": 4.999999873689376e-05, "total_loss": 712.1727905273438, "policy_loss": 0.0008330823620781302, "vf_loss": 712.1715698242188, "vf_explained_var": 0.1890510469675064, "kl": 0.03778340294957161, "entropy": 1.8948911428451538, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1920000, "episodes_total": 3839, "training_iteration": 96, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-39-15", "timestamp": 1567226355, "time_this_iter_s": 15.022306442260742, "time_total_s": 1493.219164609909, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1493.219164609909, "timesteps_since_restore": 1920000, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 32.795454545454554, "ram_util_percent": 12.659090909090907}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 362.4561253231563, "episode_reward_min": 37.916989170877244, "episode_reward_mean": 291.1329251310432, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0825553975226665, "mean_processing_ms": 2.33863297377819, "mean_inference_ms": 0.6698608009077377}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1936896, "num_steps_sampled": 1940000, "sample_time_ms": 12667.26, "load_time_ms": 13.49, "grad_time_ms": 2400.157, "update_time_ms": 4.893, "learner": {"default_policy": {"cur_kl_coeff": 0.009502905420958996, "cur_lr": 4.999999873689376e-05, "total_loss": 714.368408203125, "policy_loss": 0.00011268635716987774, "vf_loss": 714.3679809570312, "vf_explained_var": 0.1860143393278122, "kl": 0.033833011984825134, "entropy": 1.8488647937774658, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1940000, "episodes_total": 3879, "training_iteration": 97, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-39-30", "timestamp": 1567226370, "time_this_iter_s": 15.128916025161743, "time_total_s": 1508.3480806350708, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1508.3480806350708, "timesteps_since_restore": 1940000, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 34.52857142857143, "ram_util_percent": 12.661904761904761}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 362.4561253231563, "episode_reward_min": 37.916989170877244, "episode_reward_mean": 292.2896323146497, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0853237462563157, "mean_processing_ms": 2.3384418515492627, "mean_inference_ms": 0.6697561909951539}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1956864, "num_steps_sampled": 1960000, "sample_time_ms": 12637.367, "load_time_ms": 13.463, "grad_time_ms": 2401.293, "update_time_ms": 4.887, "learner": {"default_policy": {"cur_kl_coeff": 0.009502905420958996, "cur_lr": 4.999999873689376e-05, "total_loss": 707.57177734375, "policy_loss": 0.001617502886801958, "vf_loss": 707.5698852539062, "vf_explained_var": 0.1838294118642807, "kl": 0.030978973954916, "entropy": 1.847947120666504, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1960000, "episodes_total": 3918, "training_iteration": 98, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-39-45", "timestamp": 1567226385, "time_this_iter_s": 15.072585344314575, "time_total_s": 1523.4206659793854, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1523.4206659793854, "timesteps_since_restore": 1960000, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 34.07727272727272, "ram_util_percent": 12.668181818181814}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 379.65324216992946, "episode_reward_min": 262.7885733919024, "episode_reward_mean": 298.79559979786075, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.088038254462316, "mean_processing_ms": 2.3381818464794475, "mean_inference_ms": 0.6695897039424517}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1976832, "num_steps_sampled": 1980000, "sample_time_ms": 12651.013, "load_time_ms": 13.459, "grad_time_ms": 2400.587, "update_time_ms": 4.908, "learner": {"default_policy": {"cur_kl_coeff": 0.009502905420958996, "cur_lr": 4.999999873689376e-05, "total_loss": 738.389404296875, "policy_loss": 0.0002481788396835327, "vf_loss": 738.3888549804688, "vf_explained_var": 0.17759443819522858, "kl": 0.03036447986960411, "entropy": 1.7840747833251953, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1980000, "episodes_total": 3958, "training_iteration": 99, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-40-01", "timestamp": 1567226401, "time_this_iter_s": 15.438854932785034, "time_total_s": 1538.8595209121704, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1538.8595209121704, "timesteps_since_restore": 1980000, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 34.13636363636363, "ram_util_percent": 12.695454545454545}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 380.83401017029, "episode_reward_min": 262.7885733919024, "episode_reward_mean": 302.59269526563054, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0883333413573912, "mean_processing_ms": 2.3380687214583973, "mean_inference_ms": 0.6695217689443802}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1996800, "num_steps_sampled": 2000000, "sample_time_ms": 12696.003, "load_time_ms": 13.471, "grad_time_ms": 2400.488, "update_time_ms": 4.871, "learner": {"default_policy": {"cur_kl_coeff": 0.009502905420958996, "cur_lr": 4.999999873689376e-05, "total_loss": 745.6176147460938, "policy_loss": 0.0017125094309449196, "vf_loss": 745.615478515625, "vf_explained_var": 0.18364208936691284, "kl": 0.03801447153091431, "entropy": 1.7963080406188965, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2000000, "episodes_total": 3998, "training_iteration": 100, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-40-16", "timestamp": 1567226416, "time_this_iter_s": 15.646930694580078, "time_total_s": 1554.5064516067505, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1554.5064516067505, "timesteps_since_restore": 2000000, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 34.57272727272727, "ram_util_percent": 12.686363636363636}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 380.83401017029, "episode_reward_min": 261.254794463896, "episode_reward_mean": 305.08050706748253, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0834236949876335, "mean_processing_ms": 2.338168404959494, "mean_inference_ms": 0.669506583657059}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2016768, "num_steps_sampled": 2020000, "sample_time_ms": 12720.691, "load_time_ms": 13.5, "grad_time_ms": 2401.571, "update_time_ms": 4.844, "learner": {"default_policy": {"cur_kl_coeff": 0.009502905420958996, "cur_lr": 4.999999873689376e-05, "total_loss": 750.1212158203125, "policy_loss": 0.001651839935220778, "vf_loss": 750.1192016601562, "vf_explained_var": 0.16820746660232544, "kl": 0.040219929069280624, "entropy": 1.8168874979019165, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2020000, "episodes_total": 4038, "training_iteration": 101, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-40-32", "timestamp": 1567226432, "time_this_iter_s": 15.53871202468872, "time_total_s": 1570.0451636314392, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1570.0451636314392, "timesteps_since_restore": 2020000, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 35.02727272727273, "ram_util_percent": 12.686363636363636}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 380.83401017029, "episode_reward_min": 249.08707378984232, "episode_reward_mean": 305.8221566343783, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0864885813184317, "mean_processing_ms": 2.3384043216911214, "mean_inference_ms": 0.6696166409219552}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2036736, "num_steps_sampled": 2040000, "sample_time_ms": 12791.429, "load_time_ms": 13.448, "grad_time_ms": 2400.628, "update_time_ms": 4.869, "learner": {"default_policy": {"cur_kl_coeff": 0.014254358597099781, "cur_lr": 4.999999873689376e-05, "total_loss": 780.1925659179688, "policy_loss": 0.002570920158177614, "vf_loss": 780.1895141601562, "vf_explained_var": 0.16690967977046967, "kl": 0.0367981418967247, "entropy": 1.7975949048995972, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2040000, "episodes_total": 4079, "training_iteration": 102, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-40-47", "timestamp": 1567226447, "time_this_iter_s": 15.676432132720947, "time_total_s": 1585.7215957641602, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1585.7215957641602, "timesteps_since_restore": 2040000, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 33.63913043478261, "ram_util_percent": 12.695652173913041}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 375.4811357758361, "episode_reward_min": 249.08707378984232, "episode_reward_mean": 312.14989005768615, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0854503025116706, "mean_processing_ms": 2.338654971307815, "mean_inference_ms": 0.6695411687944863}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2056704, "num_steps_sampled": 2060000, "sample_time_ms": 12857.775, "load_time_ms": 13.435, "grad_time_ms": 2401.186, "update_time_ms": 4.997, "learner": {"default_policy": {"cur_kl_coeff": 0.014254358597099781, "cur_lr": 4.999999873689376e-05, "total_loss": 764.825927734375, "policy_loss": -7.14598354534246e-05, "vf_loss": 764.8255004882812, "vf_explained_var": 0.16467393934726715, "kl": 0.032895591109991074, "entropy": 1.7707821130752563, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2060000, "episodes_total": 4118, "training_iteration": 103, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-41-03", "timestamp": 1567226463, "time_this_iter_s": 15.610090494155884, "time_total_s": 1601.331686258316, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1601.331686258316, "timesteps_since_restore": 2060000, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 35.32272727272727, "ram_util_percent": 12.69090909090909}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 377.1873968182486, "episode_reward_min": 249.08707378984232, "episode_reward_mean": 316.6998566382414, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.090027999831423, "mean_processing_ms": 2.3385771540789415, "mean_inference_ms": 0.6695687213979022}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2076672, "num_steps_sampled": 2080000, "sample_time_ms": 12911.543, "load_time_ms": 13.324, "grad_time_ms": 2401.056, "update_time_ms": 5.068, "learner": {"default_policy": {"cur_kl_coeff": 0.014254358597099781, "cur_lr": 4.999999873689376e-05, "total_loss": 799.84716796875, "policy_loss": 0.0012552898842841387, "vf_loss": 799.845458984375, "vf_explained_var": 0.15585319697856903, "kl": 0.030331110581755638, "entropy": 1.745283842086792, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2080000, "episodes_total": 4158, "training_iteration": 104, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-41-19", "timestamp": 1567226479, "time_this_iter_s": 15.494332551956177, "time_total_s": 1616.8260188102722, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1616.8260188102722, "timesteps_since_restore": 2080000, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 34.99545454545455, "ram_util_percent": 12.7}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 384.76894528354114, "episode_reward_min": 262.13245850315576, "episode_reward_mean": 317.28106381241975, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.096284468924888, "mean_processing_ms": 2.3383134073759764, "mean_inference_ms": 0.6696239312301541}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2096640, "num_steps_sampled": 2100000, "sample_time_ms": 12988.37, "load_time_ms": 13.263, "grad_time_ms": 2400.706, "update_time_ms": 5.08, "learner": {"default_policy": {"cur_kl_coeff": 0.014254358597099781, "cur_lr": 4.999999873689376e-05, "total_loss": 797.2653198242188, "policy_loss": 0.0034656936768442392, "vf_loss": 797.2612915039062, "vf_explained_var": 0.17083553969860077, "kl": 0.04270104318857193, "entropy": 1.7460088729858398, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2100000, "episodes_total": 4198, "training_iteration": 105, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-41-34", "timestamp": 1567226494, "time_this_iter_s": 15.589433193206787, "time_total_s": 1632.415452003479, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1632.415452003479, "timesteps_since_restore": 2100000, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 34.81818181818182, "ram_util_percent": 12.7}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 384.76894528354114, "episode_reward_min": 262.13245850315576, "episode_reward_mean": 313.97380868230937, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.092118337171586, "mean_processing_ms": 2.3387094085579863, "mean_inference_ms": 0.6694592742939492}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2116608, "num_steps_sampled": 2120000, "sample_time_ms": 13045.372, "load_time_ms": 13.264, "grad_time_ms": 2400.449, "update_time_ms": 4.955, "learner": {"default_policy": {"cur_kl_coeff": 0.02138153836131096, "cur_lr": 4.999999873689376e-05, "total_loss": 828.1552124023438, "policy_loss": 0.001896778354421258, "vf_loss": 828.1526489257812, "vf_explained_var": 0.16502265632152557, "kl": 0.03187336027622223, "entropy": 1.7481082677841187, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2120000, "episodes_total": 4239, "training_iteration": 106, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-41-50", "timestamp": 1567226510, "time_this_iter_s": 15.587775230407715, "time_total_s": 1648.0032272338867, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1648.0032272338867, "timesteps_since_restore": 2120000, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 34.47272727272727, "ram_util_percent": 12.709090909090907}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 384.76894528354114, "episode_reward_min": 271.26119988318817, "episode_reward_mean": 315.46856137883884, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.092021552381416, "mean_processing_ms": 2.3388023729316085, "mean_inference_ms": 0.6693776701840739}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2136576, "num_steps_sampled": 2140000, "sample_time_ms": 13116.015, "load_time_ms": 13.291, "grad_time_ms": 2401.997, "update_time_ms": 4.987, "learner": {"default_policy": {"cur_kl_coeff": 0.02138153836131096, "cur_lr": 4.999999873689376e-05, "total_loss": 814.9203491210938, "policy_loss": 0.0024488489143550396, "vf_loss": 814.9169311523438, "vf_explained_var": 0.16152755916118622, "kl": 0.046760719269514084, "entropy": 1.7376928329467773, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2140000, "episodes_total": 4279, "training_iteration": 107, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-42-06", "timestamp": 1567226526, "time_this_iter_s": 15.850600004196167, "time_total_s": 1663.8538272380829, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1663.8538272380829, "timesteps_since_restore": 2140000, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 35.03478260869566, "ram_util_percent": 12.695652173913043}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 382.9095551479121, "episode_reward_min": 236.41329278625548, "episode_reward_mean": 316.33883100389806, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0945332660304588, "mean_processing_ms": 2.3387786592155515, "mean_inference_ms": 0.66970972136184}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2156544, "num_steps_sampled": 2160000, "sample_time_ms": 13157.784, "load_time_ms": 13.309, "grad_time_ms": 2402.77, "update_time_ms": 5.017, "learner": {"default_policy": {"cur_kl_coeff": 0.03207230567932129, "cur_lr": 4.999999873689376e-05, "total_loss": 804.506103515625, "policy_loss": -0.001986621879041195, "vf_loss": 804.5073852539062, "vf_explained_var": 0.17564761638641357, "kl": 0.02274235337972641, "entropy": 1.7426016330718994, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2160000, "episodes_total": 4318, "training_iteration": 108, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-42-21", "timestamp": 1567226541, "time_this_iter_s": 15.50026273727417, "time_total_s": 1679.354089975357, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1679.354089975357, "timesteps_since_restore": 2160000, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 35.38181818181818, "ram_util_percent": 12.7}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 379.292050798984, "episode_reward_min": 236.41329278625548, "episode_reward_mean": 317.0197930622942, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.095438280115453, "mean_processing_ms": 2.338687178222279, "mean_inference_ms": 0.6697298918514385}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2176512, "num_steps_sampled": 2180000, "sample_time_ms": 13154.473, "load_time_ms": 13.264, "grad_time_ms": 2402.538, "update_time_ms": 5.012, "learner": {"default_policy": {"cur_kl_coeff": 0.03207230567932129, "cur_lr": 4.999999873689376e-05, "total_loss": 834.318603515625, "policy_loss": 0.0032521875109523535, "vf_loss": 834.314208984375, "vf_explained_var": 0.16957435011863708, "kl": 0.03407701477408409, "entropy": 1.7609018087387085, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2180000, "episodes_total": 4358, "training_iteration": 109, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-42-37", "timestamp": 1567226557, "time_this_iter_s": 15.40173888206482, "time_total_s": 1694.7558288574219, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1694.7558288574219, "timesteps_since_restore": 2180000, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 34.02272727272727, "ram_util_percent": 12.704545454545455}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 394.0830180564566, "episode_reward_min": 236.41329278625548, "episode_reward_mean": 317.83762290462823, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.094744854387252, "mean_processing_ms": 2.338701222467779, "mean_inference_ms": 0.6695844645644005}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2196480, "num_steps_sampled": 2200000, "sample_time_ms": 13135.89, "load_time_ms": 13.241, "grad_time_ms": 2401.139, "update_time_ms": 5.028, "learner": {"default_policy": {"cur_kl_coeff": 0.03207230567932129, "cur_lr": 4.999999873689376e-05, "total_loss": 864.4056396484375, "policy_loss": -0.00026111266924999654, "vf_loss": 864.4049682617188, "vf_explained_var": 0.17296817898750305, "kl": 0.03117741085588932, "entropy": 1.7588796615600586, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2200000, "episodes_total": 4399, "training_iteration": 110, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-42-52", "timestamp": 1567226572, "time_this_iter_s": 15.442357540130615, "time_total_s": 1710.1981863975525, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1710.1981863975525, "timesteps_since_restore": 2200000, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 34.48636363636364, "ram_util_percent": 12.704545454545455}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 400.11051121610876, "episode_reward_min": 249.9093148177701, "episode_reward_mean": 318.45109394866705, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.093295918654494, "mean_processing_ms": 2.338997943370251, "mean_inference_ms": 0.669351793418706}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2216448, "num_steps_sampled": 2220000, "sample_time_ms": 13147.219, "load_time_ms": 13.182, "grad_time_ms": 2400.36, "update_time_ms": 5.031, "learner": {"default_policy": {"cur_kl_coeff": 0.03207230567932129, "cur_lr": 4.999999873689376e-05, "total_loss": 854.4046630859375, "policy_loss": 0.0015159629983827472, "vf_loss": 854.40185546875, "vf_explained_var": 0.18065917491912842, "kl": 0.042509086430072784, "entropy": 1.76536226272583, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2220000, "episodes_total": 4439, "training_iteration": 111, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-43-08", "timestamp": 1567226588, "time_this_iter_s": 15.64439344406128, "time_total_s": 1725.8425798416138, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1725.8425798416138, "timesteps_since_restore": 2220000, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 34.24090909090909, "ram_util_percent": 12.709090909090907}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 400.11051121610876, "episode_reward_min": 232.68455900551808, "episode_reward_mean": 318.4241386205994, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0900450575586382, "mean_processing_ms": 2.339323368410405, "mean_inference_ms": 0.669332944500786}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2236416, "num_steps_sampled": 2240000, "sample_time_ms": 13115.007, "load_time_ms": 13.216, "grad_time_ms": 2401.211, "update_time_ms": 5.062, "learner": {"default_policy": {"cur_kl_coeff": 0.048108458518981934, "cur_lr": 4.999999873689376e-05, "total_loss": 864.8829956054688, "policy_loss": 7.841984188416973e-05, "vf_loss": 864.8815307617188, "vf_explained_var": 0.19087938964366913, "kl": 0.027128811925649643, "entropy": 1.7221652269363403, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2240000, "episodes_total": 4479, "training_iteration": 112, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-43-23", "timestamp": 1567226603, "time_this_iter_s": 15.363353252410889, "time_total_s": 1741.2059330940247, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1741.2059330940247, "timesteps_since_restore": 2240000, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 34.954545454545446, "ram_util_percent": 12.713636363636363}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 400.3133567883837, "episode_reward_min": 232.68455900551808, "episode_reward_mean": 317.0300250237755, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0895715929560663, "mean_processing_ms": 2.339282789963302, "mean_inference_ms": 0.6694135800866104}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2256384, "num_steps_sampled": 2260000, "sample_time_ms": 13085.175, "load_time_ms": 13.242, "grad_time_ms": 2400.357, "update_time_ms": 4.936, "learner": {"default_policy": {"cur_kl_coeff": 0.048108458518981934, "cur_lr": 4.999999873689376e-05, "total_loss": 871.4332885742188, "policy_loss": 0.00765088340267539, "vf_loss": 871.4223022460938, "vf_explained_var": 0.18779635429382324, "kl": 0.07183900475502014, "entropy": 1.7529232501983643, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2260000, "episodes_total": 4519, "training_iteration": 113, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-43-38", "timestamp": 1567226618, "time_this_iter_s": 15.302414178848267, "time_total_s": 1756.508347272873, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1756.508347272873, "timesteps_since_restore": 2260000, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 34.063636363636355, "ram_util_percent": 12.709090909090907}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 400.3133567883837, "episode_reward_min": 232.68455900551808, "episode_reward_mean": 313.3317996015081, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.088558384650861, "mean_processing_ms": 2.3391880959822093, "mean_inference_ms": 0.6695931839034579}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2276352, "num_steps_sampled": 2280000, "sample_time_ms": 13054.18, "load_time_ms": 13.328, "grad_time_ms": 2400.41, "update_time_ms": 4.884, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 852.4840698242188, "policy_loss": -0.00029116333462297916, "vf_loss": 852.4825439453125, "vf_explained_var": 0.19238631427288055, "kl": 0.026246756315231323, "entropy": 1.779032826423645, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2280000, "episodes_total": 4558, "training_iteration": 114, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-43-54", "timestamp": 1567226634, "time_this_iter_s": 15.184502840042114, "time_total_s": 1771.692850112915, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1771.692850112915, "timesteps_since_restore": 2280000, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 34.60454545454545, "ram_util_percent": 12.713636363636363}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 396.20834595121835, "episode_reward_min": 251.92130195432924, "episode_reward_mean": 309.79075178224326, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0875735870502052, "mean_processing_ms": 2.339090301312763, "mean_inference_ms": 0.6697281717488279}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2296320, "num_steps_sampled": 2300000, "sample_time_ms": 13027.702, "load_time_ms": 13.392, "grad_time_ms": 2400.457, "update_time_ms": 4.88, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 894.9655151367188, "policy_loss": -0.0030803109984844923, "vf_loss": 894.9671630859375, "vf_explained_var": 0.196067214012146, "kl": 0.021197529509663582, "entropy": 1.7800116539001465, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2300000, "episodes_total": 4599, "training_iteration": 115, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-44-09", "timestamp": 1567226649, "time_this_iter_s": 15.326845169067383, "time_total_s": 1787.0196952819824, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1787.0196952819824, "timesteps_since_restore": 2300000, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 34.18636363636364, "ram_util_percent": 12.718181818181819}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 389.18794065593096, "episode_reward_min": 251.92130195432924, "episode_reward_mean": 308.60488199094107, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0881029382695315, "mean_processing_ms": 2.3389589989454014, "mean_inference_ms": 0.6701295973417121}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2316288, "num_steps_sampled": 2320000, "sample_time_ms": 12996.064, "load_time_ms": 13.403, "grad_time_ms": 2400.254, "update_time_ms": 4.831, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 867.74560546875, "policy_loss": 0.001600631047040224, "vf_loss": 867.7413940429688, "vf_explained_var": 0.19959241151809692, "kl": 0.035944145172834396, "entropy": 1.7709481716156006, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2320000, "episodes_total": 4638, "training_iteration": 116, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-44-24", "timestamp": 1567226664, "time_this_iter_s": 15.268298149108887, "time_total_s": 1802.2879934310913, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1802.2879934310913, "timesteps_since_restore": 2320000, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 36.438095238095244, "ram_util_percent": 12.714285714285714}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 399.4362670058602, "episode_reward_min": 251.92130195432924, "episode_reward_mean": 309.7766145521414, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0858212325310395, "mean_processing_ms": 2.3392314513719263, "mean_inference_ms": 0.6701251881375795}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2336256, "num_steps_sampled": 2340000, "sample_time_ms": 12929.193, "load_time_ms": 13.393, "grad_time_ms": 2399.054, "update_time_ms": 4.836, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 910.6846923828125, "policy_loss": 0.0005141264409758151, "vf_loss": 910.6820678710938, "vf_explained_var": 0.19839836657047272, "kl": 0.03064846061170101, "entropy": 1.7760181427001953, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2340000, "episodes_total": 4679, "training_iteration": 117, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-44-39", "timestamp": 1567226679, "time_this_iter_s": 15.169655084609985, "time_total_s": 1817.4576485157013, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1817.4576485157013, "timesteps_since_restore": 2340000, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 34.10454545454546, "ram_util_percent": 12.713636363636363}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 408.12938086983684, "episode_reward_min": 252.1142175207657, "episode_reward_mean": 313.69536750104794, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.085391964486737, "mean_processing_ms": 2.3393033475006892, "mean_inference_ms": 0.6703674451725881}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2356224, "num_steps_sampled": 2360000, "sample_time_ms": 12918.062, "load_time_ms": 13.473, "grad_time_ms": 2397.679, "update_time_ms": 4.824, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 901.8770141601562, "policy_loss": -0.0005296209128573537, "vf_loss": 901.87548828125, "vf_explained_var": 0.19619008898735046, "kl": 0.02803557924926281, "entropy": 1.72934091091156, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2360000, "episodes_total": 4719, "training_iteration": 118, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-44-55", "timestamp": 1567226695, "time_this_iter_s": 15.37409782409668, "time_total_s": 1832.831746339798, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1832.831746339798, "timesteps_since_restore": 2360000, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 35.88636363636363, "ram_util_percent": 12.713636363636363}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 414.142048318531, "episode_reward_min": 252.1142175207657, "episode_reward_mean": 319.55077704753944, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.089031642396671, "mean_processing_ms": 2.3394341744194156, "mean_inference_ms": 0.6706484139849087}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2376192, "num_steps_sampled": 2380000, "sample_time_ms": 12918.388, "load_time_ms": 13.499, "grad_time_ms": 2397.511, "update_time_ms": 4.801, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 916.7542114257812, "policy_loss": 0.0017303640488535166, "vf_loss": 916.7501220703125, "vf_explained_var": 0.1890634149312973, "kl": 0.034610237926244736, "entropy": 1.7106640338897705, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2380000, "episodes_total": 4759, "training_iteration": 119, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-45-10", "timestamp": 1567226710, "time_this_iter_s": 15.404866933822632, "time_total_s": 1848.2366132736206, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1848.2366132736206, "timesteps_since_restore": 2380000, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 35.74545454545454, "ram_util_percent": 12.727272727272727}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 414.142048318531, "episode_reward_min": 252.1142175207657, "episode_reward_mean": 321.65367040986064, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0923025076852184, "mean_processing_ms": 2.3392808847164654, "mean_inference_ms": 0.6709551882998588}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2396160, "num_steps_sampled": 2400000, "sample_time_ms": 12908.169, "load_time_ms": 13.525, "grad_time_ms": 2398.261, "update_time_ms": 4.777, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 901.8010864257812, "policy_loss": -0.0015247028786689043, "vf_loss": 901.8006591796875, "vf_explained_var": 0.1883038729429245, "kl": 0.02672901563346386, "entropy": 1.706373929977417, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2400000, "episodes_total": 4798, "training_iteration": 120, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-45-25", "timestamp": 1567226725, "time_this_iter_s": 15.347628116607666, "time_total_s": 1863.5842413902283, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1863.5842413902283, "timesteps_since_restore": 2400000, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 34.88636363636364, "ram_util_percent": 12.718181818181819}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 416.63006072258895, "episode_reward_min": 268.1467823392716, "episode_reward_mean": 320.0878140154353, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.086991665083245, "mean_processing_ms": 2.3393856414444922, "mean_inference_ms": 0.6707903454304116}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2416128, "num_steps_sampled": 2420000, "sample_time_ms": 12882.949, "load_time_ms": 13.536, "grad_time_ms": 2398.646, "update_time_ms": 4.779, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 943.5092163085938, "policy_loss": -0.0026820977218449116, "vf_loss": 943.5101318359375, "vf_explained_var": 0.18341147899627686, "kl": 0.02519482560455799, "entropy": 1.6935356855392456, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2420000, "episodes_total": 4839, "training_iteration": 121, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-45-41", "timestamp": 1567226741, "time_this_iter_s": 15.396275520324707, "time_total_s": 1878.980516910553, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1878.980516910553, "timesteps_since_restore": 2420000, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 34.02272727272728, "ram_util_percent": 12.718181818181819}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 416.63006072258895, "episode_reward_min": 264.7662040082489, "episode_reward_mean": 319.4742848853764, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0884432851735277, "mean_processing_ms": 2.3394973197384186, "mean_inference_ms": 0.670979820921843}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2436096, "num_steps_sampled": 2440000, "sample_time_ms": 12887.643, "load_time_ms": 13.568, "grad_time_ms": 2399.211, "update_time_ms": 4.753, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 925.42529296875, "policy_loss": -0.0020361316855996847, "vf_loss": 925.4251098632812, "vf_explained_var": 0.1816529929637909, "kl": 0.028628569096326828, "entropy": 1.6964937448501587, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2440000, "episodes_total": 4879, "training_iteration": 122, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-45-56", "timestamp": 1567226756, "time_this_iter_s": 15.416990756988525, "time_total_s": 1894.3975076675415, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1894.3975076675415, "timesteps_since_restore": 2440000, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 35.01363636363637, "ram_util_percent": 12.740909090909092}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 416.63006072258895, "episode_reward_min": 264.7662040082489, "episode_reward_mean": 318.95613031182484, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.088347072938478, "mean_processing_ms": 2.3395798954589786, "mean_inference_ms": 0.6710486036539004}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2456064, "num_steps_sampled": 2460000, "sample_time_ms": 12896.86, "load_time_ms": 13.581, "grad_time_ms": 2400.032, "update_time_ms": 4.772, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 928.9116821289062, "policy_loss": 0.0009392467327415943, "vf_loss": 928.9088745117188, "vf_explained_var": 0.1844051629304886, "kl": 0.027217527851462364, "entropy": 1.6814703941345215, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2460000, "episodes_total": 4919, "training_iteration": 123, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-46-12", "timestamp": 1567226772, "time_this_iter_s": 15.403646469116211, "time_total_s": 1909.8011541366577, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1909.8011541366577, "timesteps_since_restore": 2460000, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 34.72727272727273, "ram_util_percent": 12.736363636363636}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 424.3200500763877, "episode_reward_min": 268.04293363162355, "episode_reward_mean": 320.1488061965125, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.088412546532348, "mean_processing_ms": 2.3395925287403885, "mean_inference_ms": 0.6711452684793079}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2476032, "num_steps_sampled": 2480000, "sample_time_ms": 12927.15, "load_time_ms": 13.572, "grad_time_ms": 2399.065, "update_time_ms": 4.776, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 939.0797119140625, "policy_loss": -0.0013216030783951283, "vf_loss": 939.0789184570312, "vf_explained_var": 0.17416179180145264, "kl": 0.029337864369153976, "entropy": 1.7025246620178223, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2480000, "episodes_total": 4959, "training_iteration": 124, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-46-27", "timestamp": 1567226787, "time_this_iter_s": 15.477756977081299, "time_total_s": 1925.278911113739, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1925.278911113739, "timesteps_since_restore": 2480000, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 34.82727272727272, "ram_util_percent": 12.754545454545456}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 424.3200500763877, "episode_reward_min": 277.20430751629755, "episode_reward_mean": 321.7008191733914, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.08842431254535, "mean_processing_ms": 2.339590369336053, "mean_inference_ms": 0.6712104477965137}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2496000, "num_steps_sampled": 2500000, "sample_time_ms": 12942.3, "load_time_ms": 13.577, "grad_time_ms": 2397.861, "update_time_ms": 4.71, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 946.875, "policy_loss": -0.0008486835868097842, "vf_loss": 946.8742065429688, "vf_explained_var": 0.1747618168592453, "kl": 0.02449529990553856, "entropy": 1.6917691230773926, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2500000, "episodes_total": 4999, "training_iteration": 125, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-46-43", "timestamp": 1567226803, "time_this_iter_s": 15.465597867965698, "time_total_s": 1940.7445089817047, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1940.7445089817047, "timesteps_since_restore": 2500000, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 34.58181818181818, "ram_util_percent": 12.740909090909092}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 424.3200500763877, "episode_reward_min": 277.20430751629755, "episode_reward_mean": 322.38068090083993, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0883278282869835, "mean_processing_ms": 2.33956723018302, "mean_inference_ms": 0.6712502466691341}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2515968, "num_steps_sampled": 2520000, "sample_time_ms": 12967.614, "load_time_ms": 13.539, "grad_time_ms": 2398.301, "update_time_ms": 4.656, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 948.966552734375, "policy_loss": -0.0012910098303109407, "vf_loss": 948.9657592773438, "vf_explained_var": 0.17497475445270538, "kl": 0.028790893033146858, "entropy": 1.6931531429290771, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2520000, "episodes_total": 5039, "training_iteration": 126, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-46-58", "timestamp": 1567226818, "time_this_iter_s": 15.52527904510498, "time_total_s": 1956.2697880268097, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1956.2697880268097, "timesteps_since_restore": 2520000, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 34.409090909090914, "ram_util_percent": 12.75}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 421.67209885433766, "episode_reward_min": 277.48319958393495, "episode_reward_mean": 322.8321363324896, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0882474080014912, "mean_processing_ms": 2.3395517372279477, "mean_inference_ms": 0.6712931092081638}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2535936, "num_steps_sampled": 2540000, "sample_time_ms": 13002.336, "load_time_ms": 13.55, "grad_time_ms": 2396.921, "update_time_ms": 4.639, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 954.3474731445312, "policy_loss": -0.0024966115597635508, "vf_loss": 954.3485717773438, "vf_explained_var": 0.17622946202754974, "kl": 0.0184167493134737, "entropy": 1.691723108291626, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2540000, "episodes_total": 5079, "training_iteration": 127, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-47-14", "timestamp": 1567226834, "time_this_iter_s": 15.503276109695435, "time_total_s": 1971.7730641365051, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1971.7730641365051, "timesteps_since_restore": 2540000, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 34.72727272727272, "ram_util_percent": 12.759090909090908}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 421.67209885433766, "episode_reward_min": 269.4803029912653, "episode_reward_mean": 321.3160419162021, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.088156693459589, "mean_processing_ms": 2.339578152692349, "mean_inference_ms": 0.6713278688926175}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2555904, "num_steps_sampled": 2560000, "sample_time_ms": 13011.996, "load_time_ms": 13.476, "grad_time_ms": 2397.382, "update_time_ms": 4.66, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 957.6959228515625, "policy_loss": 0.0019468156388029456, "vf_loss": 957.6917114257812, "vf_explained_var": 0.17234550416469574, "kl": 0.030488723888993263, "entropy": 1.744382381439209, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2560000, "episodes_total": 5119, "training_iteration": 128, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-47-29", "timestamp": 1567226849, "time_this_iter_s": 15.474868535995483, "time_total_s": 1987.2479326725006, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1987.2479326725006, "timesteps_since_restore": 2560000, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 34.53636363636363, "ram_util_percent": 12.76818181818182}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 421.67209885433766, "episode_reward_min": 269.4803029912653, "episode_reward_mean": 316.2775968737733, "episode_len_mean": 500.0, "episodes_this_iter": 38, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.094201206938038, "mean_processing_ms": 2.339156710094605, "mean_inference_ms": 0.6714281474080701}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2575872, "num_steps_sampled": 2580000, "sample_time_ms": 12987.828, "load_time_ms": 13.479, "grad_time_ms": 2397.801, "update_time_ms": 4.67, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 910.5805053710938, "policy_loss": -0.00039116389234550297, "vf_loss": 910.5789184570312, "vf_explained_var": 0.174218088388443, "kl": 0.028072310611605644, "entropy": 1.7791904211044312, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2580000, "episodes_total": 5157, "training_iteration": 129, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-47-44", "timestamp": 1567226864, "time_this_iter_s": 15.16594910621643, "time_total_s": 2002.413881778717, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2002.413881778717, "timesteps_since_restore": 2580000, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 33.79090909090908, "ram_util_percent": 12.786363636363637}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 408.0189574533783, "episode_reward_min": 269.4803029912653, "episode_reward_mean": 311.913686111946, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.088783258039191, "mean_processing_ms": 2.3391242184591388, "mean_inference_ms": 0.6711695424865183}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2595840, "num_steps_sampled": 2600000, "sample_time_ms": 12943.653, "load_time_ms": 13.434, "grad_time_ms": 2398.891, "update_time_ms": 4.683, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 983.8482666015625, "policy_loss": -0.0029673506505787373, "vf_loss": 983.8497314453125, "vf_explained_var": 0.16989775002002716, "kl": 0.018972935155034065, "entropy": 1.821338176727295, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2600000, "episodes_total": 5198, "training_iteration": 130, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-47-59", "timestamp": 1567226879, "time_this_iter_s": 14.91634726524353, "time_total_s": 2017.3302290439606, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2017.3302290439606, "timesteps_since_restore": 2600000, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 34.86666666666666, "ram_util_percent": 12.776190476190477}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 391.5258796013703, "episode_reward_min": 278.57192466633563, "episode_reward_mean": 315.02027578029436, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0848303240517105, "mean_processing_ms": 2.3391488403200014, "mean_inference_ms": 0.6709832618192942}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2615808, "num_steps_sampled": 2620000, "sample_time_ms": 12918.691, "load_time_ms": 13.422, "grad_time_ms": 2399.105, "update_time_ms": 4.748, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 979.6029663085938, "policy_loss": 0.0006308779120445251, "vf_loss": 979.6005859375, "vf_explained_var": 0.17441847920417786, "kl": 0.025401175022125244, "entropy": 1.787841558456421, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2620000, "episodes_total": 5238, "training_iteration": 131, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-48-14", "timestamp": 1567226894, "time_this_iter_s": 15.14863395690918, "time_total_s": 2032.4788630008698, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2032.4788630008698, "timesteps_since_restore": 2620000, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 34.018181818181816, "ram_util_percent": 12.79090909090909}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 401.9342491273823, "episode_reward_min": 274.1717264961531, "episode_reward_mean": 318.3183254168525, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.084731908545586, "mean_processing_ms": 2.339226396970627, "mean_inference_ms": 0.6711213196565663}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2635776, "num_steps_sampled": 2640000, "sample_time_ms": 12857.129, "load_time_ms": 13.375, "grad_time_ms": 2398.997, "update_time_ms": 4.772, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 989.5509033203125, "policy_loss": -0.0029314786661416292, "vf_loss": 989.5523071289062, "vf_explained_var": 0.17364487051963806, "kl": 0.02227889560163021, "entropy": 1.8116048574447632, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2640000, "episodes_total": 5278, "training_iteration": 132, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-48-29", "timestamp": 1567226909, "time_this_iter_s": 14.799257278442383, "time_total_s": 2047.2781202793121, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2047.2781202793121, "timesteps_since_restore": 2640000, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 34.68571428571428, "ram_util_percent": 12.78095238095238}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 401.9342491273823, "episode_reward_min": 274.1717264961531, "episode_reward_mean": 319.65591983342887, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0838639800472207, "mean_processing_ms": 2.339382599619007, "mean_inference_ms": 0.671211981761451}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2655744, "num_steps_sampled": 2660000, "sample_time_ms": 12807.007, "load_time_ms": 13.37, "grad_time_ms": 2397.976, "update_time_ms": 4.795, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 1007.6732788085938, "policy_loss": -0.0018424399895593524, "vf_loss": 1007.6732788085938, "vf_explained_var": 0.1772458255290985, "kl": 0.024747563526034355, "entropy": 1.8362131118774414, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2660000, "episodes_total": 5319, "training_iteration": 133, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-48-44", "timestamp": 1567226924, "time_this_iter_s": 14.891517400741577, "time_total_s": 2062.1696376800537, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2062.1696376800537, "timesteps_since_restore": 2660000, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 34.47142857142857, "ram_util_percent": 12.785714285714286}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 401.9342491273823, "episode_reward_min": 263.3556278919182, "episode_reward_mean": 316.40015363865166, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0830237092993786, "mean_processing_ms": 2.3395049189536543, "mean_inference_ms": 0.6712201473213131}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2675712, "num_steps_sampled": 2680000, "sample_time_ms": 12795.34, "load_time_ms": 13.355, "grad_time_ms": 2398.811, "update_time_ms": 4.833, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 983.1907348632812, "policy_loss": -0.003428717376664281, "vf_loss": 983.1926879882812, "vf_explained_var": 0.18161484599113464, "kl": 0.020363159477710724, "entropy": 1.8554601669311523, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2680000, "episodes_total": 5359, "training_iteration": 134, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-49-00", "timestamp": 1567226940, "time_this_iter_s": 15.371006965637207, "time_total_s": 2077.540644645691, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2077.540644645691, "timesteps_since_restore": 2680000, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 33.404545454545456, "ram_util_percent": 12.795454545454545}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 401.37119970817275, "episode_reward_min": 263.3556278919182, "episode_reward_mean": 314.9696493438974, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0804490630434405, "mean_processing_ms": 2.3395304887810453, "mean_inference_ms": 0.6710425017705218}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2695680, "num_steps_sampled": 2700000, "sample_time_ms": 12721.782, "load_time_ms": 13.33, "grad_time_ms": 2399.639, "update_time_ms": 4.949, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 968.85107421875, "policy_loss": -0.001025057048536837, "vf_loss": 968.8497314453125, "vf_explained_var": 0.18637531995773315, "kl": 0.0320231057703495, "entropy": 1.838482141494751, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2700000, "episodes_total": 5398, "training_iteration": 135, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-49-14", "timestamp": 1567226954, "time_this_iter_s": 14.738760471343994, "time_total_s": 2092.279405117035, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2092.279405117035, "timesteps_since_restore": 2700000, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 34.780952380952385, "ram_util_percent": 12.8}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 402.9571094128515, "episode_reward_min": 275.11470080993263, "episode_reward_mean": 314.7245707294263, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.083182498633804, "mean_processing_ms": 2.339273034798907, "mean_inference_ms": 0.671091958029406}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2715648, "num_steps_sampled": 2720000, "sample_time_ms": 12647.31, "load_time_ms": 13.332, "grad_time_ms": 2399.289, "update_time_ms": 5.075, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 995.415283203125, "policy_loss": -0.0017619705758988857, "vf_loss": 995.4150390625, "vf_explained_var": 0.17957626283168793, "kl": 0.026550432667136192, "entropy": 1.828713059425354, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2720000, "episodes_total": 5438, "training_iteration": 136, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-49-29", "timestamp": 1567226969, "time_this_iter_s": 14.778905630111694, "time_total_s": 2107.0583107471466, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2107.0583107471466, "timesteps_since_restore": 2720000, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 34.290476190476184, "ram_util_percent": 12.790476190476191}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 402.9571094128515, "episode_reward_min": 263.3898763735439, "episode_reward_mean": 314.70205582995857, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.080719189942081, "mean_processing_ms": 2.33914171675554, "mean_inference_ms": 0.6710406383166336}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2735616, "num_steps_sampled": 2740000, "sample_time_ms": 12576.372, "load_time_ms": 13.376, "grad_time_ms": 2401.179, "update_time_ms": 5.072, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 995.3317260742188, "policy_loss": -0.0029886988922953606, "vf_loss": 995.3331298828125, "vf_explained_var": 0.1842622309923172, "kl": 0.020021148025989532, "entropy": 1.8526450395584106, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2740000, "episodes_total": 5478, "training_iteration": 137, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-49-44", "timestamp": 1567226984, "time_this_iter_s": 14.814185380935669, "time_total_s": 2121.8724961280823, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2121.8724961280823, "timesteps_since_restore": 2740000, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 34.72380952380953, "ram_util_percent": 12.8}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 402.9571094128515, "episode_reward_min": 263.3898763735439, "episode_reward_mean": 315.12931188166516, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.076544602560523, "mean_processing_ms": 2.339185993723011, "mean_inference_ms": 0.6710254329204617}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2755584, "num_steps_sampled": 2760000, "sample_time_ms": 12583.614, "load_time_ms": 13.386, "grad_time_ms": 2401.953, "update_time_ms": 5.101, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 994.700439453125, "policy_loss": -0.002348907059058547, "vf_loss": 994.700927734375, "vf_explained_var": 0.1733364760875702, "kl": 0.025707721710205078, "entropy": 1.8360280990600586, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2760000, "episodes_total": 5518, "training_iteration": 138, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-49-59", "timestamp": 1567226999, "time_this_iter_s": 15.555365085601807, "time_total_s": 2137.427861213684, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2137.427861213684, "timesteps_since_restore": 2760000, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 32.721739130434784, "ram_util_percent": 12.81304347826087}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 396.60021120180494, "episode_reward_min": 229.92450474068548, "episode_reward_mean": 316.0704892086853, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.076347835340822, "mean_processing_ms": 2.3393396162473055, "mean_inference_ms": 0.6711648600802659}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2775552, "num_steps_sampled": 2780000, "sample_time_ms": 12626.359, "load_time_ms": 13.445, "grad_time_ms": 2401.66, "update_time_ms": 5.116, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 1027.2564697265625, "policy_loss": -0.003210027702152729, "vf_loss": 1027.2578125, "vf_explained_var": 0.17494288086891174, "kl": 0.0245266854763031, "entropy": 1.8172032833099365, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2780000, "episodes_total": 5559, "training_iteration": 139, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-50-15", "timestamp": 1567227015, "time_this_iter_s": 15.59356141090393, "time_total_s": 2153.021422624588, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2153.021422624588, "timesteps_since_restore": 2780000, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 34.68181818181818, "ram_util_percent": 12.813636363636363}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 394.6621229782321, "episode_reward_min": 229.92450474068548, "episode_reward_mean": 317.71216672985685, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.077132921700622, "mean_processing_ms": 2.33949457910458, "mean_inference_ms": 0.6712370246191708}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2795520, "num_steps_sampled": 2800000, "sample_time_ms": 12671.057, "load_time_ms": 13.518, "grad_time_ms": 2400.82, "update_time_ms": 5.168, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 1001.713134765625, "policy_loss": -0.0025128407869488, "vf_loss": 1001.7142333984375, "vf_explained_var": 0.18379971385002136, "kl": 0.020201951265335083, "entropy": 1.8015297651290894, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2800000, "episodes_total": 5599, "training_iteration": 140, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-50-30", "timestamp": 1567227030, "time_this_iter_s": 15.356094598770142, "time_total_s": 2168.377517223358, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2168.377517223358, "timesteps_since_restore": 2800000, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 34.34545454545454, "ram_util_percent": 12.80909090909091}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 389.1150992132912, "episode_reward_min": 236.1861447917312, "episode_reward_mean": 315.13522571586077, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0769936870273944, "mean_processing_ms": 2.3396678597459926, "mean_inference_ms": 0.67130182212739}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2815488, "num_steps_sampled": 2820000, "sample_time_ms": 12726.784, "load_time_ms": 13.538, "grad_time_ms": 2400.629, "update_time_ms": 5.209, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 990.8390502929688, "policy_loss": -0.001661883550696075, "vf_loss": 990.8389282226562, "vf_explained_var": 0.1884717345237732, "kl": 0.024821100756525993, "entropy": 1.8262451887130737, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2820000, "episodes_total": 5639, "training_iteration": 141, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-50-46", "timestamp": 1567227046, "time_this_iter_s": 15.704249382019043, "time_total_s": 2184.081766605377, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2184.081766605377, "timesteps_since_restore": 2820000, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 34.49545454545455, "ram_util_percent": 12.804545454545456}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 388.77235562893713, "episode_reward_min": 117.35436757034327, "episode_reward_mean": 309.5020603410398, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0767203574793927, "mean_processing_ms": 2.339716149296043, "mean_inference_ms": 0.6712390769676594}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2835456, "num_steps_sampled": 2840000, "sample_time_ms": 12801.04, "load_time_ms": 13.571, "grad_time_ms": 2400.773, "update_time_ms": 5.175, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 986.2593994140625, "policy_loss": -0.00010442886559758335, "vf_loss": 986.2570190429688, "vf_explained_var": 0.18509441614151, "kl": 0.03202833980321884, "entropy": 1.8370925188064575, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2840000, "episodes_total": 5679, "training_iteration": 142, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-51-02", "timestamp": 1567227062, "time_this_iter_s": 15.544162273406982, "time_total_s": 2199.625928878784, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2199.625928878784, "timesteps_since_restore": 2840000, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 34.53181818181818, "ram_util_percent": 12.80909090909091}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 382.84608246106757, "episode_reward_min": 117.35436757034327, "episode_reward_mean": 303.1095852239076, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0766645594375404, "mean_processing_ms": 2.339738798243239, "mean_inference_ms": 0.6713056972797457}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2855424, "num_steps_sampled": 2860000, "sample_time_ms": 12869.393, "load_time_ms": 13.587, "grad_time_ms": 2401.005, "update_time_ms": 5.09, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 982.0853271484375, "policy_loss": -0.0039897882379591465, "vf_loss": 982.0877685546875, "vf_explained_var": 0.1842181384563446, "kl": 0.021557293832302094, "entropy": 1.8353344202041626, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2860000, "episodes_total": 5719, "training_iteration": 143, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-51-17", "timestamp": 1567227077, "time_this_iter_s": 15.57700252532959, "time_total_s": 2215.2029314041138, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2215.2029314041138, "timesteps_since_restore": 2860000, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 33.34782608695652, "ram_util_percent": 12.808695652173913}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 388.0797327725758, "episode_reward_min": 117.35436757034327, "episode_reward_mean": 303.8277217871931, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0764937240859127, "mean_processing_ms": 2.3397339277240867, "mean_inference_ms": 0.6713461346702843}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2875392, "num_steps_sampled": 2880000, "sample_time_ms": 12872.916, "load_time_ms": 13.592, "grad_time_ms": 2400.071, "update_time_ms": 5.015, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 988.4329223632812, "policy_loss": -0.0025621538516134024, "vf_loss": 988.4338989257812, "vf_explained_var": 0.18376120924949646, "kl": 0.020189670845866203, "entropy": 1.8294577598571777, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2880000, "episodes_total": 5759, "training_iteration": 144, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-51-33", "timestamp": 1567227093, "time_this_iter_s": 15.394963502883911, "time_total_s": 2230.5978949069977, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2230.5978949069977, "timesteps_since_restore": 2880000, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 34.95238095238095, "ram_util_percent": 12.80952380952381}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 388.0797327725758, "episode_reward_min": 182.42459623209288, "episode_reward_mean": 306.8581795310249, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.076286942814369, "mean_processing_ms": 2.339704667551782, "mean_inference_ms": 0.6713867710078657}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2895360, "num_steps_sampled": 2900000, "sample_time_ms": 12951.472, "load_time_ms": 13.622, "grad_time_ms": 2399.903, "update_time_ms": 5.003, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 992.2810668945312, "policy_loss": -0.0023168150801211596, "vf_loss": 992.2819213867188, "vf_explained_var": 0.18474499881267548, "kl": 0.019680261611938477, "entropy": 1.7939026355743408, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2900000, "episodes_total": 5799, "training_iteration": 145, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-51-48", "timestamp": 1567227108, "time_this_iter_s": 15.522529125213623, "time_total_s": 2246.1204240322113, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2246.1204240322113, "timesteps_since_restore": 2900000, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 33.40434782608696, "ram_util_percent": 12.81304347826087}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 379.5843335575572, "episode_reward_min": 256.8790447505676, "episode_reward_mean": 309.91642415889515, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0761208144605563, "mean_processing_ms": 2.339698721458766, "mean_inference_ms": 0.6714300223752585}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2915328, "num_steps_sampled": 2920000, "sample_time_ms": 13029.613, "load_time_ms": 13.656, "grad_time_ms": 2400.511, "update_time_ms": 5.029, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 990.4360961914062, "policy_loss": -0.0028606087435036898, "vf_loss": 990.4373168945312, "vf_explained_var": 0.18718181550502777, "kl": 0.022655852138996124, "entropy": 1.7707239389419556, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2920000, "episodes_total": 5839, "training_iteration": 146, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-52-04", "timestamp": 1567227124, "time_this_iter_s": 15.566470384597778, "time_total_s": 2261.686894416809, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2261.686894416809, "timesteps_since_restore": 2920000, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 34.24545454545454, "ram_util_percent": 12.818181818181818}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 389.57323598693705, "episode_reward_min": 273.87788909313946, "episode_reward_mean": 311.1861945587983, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0760443865464584, "mean_processing_ms": 2.3397103229305545, "mean_inference_ms": 0.6714846512899171}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2935296, "num_steps_sampled": 2940000, "sample_time_ms": 13117.248, "load_time_ms": 13.631, "grad_time_ms": 2399.997, "update_time_ms": 5.087, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 993.666259765625, "policy_loss": -0.003478553844615817, "vf_loss": 993.6681518554688, "vf_explained_var": 0.1849406510591507, "kl": 0.022951291874051094, "entropy": 1.7898743152618408, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2940000, "episodes_total": 5879, "training_iteration": 147, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-52-20", "timestamp": 1567227140, "time_this_iter_s": 15.685682535171509, "time_total_s": 2277.3725769519806, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2277.3725769519806, "timesteps_since_restore": 2940000, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 34.43181818181819, "ram_util_percent": 12.813636363636363}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 389.57323598693705, "episode_reward_min": 273.87788909313946, "episode_reward_mean": 309.1119057753083, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0774195041967674, "mean_processing_ms": 2.3395561218981498, "mean_inference_ms": 0.671593532886319}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2955264, "num_steps_sampled": 2960000, "sample_time_ms": 13070.983, "load_time_ms": 13.609, "grad_time_ms": 2399.842, "update_time_ms": 5.007, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 951.6720581054688, "policy_loss": -0.004505797289311886, "vf_loss": 951.6751708984375, "vf_explained_var": 0.20759204030036926, "kl": 0.018128136172890663, "entropy": 1.8170419931411743, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2960000, "episodes_total": 5918, "training_iteration": 148, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-52-35", "timestamp": 1567227155, "time_this_iter_s": 15.091100454330444, "time_total_s": 2292.463677406311, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2292.463677406311, "timesteps_since_restore": 2960000, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 34.345454545454544, "ram_util_percent": 12.818181818181818}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 385.95951352117726, "episode_reward_min": 265.34042849792934, "episode_reward_mean": 305.4304270774947, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.076287818111331, "mean_processing_ms": 2.3395481626535486, "mean_inference_ms": 0.6715563772620537}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2975232, "num_steps_sampled": 2980000, "sample_time_ms": 13064.619, "load_time_ms": 13.544, "grad_time_ms": 2401.06, "update_time_ms": 4.965, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 990.8591918945312, "policy_loss": -0.0016595536144450307, "vf_loss": 990.859375, "vf_explained_var": 0.19436964392662048, "kl": 0.021073848009109497, "entropy": 1.8439908027648926, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2980000, "episodes_total": 5959, "training_iteration": 149, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-52-50", "timestamp": 1567227170, "time_this_iter_s": 15.539857149124146, "time_total_s": 2308.003534555435, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2308.003534555435, "timesteps_since_restore": 2980000, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 33.38636363636363, "ram_util_percent": 12.818181818181818}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 385.95951352117726, "episode_reward_min": 260.0320707859632, "episode_reward_mean": 301.0379283398199, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.077925866009789, "mean_processing_ms": 2.339677880135751, "mean_inference_ms": 0.6717307489221445}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2995200, "num_steps_sampled": 3000000, "sample_time_ms": 13058.122, "load_time_ms": 13.512, "grad_time_ms": 2401.149, "update_time_ms": 4.899, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 957.74609375, "policy_loss": -0.003189014969393611, "vf_loss": 957.747802734375, "vf_explained_var": 0.19033531844615936, "kl": 0.02066010609269142, "entropy": 1.8596066236495972, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3000000, "episodes_total": 5999, "training_iteration": 150, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-53-05", "timestamp": 1567227185, "time_this_iter_s": 15.291038990020752, "time_total_s": 2323.294573545456, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2323.294573545456, "timesteps_since_restore": 3000000, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 34.8590909090909, "ram_util_percent": 12.818181818181818}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 380.7591532483585, "episode_reward_min": 260.0320707859632, "episode_reward_mean": 295.95948859131056, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0747956451112417, "mean_processing_ms": 2.3397783251045228, "mean_inference_ms": 0.6717349506544775}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3015168, "num_steps_sampled": 3020000, "sample_time_ms": 13030.568, "load_time_ms": 13.487, "grad_time_ms": 2401.292, "update_time_ms": 4.768, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 958.9180908203125, "policy_loss": -0.00245289015583694, "vf_loss": 958.9188842773438, "vf_explained_var": 0.16778111457824707, "kl": 0.022137785330414772, "entropy": 1.8956682682037354, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3020000, "episodes_total": 6039, "training_iteration": 151, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-53-21", "timestamp": 1567227201, "time_this_iter_s": 15.42969298362732, "time_total_s": 2338.7242665290833, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2338.7242665290833, "timesteps_since_restore": 3020000, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 34.81363636363636, "ram_util_percent": 12.818181818181818}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 380.4998605460922, "episode_reward_min": 260.0320707859632, "episode_reward_mean": 295.6184517309579, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0746749516368546, "mean_processing_ms": 2.339816021880693, "mean_inference_ms": 0.6718842592451719}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3035136, "num_steps_sampled": 3040000, "sample_time_ms": 13014.048, "load_time_ms": 13.479, "grad_time_ms": 2401.316, "update_time_ms": 4.749, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 960.8207397460938, "policy_loss": -0.005179119762033224, "vf_loss": 960.82421875, "vf_explained_var": 0.17894747853279114, "kl": 0.022459039464592934, "entropy": 1.8536510467529297, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3040000, "episodes_total": 6079, "training_iteration": 152, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-53-36", "timestamp": 1567227216, "time_this_iter_s": 15.377974271774292, "time_total_s": 2354.1022408008575, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2354.1022408008575, "timesteps_since_restore": 3040000, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 35.07727272727272, "ram_util_percent": 12.827272727272726}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 387.63044715301385, "episode_reward_min": 263.24019317361103, "episode_reward_mean": 300.37732134833493, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0746486257619505, "mean_processing_ms": 2.3398450779391164, "mean_inference_ms": 0.6720294083521694}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3055104, "num_steps_sampled": 3060000, "sample_time_ms": 13003.092, "load_time_ms": 13.475, "grad_time_ms": 2401.41, "update_time_ms": 4.787, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 976.99658203125, "policy_loss": -0.0037417535204440355, "vf_loss": 976.9989013671875, "vf_explained_var": 0.18607346713542938, "kl": 0.02010122314095497, "entropy": 1.855194091796875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3060000, "episodes_total": 6119, "training_iteration": 153, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-53-52", "timestamp": 1567227232, "time_this_iter_s": 15.469461917877197, "time_total_s": 2369.5717027187347, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2369.5717027187347, "timesteps_since_restore": 3060000, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 34.804545454545455, "ram_util_percent": 12.818181818181818}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 387.63044715301385, "episode_reward_min": 106.8151385646964, "episode_reward_mean": 299.6188437183714, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.07661098657661, "mean_processing_ms": 2.339909914406697, "mean_inference_ms": 0.6721394254125184}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3075072, "num_steps_sampled": 3080000, "sample_time_ms": 12996.534, "load_time_ms": 13.493, "grad_time_ms": 2401.443, "update_time_ms": 4.812, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 981.2095336914062, "policy_loss": -0.0038298589643090963, "vf_loss": 981.2115478515625, "vf_explained_var": 0.1884918510913849, "kl": 0.026259208098053932, "entropy": 1.8683902025222778, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3080000, "episodes_total": 6159, "training_iteration": 154, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-54-07", "timestamp": 1567227247, "time_this_iter_s": 15.330063581466675, "time_total_s": 2384.9017663002014, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2384.9017663002014, "timesteps_since_restore": 3080000, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 35.150000000000006, "ram_util_percent": 12.845454545454546}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 387.2630031240099, "episode_reward_min": 106.8151385646964, "episode_reward_mean": 299.57694959184346, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0762092369498384, "mean_processing_ms": 2.3399288727820244, "mean_inference_ms": 0.6722653832349059}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3095040, "num_steps_sampled": 3100000, "sample_time_ms": 12967.887, "load_time_ms": 13.547, "grad_time_ms": 2401.177, "update_time_ms": 4.792, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 964.2266845703125, "policy_loss": -0.003223827574402094, "vf_loss": 964.2281494140625, "vf_explained_var": 0.18631145358085632, "kl": 0.023958919569849968, "entropy": 1.8566558361053467, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3100000, "episodes_total": 6199, "training_iteration": 155, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-54-22", "timestamp": 1567227262, "time_this_iter_s": 15.234544038772583, "time_total_s": 2400.136310338974, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2400.136310338974, "timesteps_since_restore": 3100000, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 35.13333333333333, "ram_util_percent": 12.842857142857142}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 381.1778767730718, "episode_reward_min": 106.8151385646964, "episode_reward_mean": 297.3520254052304, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0777421524533395, "mean_processing_ms": 2.3398873664069284, "mean_inference_ms": 0.672322714403398}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3115008, "num_steps_sampled": 3120000, "sample_time_ms": 12942.071, "load_time_ms": 13.564, "grad_time_ms": 2401.166, "update_time_ms": 4.675, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 974.3382568359375, "policy_loss": -0.0033819584641605616, "vf_loss": 974.3400268554688, "vf_explained_var": 0.19240082800388336, "kl": 0.02041100151836872, "entropy": 1.8785192966461182, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3120000, "episodes_total": 6239, "training_iteration": 156, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-54-38", "timestamp": 1567227278, "time_this_iter_s": 15.308245658874512, "time_total_s": 2415.4445559978485, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2415.4445559978485, "timesteps_since_restore": 3120000, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 34.74999999999999, "ram_util_percent": 12.854545454545455}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 379.5889613294443, "episode_reward_min": 127.2038764331488, "episode_reward_mean": 298.710204307864, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.075124934444901, "mean_processing_ms": 2.3399378135748172, "mean_inference_ms": 0.6724412238981559}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3134976, "num_steps_sampled": 3140000, "sample_time_ms": 12889.735, "load_time_ms": 13.577, "grad_time_ms": 2401.378, "update_time_ms": 4.584, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 967.3787841796875, "policy_loss": -0.0048696305602788925, "vf_loss": 967.3823852539062, "vf_explained_var": 0.19392316043376923, "kl": 0.019742315635085106, "entropy": 1.8470141887664795, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3140000, "episodes_total": 6279, "training_iteration": 157, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-54-53", "timestamp": 1567227293, "time_this_iter_s": 15.162961483001709, "time_total_s": 2430.60751748085, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2430.60751748085, "timesteps_since_restore": 3140000, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 33.740909090909085, "ram_util_percent": 12.854545454545455}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 382.40809701694644, "episode_reward_min": 235.10749155801702, "episode_reward_mean": 299.8725701466936, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.074498413581675, "mean_processing_ms": 2.3398708127037433, "mean_inference_ms": 0.6725165146481143}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3154944, "num_steps_sampled": 3160000, "sample_time_ms": 12898.414, "load_time_ms": 13.611, "grad_time_ms": 2400.688, "update_time_ms": 4.639, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 979.6044921875, "policy_loss": -0.002563605783507228, "vf_loss": 979.6057739257812, "vf_explained_var": 0.18958649039268494, "kl": 0.0176047645509243, "entropy": 1.8363662958145142, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3160000, "episodes_total": 6319, "training_iteration": 158, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-55-08", "timestamp": 1567227308, "time_this_iter_s": 15.172016143798828, "time_total_s": 2445.779533624649, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2445.779533624649, "timesteps_since_restore": 3160000, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 35.438095238095244, "ram_util_percent": 12.866666666666665}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 382.40809701694644, "episode_reward_min": 235.10749155801702, "episode_reward_mean": 301.5338621904531, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0733675282756825, "mean_processing_ms": 2.339806643991947, "mean_inference_ms": 0.6726888779441816}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3174912, "num_steps_sampled": 3180000, "sample_time_ms": 12876.876, "load_time_ms": 13.736, "grad_time_ms": 2399.401, "update_time_ms": 4.697, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 960.6065673828125, "policy_loss": -0.003519762307405472, "vf_loss": 960.6090698242188, "vf_explained_var": 0.1960669755935669, "kl": 0.0143099594861269, "entropy": 1.835418701171875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3180000, "episodes_total": 6358, "training_iteration": 159, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-55-23", "timestamp": 1567227323, "time_this_iter_s": 15.312456369400024, "time_total_s": 2461.091989994049, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2461.091989994049, "timesteps_since_restore": 3180000, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 34.595454545454544, "ram_util_percent": 12.868181818181817}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
{"episode_reward_max": 380.80873770188504, "episode_reward_min": 249.97751785645568, "episode_reward_mean": 303.830543926708, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.072427850495386, "mean_processing_ms": 2.3397547853975715, "mean_inference_ms": 0.6727942768083017}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3194880, "num_steps_sampled": 3200000, "sample_time_ms": 12804.948, "load_time_ms": 13.786, "grad_time_ms": 2398.944, "update_time_ms": 4.733, "learner": {"default_policy": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 983.3271484375, "policy_loss": -0.0032933682668954134, "vf_loss": 983.3287353515625, "vf_explained_var": 0.1912895143032074, "kl": 0.021712321788072586, "entropy": 1.8094756603240967, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": true, "timesteps_total": 3200000, "episodes_total": 6398, "training_iteration": 160, "experiment_id": "d88119738ff54aa18eb57fbc7646f49a", "date": "2019-08-31_04-55-38", "timestamp": 1567227338, "time_this_iter_s": 14.568148851394653, "time_total_s": 2475.6601388454437, "pid": 43062, "hostname": "ip-172-31-31-27", "node_ip": "172.31.31.27", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_57\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2475.6601388454437, "timesteps_since_restore": 3200000, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 34.819047619047616, "ram_util_percent": 12.857142857142858}, "num_healthy_workers": 10, "trial_id": "ca023ede"}
