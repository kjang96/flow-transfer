{"policy_reward_mean": {"adversary": 261.23319274282466, "av": -261.23319274282466}, "time_since_restore": 34.749741077423096, "episodes_this_iter": 97, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 213.83505154639175, "timestamp": 1544502003, "time_total_s": 34.749741077423096, "done": false, "info": {"grad_time_ms": 8685.891, "load_time_ms": 137.684, "num_steps_trained": 20000, "adversary": {"vf_explained_var": 2.4873477286746493e-06, "kl": 0.020745767280459404, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 3311.266357421875, "total_loss": 3311.208740234375, "entropy": 136.18113708496094, "policy_loss": -0.0619889572262764}, "num_steps_sampled": 20000, "av": {"vf_explained_var": 2.2149238247948233e-06, "kl": 0.01278500072658062, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 3311.64892578125, "total_loss": 3311.638427734375, "entropy": 2.82340407371521, "policy_loss": -0.013231523334980011}, "update_time_ms": 1385.013, "sample_time_ms": 24390.814}, "timesteps_total": 20000, "date": "2018-12-11_04-20-03", "training_iteration": 1, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 34.749741077423096, "num_metric_batches_dropped": 0, "iterations_since_restore": 1, "timesteps_since_restore": 20000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f323946d0f0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 97}
{"policy_reward_mean": {"adversary": 200.65245881399068, "av": -200.65245881399068}, "time_since_restore": 59.54105305671692, "episodes_this_iter": 80, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 262.04, "timestamp": 1544502028, "time_total_s": 59.54105305671692, "done": false, "info": {"grad_time_ms": 8089.632, "load_time_ms": 77.278, "num_steps_trained": 40000, "adversary": {"vf_explained_var": 7.584308718833199e-07, "kl": 0.022388629615306854, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 1872.251220703125, "total_loss": 1872.191650390625, "entropy": 136.17083740234375, "policy_loss": -0.06390414386987686}, "num_steps_sampled": 40000, "av": {"vf_explained_var": 6.6711351109916e-07, "kl": 0.012596904300153255, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 1869.005615234375, "total_loss": 1868.9935302734375, "entropy": 2.8015849590301514, "policy_loss": -0.0143094751983881}, "update_time_ms": 696.771, "sample_time_ms": 20796.7}, "timesteps_total": 40000, "date": "2018-12-11_04-20-28", "training_iteration": 2, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 24.791311979293823, "num_metric_batches_dropped": 0, "iterations_since_restore": 2, "timesteps_since_restore": 40000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f3239488a90>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 177}
{"policy_reward_mean": {"adversary": 64.13768178993107, "av": -64.13768178993107}, "time_since_restore": 83.254714012146, "episodes_this_iter": 66, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 329.03, "timestamp": 1544502051, "time_total_s": 83.254714012146, "done": false, "info": {"grad_time_ms": 7961.779, "load_time_ms": 56.978, "num_steps_trained": 60000, "adversary": {"vf_explained_var": 1.2608674992975466e-08, "kl": 0.02595767378807068, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 457.9166564941406, "total_loss": 457.8497009277344, "entropy": 136.16812133789062, "policy_loss": -0.07215505093336105}, "num_steps_sampled": 60000, "av": {"vf_explained_var": 7.106707755610842e-08, "kl": 0.012475515715777874, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 457.8240051269531, "total_loss": 457.8124084472656, "entropy": 2.7879300117492676, "policy_loss": -0.014080686494708061}, "update_time_ms": 468.957, "sample_time_ms": 19171.866}, "timesteps_total": 60000, "date": "2018-12-11_04-20-51", "training_iteration": 3, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 23.713660955429077, "num_metric_batches_dropped": 0, "iterations_since_restore": 3, "timesteps_since_restore": 60000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f32394816d8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 243}
{"policy_reward_mean": {"adversary": -62.236012930450414, "av": 62.236012930450414}, "time_since_restore": 105.43185186386108, "episodes_this_iter": 52, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 368.99, "timestamp": 1544502074, "time_total_s": 105.43185186386108, "done": false, "info": {"grad_time_ms": 8003.193, "load_time_ms": 46.955, "num_steps_trained": 80000, "adversary": {"vf_explained_var": 0.14121711254119873, "kl": 0.027353430166840553, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 223.67164611816406, "total_loss": 223.60304260253906, "entropy": 136.16688537597656, "policy_loss": -0.07408375293016434}, "num_steps_sampled": 80000, "av": {"vf_explained_var": 0.14139872789382935, "kl": 0.01154915802180767, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 223.4324188232422, "total_loss": 223.4208984375, "entropy": 2.768669366836548, "policy_loss": -0.013834100216627121}, "update_time_ms": 354.703, "sample_time_ms": 17866.902}, "timesteps_total": 80000, "date": "2018-12-11_04-21-14", "training_iteration": 4, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 22.177137851715088, "num_metric_batches_dropped": 0, "iterations_since_restore": 4, "timesteps_since_restore": 80000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f323948f630>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 295}
{"policy_reward_mean": {"adversary": -183.43309782547865, "av": 183.43309782547865}, "time_since_restore": 125.73472332954407, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 445.14, "timestamp": 1544502094, "time_total_s": 125.73472332954407, "done": false, "info": {"grad_time_ms": 7943.69, "load_time_ms": 40.743, "num_steps_trained": 100000, "adversary": {"vf_explained_var": 0.08384088426828384, "kl": 0.027964463457465172, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 266.73211669921875, "total_loss": 266.6627502441406, "entropy": 136.140380859375, "policy_loss": -0.07492809742689133}, "num_steps_sampled": 100000, "av": {"vf_explained_var": 0.08357473462820053, "kl": 0.008314144797623158, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 268.6827697753906, "total_loss": 268.67376708984375, "entropy": 2.7605302333831787, "policy_loss": -0.010684027336537838}, "update_time_ms": 286.15, "sample_time_ms": 16797.085}, "timesteps_total": 100000, "date": "2018-12-11_04-21-34", "training_iteration": 5, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.302871465682983, "num_metric_batches_dropped": 0, "iterations_since_restore": 5, "timesteps_since_restore": 100000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f3239488278>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 339}
{"policy_reward_mean": {"adversary": -270.2209798177308, "av": 270.2209798177308}, "time_since_restore": 146.2607548236847, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 481.49, "timestamp": 1544502115, "time_total_s": 146.2607548236847, "done": false, "info": {"grad_time_ms": 7934.417, "load_time_ms": 36.782, "num_steps_trained": 120000, "adversary": {"vf_explained_var": 0.03183082118630409, "kl": 0.030881695449352264, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 304.0579833984375, "total_loss": 303.9839782714844, "entropy": 136.08851623535156, "policy_loss": -0.08016906678676605}, "num_steps_sampled": 120000, "av": {"vf_explained_var": 0.03313986212015152, "kl": 0.009064269252121449, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.10000002384185791, "vf_loss": 304.28240966796875, "total_loss": 304.27349853515625, "entropy": 2.7414021492004395, "policy_loss": -0.00979398563504219}, "update_time_ms": 240.425, "sample_time_ms": 16088.026}, "timesteps_total": 120000, "date": "2018-12-11_04-21-55", "training_iteration": 6, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.526031494140625, "num_metric_batches_dropped": 0, "iterations_since_restore": 6, "timesteps_since_restore": 120000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f323949d7f0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 384}
{"policy_reward_mean": {"adversary": -292.3998669719607, "av": 292.3998669719607}, "time_since_restore": 166.11399745941162, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 486.71, "timestamp": 1544502134, "time_total_s": 166.11399745941162, "done": false, "info": {"grad_time_ms": 7861.819, "load_time_ms": 33.938, "num_steps_trained": 140000, "adversary": {"vf_explained_var": 0.02807927131652832, "kl": 0.028177060186862946, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 328.5542297363281, "total_loss": 328.4849548339844, "entropy": 136.05621337890625, "policy_loss": -0.07492292672395706}, "num_steps_sampled": 140000, "av": {"vf_explained_var": 0.0303132813423872, "kl": 0.012232771143317223, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 328.25079345703125, "total_loss": 328.23907470703125, "entropy": 2.7163147926330566, "policy_loss": -0.012319878675043583}, "update_time_ms": 207.63, "sample_time_ms": 15553.376}, "timesteps_total": 140000, "date": "2018-12-11_04-22-14", "training_iteration": 7, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 19.85324263572693, "num_metric_batches_dropped": 0, "iterations_since_restore": 7, "timesteps_since_restore": 140000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f3239488be0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 430}
{"policy_reward_mean": {"adversary": -311.21668386168335, "av": 311.21668386168335}, "time_since_restore": 186.4938509464264, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 488.53, "timestamp": 1544502155, "time_total_s": 186.4938509464264, "done": false, "info": {"grad_time_ms": 7844.207, "load_time_ms": 32.158, "num_steps_trained": 160000, "adversary": {"vf_explained_var": 0.005660367663949728, "kl": 0.030985917896032333, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 356.9342346191406, "total_loss": 356.8605651855469, "entropy": 136.04074096679688, "policy_loss": -0.07986438274383545}, "num_steps_sampled": 160000, "av": {"vf_explained_var": 0.0073320758529007435, "kl": 0.011750939302146435, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 356.72918701171875, "total_loss": 356.7174377441406, "entropy": 2.7169744968414307, "policy_loss": -0.012349829077720642}, "update_time_ms": 182.952, "sample_time_ms": 15178.746}, "timesteps_total": 160000, "date": "2018-12-11_04-22-35", "training_iteration": 8, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.37985348701477, "num_metric_batches_dropped": 0, "iterations_since_restore": 8, "timesteps_since_restore": 160000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f3239488048>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 474}
{"policy_reward_mean": {"adversary": -332.0876309688612, "av": 332.0876309688612}, "time_since_restore": 207.29554915428162, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 497.15, "timestamp": 1544502176, "time_total_s": 207.29554915428162, "done": false, "info": {"grad_time_ms": 7849.971, "load_time_ms": 30.658, "num_steps_trained": 180000, "adversary": {"vf_explained_var": 0.0029901505913585424, "kl": 0.031467147171497345, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 360.5132751464844, "total_loss": 360.43951416015625, "entropy": 135.990966796875, "policy_loss": -0.08005405962467194}, "num_steps_sampled": 180000, "av": {"vf_explained_var": 0.0034540812484920025, "kl": 0.011388693004846573, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 360.1586608886719, "total_loss": 360.14691162109375, "entropy": 2.6934165954589844, "policy_loss": -0.012297908775508404}, "update_time_ms": 163.674, "sample_time_ms": 14915.325}, "timesteps_total": 180000, "date": "2018-12-11_04-22-56", "training_iteration": 9, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.801698207855225, "num_metric_batches_dropped": 0, "iterations_since_restore": 9, "timesteps_since_restore": 180000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f323949d7f0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 519}
{"policy_reward_mean": {"adversary": -348.1165029229571, "av": 348.1165029229571}, "time_since_restore": 227.25806832313538, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 499.67, "timestamp": 1544502196, "time_total_s": 227.25806832313538, "done": false, "info": {"grad_time_ms": 7847.275, "load_time_ms": 29.513, "num_steps_trained": 200000, "adversary": {"vf_explained_var": 0.0009979789610952139, "kl": 0.03263142332434654, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 377.4563903808594, "total_loss": 377.3800964355469, "entropy": 136.03260803222656, "policy_loss": -0.08282478153705597}, "num_steps_sampled": 200000, "av": {"vf_explained_var": 0.0006889444775879383, "kl": 0.013057234697043896, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 377.4546813964844, "total_loss": 377.4432067871094, "entropy": 2.6826436519622803, "policy_loss": -0.012121356092393398}, "update_time_ms": 148.124, "sample_time_ms": 14628.581}, "timesteps_total": 200000, "date": "2018-12-11_04-23-16", "training_iteration": 10, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 19.96251916885376, "num_metric_batches_dropped": 0, "iterations_since_restore": 10, "timesteps_since_restore": 200000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f3239481978>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 563}
{"policy_reward_mean": {"adversary": -370.0271423034664, "av": 370.0271423034664}, "time_since_restore": 247.88363695144653, "episodes_this_iter": 43, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 492.91, "timestamp": 1544502216, "time_total_s": 247.88363695144653, "done": false, "info": {"grad_time_ms": 7806.135, "load_time_ms": 17.779, "num_steps_trained": 220000, "adversary": {"vf_explained_var": 0.0001677144755376503, "kl": 0.03202549368143082, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 397.0229187011719, "total_loss": 396.94970703125, "entropy": 136.01504516601562, "policy_loss": -0.0795927569270134}, "num_steps_sampled": 220000, "av": {"vf_explained_var": 0.00014350085984915495, "kl": 0.017160028219223022, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 396.9660339355469, "total_loss": 396.953369140625, "entropy": 2.665325880050659, "policy_loss": -0.013538165017962456}, "update_time_ms": 10.449, "sample_time_ms": 13415.055}, "timesteps_total": 220000, "date": "2018-12-11_04-23-36", "training_iteration": 11, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.625568628311157, "num_metric_batches_dropped": 0, "iterations_since_restore": 11, "timesteps_since_restore": 220000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f3239488780>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 606}
{"policy_reward_mean": {"adversary": -368.61681163078805, "av": 368.61681163078805}, "time_since_restore": 268.4905984401703, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 492.91, "timestamp": 1544502237, "time_total_s": 268.4905984401703, "done": false, "info": {"grad_time_ms": 7885.315, "load_time_ms": 17.929, "num_steps_trained": 240000, "adversary": {"vf_explained_var": 0.00022076719324104488, "kl": 0.033041488379240036, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 393.86517333984375, "total_loss": 393.7914123535156, "entropy": 136.00042724609375, "policy_loss": -0.08038882911205292}, "num_steps_sampled": 240000, "av": {"vf_explained_var": 0.000338123383698985, "kl": 0.015472201630473137, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 393.9635314941406, "total_loss": 393.9499816894531, "entropy": 2.6475045680999756, "policy_loss": -0.014356295578181744}, "update_time_ms": 10.481, "sample_time_ms": 12916.973}, "timesteps_total": 240000, "date": "2018-12-11_04-23-57", "training_iteration": 12, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.606961488723755, "num_metric_batches_dropped": 0, "iterations_since_restore": 12, "timesteps_since_restore": 240000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f32394886a0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 651}
{"policy_reward_mean": {"adversary": -365.31432895636544, "av": 365.31432895636544}, "time_since_restore": 289.23652601242065, "episodes_this_iter": 47, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 490.6, "timestamp": 1544502258, "time_total_s": 289.23652601242065, "done": false, "info": {"grad_time_ms": 7939.727, "load_time_ms": 18.293, "num_steps_trained": 260000, "adversary": {"vf_explained_var": 2.280183252878487e-05, "kl": 0.034598998725414276, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 398.6125183105469, "total_loss": 398.5339050292969, "entropy": 135.97702026367188, "policy_loss": -0.08548356592655182}, "num_steps_sampled": 260000, "av": {"vf_explained_var": 9.134411811828613e-05, "kl": 0.01815912127494812, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 398.4505310058594, "total_loss": 398.4387512207031, "entropy": 2.651278495788574, "policy_loss": -0.01268762443214655}, "update_time_ms": 9.984, "sample_time_ms": 12563.73}, "timesteps_total": 260000, "date": "2018-12-11_04-24-18", "training_iteration": 13, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.745927572250366, "num_metric_batches_dropped": 0, "iterations_since_restore": 13, "timesteps_since_restore": 260000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f3239481860>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 698}
{"policy_reward_mean": {"adversary": -374.0799251801624, "av": 374.0799251801624}, "time_since_restore": 309.88920879364014, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 490.6, "timestamp": 1544502278, "time_total_s": 309.88920879364014, "done": false, "info": {"grad_time_ms": 7959.548, "load_time_ms": 18.202, "num_steps_trained": 280000, "adversary": {"vf_explained_var": 3.923208168998826e-06, "kl": 0.03432130068540573, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 400.32012939453125, "total_loss": 400.2427062988281, "entropy": 135.94261169433594, "policy_loss": -0.0842902809381485}, "num_steps_sampled": 280000, "av": {"vf_explained_var": 0.0010836254805326462, "kl": 0.014724571257829666, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 400.26153564453125, "total_loss": 400.2505187988281, "entropy": 2.6247150897979736, "policy_loss": -0.011703838594257832}, "update_time_ms": 9.697, "sample_time_ms": 12392.276}, "timesteps_total": 280000, "date": "2018-12-11_04-24-38", "training_iteration": 14, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.652682781219482, "num_metric_batches_dropped": 0, "iterations_since_restore": 14, "timesteps_since_restore": 280000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f3239488b00>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 742}
{"policy_reward_mean": {"adversary": -380.4213501550754, "av": 380.4213501550754}, "time_since_restore": 330.45808458328247, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 495.28, "timestamp": 1544502299, "time_total_s": 330.45808458328247, "done": false, "info": {"grad_time_ms": 8030.421, "load_time_ms": 18.419, "num_steps_trained": 300000, "adversary": {"vf_explained_var": 3.547966480255127e-05, "kl": 0.03524862229824066, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 402.37103271484375, "total_loss": 402.293212890625, "entropy": 135.9601593017578, "policy_loss": -0.0848703607916832}, "num_steps_sampled": 300000, "av": {"vf_explained_var": 0.00040339125553146005, "kl": 0.014411494135856628, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 402.157958984375, "total_loss": 402.1465759277344, "entropy": 2.5944206714630127, "policy_loss": -0.012107525020837784}, "update_time_ms": 9.357, "sample_time_ms": 12347.23}, "timesteps_total": 300000, "date": "2018-12-11_04-24-59", "training_iteration": 15, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.568875789642334, "num_metric_batches_dropped": 0, "iterations_since_restore": 15, "timesteps_since_restore": 300000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f32394969b0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 786}
{"policy_reward_mean": {"adversary": -375.33816678741954, "av": 375.33816678741954}, "time_since_restore": 352.02333760261536, "episodes_this_iter": 47, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 482.84, "timestamp": 1544502320, "time_total_s": 352.02333760261536, "done": false, "info": {"grad_time_ms": 8127.765, "load_time_ms": 18.349, "num_steps_trained": 320000, "adversary": {"vf_explained_var": 0.001997677143663168, "kl": 0.03506683558225632, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 416.5989990234375, "total_loss": 416.5226135253906, "entropy": 135.9414825439453, "policy_loss": -0.08342316746711731}, "num_steps_sampled": 320000, "av": {"vf_explained_var": 0.002636301564052701, "kl": 0.025422735139727592, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 416.4691467285156, "total_loss": 416.45562744140625, "entropy": 2.6064672470092773, "policy_loss": -0.014765462838113308}, "update_time_ms": 9.045, "sample_time_ms": 12355.154}, "timesteps_total": 320000, "date": "2018-12-11_04-25-20", "training_iteration": 16, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.565253019332886, "num_metric_batches_dropped": 0, "iterations_since_restore": 16, "timesteps_since_restore": 320000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f3239481390>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 833}
{"policy_reward_mean": {"adversary": -372.4651888320607, "av": 372.4651888320607}, "time_since_restore": 372.51012682914734, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 476.27, "timestamp": 1544502341, "time_total_s": 372.51012682914734, "done": false, "info": {"grad_time_ms": 8229.682, "load_time_ms": 18.26, "num_steps_trained": 340000, "adversary": {"vf_explained_var": 0.0008193652029149234, "kl": 0.03614643216133118, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 423.11822509765625, "total_loss": 423.0388488769531, "entropy": 135.9295654296875, "policy_loss": -0.08662313967943192}, "num_steps_sampled": 340000, "av": {"vf_explained_var": 0.0008380302460864186, "kl": 0.024812592193484306, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 422.71881103515625, "total_loss": 422.70587158203125, "entropy": 2.6166129112243652, "policy_loss": -0.014150912873446941}, "update_time_ms": 9.051, "sample_time_ms": 12316.542}, "timesteps_total": 340000, "date": "2018-12-11_04-25-41", "training_iteration": 17, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.486789226531982, "num_metric_batches_dropped": 0, "iterations_since_restore": 17, "timesteps_since_restore": 340000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f3239488f60>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 879}
{"policy_reward_mean": {"adversary": -379.12410586986795, "av": 379.12410586986795}, "time_since_restore": 393.631320476532, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 477.4, "timestamp": 1544502362, "time_total_s": 393.631320476532, "done": false, "info": {"grad_time_ms": 8299.603, "load_time_ms": 18.561, "num_steps_trained": 360000, "adversary": {"vf_explained_var": 0.0009809717303141952, "kl": 0.03640815243124962, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 442.832275390625, "total_loss": 442.75537109375, "entropy": 135.92379760742188, "policy_loss": -0.08424263447523117}, "num_steps_sampled": 360000, "av": {"vf_explained_var": 0.0013192284386605024, "kl": 0.019005432724952698, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 442.90264892578125, "total_loss": 442.8905334472656, "entropy": 2.590458393096924, "policy_loss": -0.013066999614238739}, "update_time_ms": 8.9, "sample_time_ms": 12320.72}, "timesteps_total": 360000, "date": "2018-12-11_04-26-02", "training_iteration": 18, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.121193647384644, "num_metric_batches_dropped": 0, "iterations_since_restore": 18, "timesteps_since_restore": 360000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f32394964a8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 924}
{"policy_reward_mean": {"adversary": -382.62379422965284, "av": 382.62379422965284}, "time_since_restore": 415.3112976551056, "episodes_this_iter": 49, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 469.05, "timestamp": 1544502384, "time_total_s": 415.3112976551056, "done": false, "info": {"grad_time_ms": 8375.665, "load_time_ms": 18.519, "num_steps_trained": 380000, "adversary": {"vf_explained_var": 0.002384551800787449, "kl": 0.03639279305934906, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 472.9375915527344, "total_loss": 472.8606872558594, "entropy": 135.946533203125, "policy_loss": -0.08416686207056046}, "num_steps_sampled": 380000, "av": {"vf_explained_var": 0.0038112120237201452, "kl": 0.03589973971247673, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 472.5563049316406, "total_loss": 472.5405578613281, "entropy": 2.6041247844696045, "policy_loss": -0.017493609338998795}, "update_time_ms": 8.767, "sample_time_ms": 12333.388}, "timesteps_total": 380000, "date": "2018-12-11_04-26-24", "training_iteration": 19, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.67997717857361, "num_metric_batches_dropped": 0, "iterations_since_restore": 19, "timesteps_since_restore": 380000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f32394881d0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 973}
{"policy_reward_mean": {"adversary": -389.04433925596624, "av": 389.04433925596624}, "time_since_restore": 436.11768555641174, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 467.69, "timestamp": 1544502405, "time_total_s": 436.11768555641174, "done": false, "info": {"grad_time_ms": 8454.783, "load_time_ms": 18.301, "num_steps_trained": 400000, "adversary": {"vf_explained_var": 0.006332610733807087, "kl": 0.03670040890574455, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 478.7311706542969, "total_loss": 478.65423583984375, "entropy": 135.97308349609375, "policy_loss": -0.08426515012979507}, "num_steps_sampled": 400000, "av": {"vf_explained_var": 0.0031641400419175625, "kl": 0.017957935109734535, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 478.5916442871094, "total_loss": 478.58001708984375, "entropy": 2.6123056411743164, "policy_loss": -0.01254032552242279}, "update_time_ms": 8.778, "sample_time_ms": 12338.414}, "timesteps_total": 400000, "date": "2018-12-11_04-26-45", "training_iteration": 20, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.806387901306152, "num_metric_batches_dropped": 0, "iterations_since_restore": 20, "timesteps_since_restore": 400000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f323949d5c0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 1018}
{"policy_reward_mean": {"adversary": -405.43413114495655, "av": 405.43413114495655}, "time_since_restore": 457.36841201782227, "episodes_this_iter": 43, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 489.14, "timestamp": 1544502426, "time_total_s": 457.36841201782227, "done": false, "info": {"grad_time_ms": 8515.378, "load_time_ms": 18.074, "num_steps_trained": 420000, "adversary": {"vf_explained_var": 0.0018140505999326706, "kl": 0.03729802370071411, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 464.97216796875, "total_loss": 464.8966979980469, "entropy": 135.9103546142578, "policy_loss": -0.08288369327783585}, "num_steps_sampled": 420000, "av": {"vf_explained_var": 0.0019090366549789906, "kl": 0.023438433185219765, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 465.5832214355469, "total_loss": 465.5712585449219, "entropy": 2.6312482357025146, "policy_loss": -0.013198292814195156}, "update_time_ms": 8.858, "sample_time_ms": 12340.559}, "timesteps_total": 420000, "date": "2018-12-11_04-27-06", "training_iteration": 21, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.250726461410522, "num_metric_batches_dropped": 0, "iterations_since_restore": 21, "timesteps_since_restore": 420000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f32394818d0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 1061}
{"policy_reward_mean": {"adversary": -395.9200726291173, "av": 395.9200726291173}, "time_since_restore": 478.7124037742615, "episodes_this_iter": 48, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 487.72, "timestamp": 1544502447, "time_total_s": 478.7124037742615, "done": false, "info": {"grad_time_ms": 8561.148, "load_time_ms": 17.919, "num_steps_trained": 440000, "adversary": {"vf_explained_var": 0.023731999099254608, "kl": 0.03565530106425285, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 490.3394470214844, "total_loss": 490.26251220703125, "entropy": 135.8634796142578, "policy_loss": -0.08406880497932434}, "num_steps_sampled": 440000, "av": {"vf_explained_var": 0.0060875918716192245, "kl": 0.016924837604165077, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 491.50750732421875, "total_loss": 491.49658203125, "entropy": 2.613676071166992, "policy_loss": -0.011778912506997585}, "update_time_ms": 8.904, "sample_time_ms": 12369.023}, "timesteps_total": 440000, "date": "2018-12-11_04-27-27", "training_iteration": 22, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.34399175643921, "num_metric_batches_dropped": 0, "iterations_since_restore": 22, "timesteps_since_restore": 440000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f32394886a0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 1109}
{"policy_reward_mean": {"adversary": -383.708064011768, "av": 383.708064011768}, "time_since_restore": 499.68842816352844, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 481.9, "timestamp": 1544502468, "time_total_s": 499.68842816352844, "done": false, "info": {"grad_time_ms": 8600.005, "load_time_ms": 18.146, "num_steps_trained": 460000, "adversary": {"vf_explained_var": 0.06299145519733429, "kl": 0.03737274929881096, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 465.74407958984375, "total_loss": 465.6671142578125, "entropy": 135.82229614257812, "policy_loss": -0.08448787778615952}, "num_steps_sampled": 460000, "av": {"vf_explained_var": 0.02486443892121315, "kl": 0.027405690401792526, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 474.04608154296875, "total_loss": 474.03265380859375, "entropy": 2.6447956562042236, "policy_loss": -0.014885912649333477}, "update_time_ms": 8.953, "sample_time_ms": 12353.873}, "timesteps_total": 460000, "date": "2018-12-11_04-27-48", "training_iteration": 23, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.976024389266968, "num_metric_batches_dropped": 0, "iterations_since_restore": 23, "timesteps_since_restore": 460000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f323948fd30>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 1153}
{"policy_reward_mean": {"adversary": -382.1284569218928, "av": 382.1284569218928}, "time_since_restore": 521.065667629242, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 483.34, "timestamp": 1544502490, "time_total_s": 521.065667629242, "done": false, "info": {"grad_time_ms": 8685.299, "load_time_ms": 18.528, "num_steps_trained": 480000, "adversary": {"vf_explained_var": 0.09627803415060043, "kl": 0.03729579597711563, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 475.42767333984375, "total_loss": 475.3507995605469, "entropy": 135.76795959472656, "policy_loss": -0.0843646451830864}, "num_steps_sampled": 480000, "av": {"vf_explained_var": 0.07916224747896194, "kl": 0.03078521601855755, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 490.1858825683594, "total_loss": 490.1728820800781, "entropy": 2.6418697834014893, "policy_loss": -0.014546632766723633}, "update_time_ms": 8.953, "sample_time_ms": 12340.192}, "timesteps_total": 480000, "date": "2018-12-11_04-28-10", "training_iteration": 24, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.3772394657135, "num_metric_batches_dropped": 0, "iterations_since_restore": 24, "timesteps_since_restore": 480000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f32394a6588>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 1199}
{"policy_reward_mean": {"adversary": -386.5033637711076, "av": 386.5033637711076}, "time_since_restore": 542.1225438117981, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 486.42, "timestamp": 1544502511, "time_total_s": 542.1225438117981, "done": false, "info": {"grad_time_ms": 8696.911, "load_time_ms": 18.638, "num_steps_trained": 500000, "adversary": {"vf_explained_var": 0.10705907642841339, "kl": 0.03760446980595589, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 463.9554138183594, "total_loss": 463.87841796875, "entropy": 135.70742797851562, "policy_loss": -0.08449011296033859}, "num_steps_sampled": 500000, "av": {"vf_explained_var": 0.09884484857320786, "kl": 0.02620888315141201, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 469.1407775878906, "total_loss": 469.12799072265625, "entropy": 2.6299939155578613, "policy_loss": -0.014100056141614914}, "update_time_ms": 8.951, "sample_time_ms": 12376.454}, "timesteps_total": 500000, "date": "2018-12-11_04-28-31", "training_iteration": 25, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.056876182556152, "num_metric_batches_dropped": 0, "iterations_since_restore": 25, "timesteps_since_restore": 500000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f3239481710>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 1243}
{"policy_reward_mean": {"adversary": -385.9778769751405, "av": 385.9778769751405}, "time_since_restore": 563.0992758274078, "episodes_this_iter": 47, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 487.2, "timestamp": 1544502532, "time_total_s": 563.0992758274078, "done": false, "info": {"grad_time_ms": 8666.575, "load_time_ms": 18.766, "num_steps_trained": 520000, "adversary": {"vf_explained_var": 0.11929908394813538, "kl": 0.03813653066754341, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 466.4173583984375, "total_loss": 466.3399353027344, "entropy": 135.70660400390625, "policy_loss": -0.08503665775060654}, "num_steps_sampled": 520000, "av": {"vf_explained_var": 0.11731112003326416, "kl": 0.024048224091529846, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 467.7603759765625, "total_loss": 467.7493591308594, "entropy": 2.633838653564453, "policy_loss": -0.012198842130601406}, "update_time_ms": 9.023, "sample_time_ms": 12347.065}, "timesteps_total": 520000, "date": "2018-12-11_04-28-52", "training_iteration": 26, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.97673201560974, "num_metric_batches_dropped": 0, "iterations_since_restore": 26, "timesteps_since_restore": 520000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f32394a6dd8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 1290}
{"policy_reward_mean": {"adversary": -384.99709288129844, "av": 384.99709288129844}, "time_since_restore": 584.1506741046906, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 483.67, "timestamp": 1544502553, "time_total_s": 584.1506741046906, "done": false, "info": {"grad_time_ms": 8698.048, "load_time_ms": 19.074, "num_steps_trained": 540000, "adversary": {"vf_explained_var": 0.10753162205219269, "kl": 0.037734273821115494, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 493.6655578613281, "total_loss": 493.5892028808594, "entropy": 135.72332763671875, "policy_loss": -0.08390835672616959}, "num_steps_sampled": 540000, "av": {"vf_explained_var": 0.10484039038419724, "kl": 0.02083580009639263, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 492.9574279785156, "total_loss": 492.9455261230469, "entropy": 2.632953643798828, "policy_loss": -0.012993581593036652}, "update_time_ms": 8.807, "sample_time_ms": 12370.763}, "timesteps_total": 540000, "date": "2018-12-11_04-29-13", "training_iteration": 27, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.051398277282715, "num_metric_batches_dropped": 0, "iterations_since_restore": 27, "timesteps_since_restore": 540000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f42cbe0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 1334}
{"policy_reward_mean": {"adversary": -371.29941821520026, "av": 371.29941821520026}, "time_since_restore": 604.9915902614594, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 476.06, "timestamp": 1544502574, "time_total_s": 604.9915902614594, "done": false, "info": {"grad_time_ms": 8699.196, "load_time_ms": 18.515, "num_steps_trained": 560000, "adversary": {"vf_explained_var": 0.12405216693878174, "kl": 0.037901412695646286, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 489.380859375, "total_loss": 489.3051452636719, "entropy": 135.61062622070312, "policy_loss": -0.08326379209756851}, "num_steps_sampled": 560000, "av": {"vf_explained_var": 0.1225130632519722, "kl": 0.02322445623576641, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 489.38372802734375, "total_loss": 489.3728942871094, "entropy": 2.661151647567749, "policy_loss": -0.01195856835693121}, "update_time_ms": 8.75, "sample_time_ms": 12343.928}, "timesteps_total": 560000, "date": "2018-12-11_04-29-34", "training_iteration": 28, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.8409161567688, "num_metric_batches_dropped": 0, "iterations_since_restore": 28, "timesteps_since_restore": 560000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f323949d4a8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 1380}
{"policy_reward_mean": {"adversary": -379.3146724107191, "av": 379.3146724107191}, "time_since_restore": 625.7299962043762, "episodes_this_iter": 43, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 492.39, "timestamp": 1544502594, "time_total_s": 625.7299962043762, "done": false, "info": {"grad_time_ms": 8685.628, "load_time_ms": 18.778, "num_steps_trained": 580000, "adversary": {"vf_explained_var": 0.1222061961889267, "kl": 0.03891652822494507, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 494.4005432128906, "total_loss": 494.32177734375, "entropy": 135.67640686035156, "policy_loss": -0.08655107766389847}, "num_steps_sampled": 580000, "av": {"vf_explained_var": 0.1236957311630249, "kl": 0.01911173202097416, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 492.34478759765625, "total_loss": 492.33447265625, "entropy": 2.595878839492798, "policy_loss": -0.011286912485957146}, "update_time_ms": 8.647, "sample_time_ms": 12262.817}, "timesteps_total": 580000, "date": "2018-12-11_04-29-54", "training_iteration": 29, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.73840594291687, "num_metric_batches_dropped": 0, "iterations_since_restore": 29, "timesteps_since_restore": 580000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f42f080>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 1423}
{"policy_reward_mean": {"adversary": -389.4936753958566, "av": 389.4936753958566}, "time_since_restore": 646.7074904441833, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 493.94, "timestamp": 1544502615, "time_total_s": 646.7074904441833, "done": false, "info": {"grad_time_ms": 8668.734, "load_time_ms": 18.979, "num_steps_trained": 600000, "adversary": {"vf_explained_var": 0.13513648509979248, "kl": 0.03820568323135376, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 524.28271484375, "total_loss": 524.2073364257812, "entropy": 135.6750030517578, "policy_loss": -0.08304060995578766}, "num_steps_sampled": 600000, "av": {"vf_explained_var": 0.13921043276786804, "kl": 0.02577114664018154, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 520.4081420898438, "total_loss": 520.39697265625, "entropy": 2.612976551055908, "policy_loss": -0.012460948899388313}, "update_time_ms": 8.677, "sample_time_ms": 12296.977}, "timesteps_total": 600000, "date": "2018-12-11_04-30-15", "training_iteration": 30, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.97749423980713, "num_metric_batches_dropped": 0, "iterations_since_restore": 30, "timesteps_since_restore": 600000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f323948fe48>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 1469}
{"policy_reward_mean": {"adversary": -381.1587308992044, "av": 381.1587308992044}, "time_since_restore": 667.7120888233185, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 485.65, "timestamp": 1544502636, "time_total_s": 667.7120888233185, "done": false, "info": {"grad_time_ms": 8615.385, "load_time_ms": 18.951, "num_steps_trained": 620000, "adversary": {"vf_explained_var": 0.10800663381814957, "kl": 0.03803040459752083, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 541.7611694335938, "total_loss": 541.6856689453125, "entropy": 135.58277893066406, "policy_loss": -0.0830412209033966}, "num_steps_sampled": 620000, "av": {"vf_explained_var": 0.11178058385848999, "kl": 0.023181581869721413, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 539.2342529296875, "total_loss": 539.2239379882812, "entropy": 2.6102898120880127, "policy_loss": -0.01144753023982048}, "update_time_ms": 8.681, "sample_time_ms": 12326.68}, "timesteps_total": 620000, "date": "2018-12-11_04-30-36", "training_iteration": 31, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.004598379135132, "num_metric_batches_dropped": 0, "iterations_since_restore": 31, "timesteps_since_restore": 620000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f42c208>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 1514}
{"policy_reward_mean": {"adversary": -356.83837349072587, "av": 356.83837349072587}, "time_since_restore": 689.250168800354, "episodes_this_iter": 50, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 463.51, "timestamp": 1544502658, "time_total_s": 689.250168800354, "done": false, "info": {"grad_time_ms": 8618.703, "load_time_ms": 19.226, "num_steps_trained": 640000, "adversary": {"vf_explained_var": 0.1073271781206131, "kl": 0.03803759440779686, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 614.5675659179688, "total_loss": 614.4907836914062, "entropy": 135.61203002929688, "policy_loss": -0.08434014022350311}, "num_steps_sampled": 640000, "av": {"vf_explained_var": 0.10727588832378387, "kl": 0.01966806873679161, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 612.7373657226562, "total_loss": 612.7266845703125, "entropy": 2.637617826461792, "policy_loss": -0.011697964742779732}, "update_time_ms": 8.633, "sample_time_ms": 12343.326}, "timesteps_total": 640000, "date": "2018-12-11_04-30-58", "training_iteration": 32, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.538079977035522, "num_metric_batches_dropped": 0, "iterations_since_restore": 32, "timesteps_since_restore": 640000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f32394a60b8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 1564}
{"policy_reward_mean": {"adversary": -362.3193787257706, "av": 362.3193787257706}, "time_since_restore": 710.1902351379395, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 468.27, "timestamp": 1544502679, "time_total_s": 710.1902351379395, "done": false, "info": {"grad_time_ms": 8581.035, "load_time_ms": 18.684, "num_steps_trained": 660000, "adversary": {"vf_explained_var": 0.13280552625656128, "kl": 0.03642239794135094, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 545.4660034179688, "total_loss": 545.3903198242188, "entropy": 135.64508056640625, "policy_loss": -0.08299971371889114}, "num_steps_sampled": 660000, "av": {"vf_explained_var": 0.1348155289888382, "kl": 0.023510422557592392, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 544.00390625, "total_loss": 543.9931640625, "entropy": 2.6054179668426514, "policy_loss": -0.011847304180264473}, "update_time_ms": 8.598, "sample_time_ms": 12379.234}, "timesteps_total": 660000, "date": "2018-12-11_04-31-19", "training_iteration": 33, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.94006633758545, "num_metric_batches_dropped": 0, "iterations_since_restore": 33, "timesteps_since_restore": 660000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f42fd30>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 1610}
{"policy_reward_mean": {"adversary": -376.87058416274954, "av": 376.87058416274954}, "time_since_restore": 731.0221400260925, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 480.65, "timestamp": 1544502700, "time_total_s": 731.0221400260925, "done": false, "info": {"grad_time_ms": 8515.488, "load_time_ms": 18.298, "num_steps_trained": 680000, "adversary": {"vf_explained_var": 0.14320887625217438, "kl": 0.0380147360265255, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 574.0782470703125, "total_loss": 574.0028076171875, "entropy": 135.63336181640625, "policy_loss": -0.08296898007392883}, "num_steps_sampled": 680000, "av": {"vf_explained_var": 0.14299356937408447, "kl": 0.020345672965049744, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 576.5559692382812, "total_loss": 576.5464477539062, "entropy": 2.6077778339385986, "policy_loss": -0.010554241016507149}, "update_time_ms": 8.603, "sample_time_ms": 12392.173}, "timesteps_total": 680000, "date": "2018-12-11_04-31-40", "training_iteration": 34, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.831904888153076, "num_metric_batches_dropped": 0, "iterations_since_restore": 34, "timesteps_since_restore": 680000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f42ca20>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 1654}
{"policy_reward_mean": {"adversary": -378.70551296940533, "av": 378.70551296940533}, "time_since_restore": 751.8214063644409, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 488.91, "timestamp": 1544502721, "time_total_s": 751.8214063644409, "done": false, "info": {"grad_time_ms": 8532.202, "load_time_ms": 18.261, "num_steps_trained": 700000, "adversary": {"vf_explained_var": 0.13466624915599823, "kl": 0.03837211802601814, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 560.359130859375, "total_loss": 560.282958984375, "entropy": 135.554931640625, "policy_loss": -0.08381897211074829}, "num_steps_sampled": 700000, "av": {"vf_explained_var": 0.13225992023944855, "kl": 0.023113099858164787, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 562.196044921875, "total_loss": 562.185791015625, "entropy": 2.6599390506744385, "policy_loss": -0.011447188444435596}, "update_time_ms": 8.446, "sample_time_ms": 12350.401}, "timesteps_total": 700000, "date": "2018-12-11_04-32-01", "training_iteration": 35, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.79926633834839, "num_metric_batches_dropped": 0, "iterations_since_restore": 35, "timesteps_since_restore": 700000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f42ce80>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 1699}
{"policy_reward_mean": {"adversary": -392.4260980488348, "av": 392.4260980488348}, "time_since_restore": 772.8557171821594, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 495.51, "timestamp": 1544502742, "time_total_s": 772.8557171821594, "done": false, "info": {"grad_time_ms": 8529.682, "load_time_ms": 18.636, "num_steps_trained": 720000, "adversary": {"vf_explained_var": 0.13648554682731628, "kl": 0.037902507930994034, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 604.6570434570312, "total_loss": 604.582275390625, "entropy": 135.56643676757812, "policy_loss": -0.08236903697252274}, "num_steps_sampled": 720000, "av": {"vf_explained_var": 0.14021888375282288, "kl": 0.024444757029414177, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 605.1007690429688, "total_loss": 605.0905151367188, "entropy": 2.6094300746917725, "policy_loss": -0.011551049537956715}, "update_time_ms": 8.549, "sample_time_ms": 12357.907}, "timesteps_total": 720000, "date": "2018-12-11_04-32-22", "training_iteration": 36, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.034310817718506, "num_metric_batches_dropped": 0, "iterations_since_restore": 36, "timesteps_since_restore": 720000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f42f0f0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 1744}
{"policy_reward_mean": {"adversary": -392.68517436288073, "av": 392.68517436288073}, "time_since_restore": 793.8765439987183, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 488.61, "timestamp": 1544502763, "time_total_s": 793.8765439987183, "done": false, "info": {"grad_time_ms": 8544.615, "load_time_ms": 18.652, "num_steps_trained": 740000, "adversary": {"vf_explained_var": 0.1425171196460724, "kl": 0.037462711334228516, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 650.9839477539062, "total_loss": 650.9090576171875, "entropy": 135.5445098876953, "policy_loss": -0.082381971180439}, "num_steps_sampled": 740000, "av": {"vf_explained_var": 0.15172412991523743, "kl": 0.023161517456173897, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 642.7212524414062, "total_loss": 642.7111206054688, "entropy": 2.632112979888916, "policy_loss": -0.011292321607470512}, "update_time_ms": 8.649, "sample_time_ms": 12338.362}, "timesteps_total": 740000, "date": "2018-12-11_04-32-43", "training_iteration": 37, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.020826816558838, "num_metric_batches_dropped": 0, "iterations_since_restore": 37, "timesteps_since_restore": 740000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f3239477438>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 1790}
{"policy_reward_mean": {"adversary": -384.7926146686093, "av": 384.7926146686093}, "time_since_restore": 814.5940790176392, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 486.89, "timestamp": 1544502783, "time_total_s": 814.5940790176392, "done": false, "info": {"grad_time_ms": 8570.066, "load_time_ms": 18.797, "num_steps_trained": 760000, "adversary": {"vf_explained_var": 0.15471777319908142, "kl": 0.03864141181111336, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 639.4060668945312, "total_loss": 639.3301391601562, "entropy": 135.4451141357422, "policy_loss": -0.0836406722664833}, "num_steps_sampled": 760000, "av": {"vf_explained_var": 0.16654978692531586, "kl": 0.019357357174158096, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 631.38525390625, "total_loss": 631.3773193359375, "entropy": 2.634794235229492, "policy_loss": -0.008905372582376003}, "update_time_ms": 8.53, "sample_time_ms": 12299.692}, "timesteps_total": 760000, "date": "2018-12-11_04-33-03", "training_iteration": 38, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.7175350189209, "num_metric_batches_dropped": 0, "iterations_since_restore": 38, "timesteps_since_restore": 760000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f323948fef0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 1834}
{"policy_reward_mean": {"adversary": -383.3230181713598, "av": 383.3230181713598}, "time_since_restore": 835.340386390686, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 483.99, "timestamp": 1544502804, "time_total_s": 835.340386390686, "done": false, "info": {"grad_time_ms": 8556.266, "load_time_ms": 18.756, "num_steps_trained": 780000, "adversary": {"vf_explained_var": 0.14907245337963104, "kl": 0.03751946985721588, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 674.3468017578125, "total_loss": 674.2714233398438, "entropy": 135.5078582763672, "policy_loss": -0.08288926631212234}, "num_steps_sampled": 780000, "av": {"vf_explained_var": 0.15730473399162292, "kl": 0.023251883685588837, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 668.0787353515625, "total_loss": 668.0700073242188, "entropy": 2.629469633102417, "policy_loss": -0.009834904223680496}, "update_time_ms": 8.683, "sample_time_ms": 12314.251}, "timesteps_total": 780000, "date": "2018-12-11_04-33-24", "training_iteration": 39, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.746307373046875, "num_metric_batches_dropped": 0, "iterations_since_restore": 39, "timesteps_since_restore": 780000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f42fba8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 1880}
{"policy_reward_mean": {"adversary": -383.23405895527213, "av": 383.23405895527213}, "time_since_restore": 856.4135084152222, "episodes_this_iter": 47, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 488.13, "timestamp": 1544502825, "time_total_s": 856.4135084152222, "done": false, "info": {"grad_time_ms": 8601.447, "load_time_ms": 18.923, "num_steps_trained": 800000, "adversary": {"vf_explained_var": 0.1684873253107071, "kl": 0.036627646535634995, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 666.81884765625, "total_loss": 666.744873046875, "entropy": 135.37054443359375, "policy_loss": -0.08125613629817963}, "num_steps_sampled": 800000, "av": {"vf_explained_var": 0.16907261312007904, "kl": 0.021363334730267525, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 667.7183227539062, "total_loss": 667.7080078125, "entropy": 2.692880392074585, "policy_loss": -0.01143381092697382}, "update_time_ms": 8.605, "sample_time_ms": 12278.5}, "timesteps_total": 800000, "date": "2018-12-11_04-33-45", "training_iteration": 40, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.073122024536133, "num_metric_batches_dropped": 0, "iterations_since_restore": 40, "timesteps_since_restore": 800000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f32394a66a0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 1927}
{"policy_reward_mean": {"adversary": -376.29785979655344, "av": 376.29785979655344}, "time_since_restore": 877.0981223583221, "episodes_this_iter": 43, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 485.58, "timestamp": 1544502846, "time_total_s": 877.0981223583221, "done": false, "info": {"grad_time_ms": 8613.589, "load_time_ms": 18.961, "num_steps_trained": 820000, "adversary": {"vf_explained_var": 0.1516227126121521, "kl": 0.039085328578948975, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 724.1227416992188, "total_loss": 724.0473022460938, "entropy": 135.34646606445312, "policy_loss": -0.08324281871318817}, "num_steps_sampled": 820000, "av": {"vf_explained_var": 0.15059489011764526, "kl": 0.022247957065701485, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 728.2836303710938, "total_loss": 728.2752685546875, "entropy": 2.6767029762268066, "policy_loss": -0.009490725584328175}, "update_time_ms": 8.528, "sample_time_ms": 12234.035}, "timesteps_total": 820000, "date": "2018-12-11_04-34-06", "training_iteration": 41, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.684613943099976, "num_metric_batches_dropped": 0, "iterations_since_restore": 41, "timesteps_since_restore": 820000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f42f2b0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 1970}
{"policy_reward_mean": {"adversary": -371.0447226553936, "av": 371.0447226553936}, "time_since_restore": 898.3909802436829, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 484.1, "timestamp": 1544502867, "time_total_s": 898.3909802436829, "done": false, "info": {"grad_time_ms": 8615.525, "load_time_ms": 18.678, "num_steps_trained": 840000, "adversary": {"vf_explained_var": 0.1560157686471939, "kl": 0.03874458372592926, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 720.781005859375, "total_loss": 720.7056274414062, "entropy": 135.3103485107422, "policy_loss": -0.0831041932106018}, "num_steps_sampled": 840000, "av": {"vf_explained_var": 0.15916797518730164, "kl": 0.019118500873446465, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 717.8383178710938, "total_loss": 717.8285522460938, "entropy": 2.629659652709961, "policy_loss": -0.010733301751315594}, "update_time_ms": 8.372, "sample_time_ms": 12207.778}, "timesteps_total": 840000, "date": "2018-12-11_04-34-27", "training_iteration": 42, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.292857885360718, "num_metric_batches_dropped": 0, "iterations_since_restore": 42, "timesteps_since_restore": 840000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f42c630>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 2014}
{"policy_reward_mean": {"adversary": -388.6622578540075, "av": 388.6622578540075}, "time_since_restore": 918.8287582397461, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 489.56, "timestamp": 1544502888, "time_total_s": 918.8287582397461, "done": false, "info": {"grad_time_ms": 8655.109, "load_time_ms": 18.862, "num_steps_trained": 860000, "adversary": {"vf_explained_var": 0.16312354803085327, "kl": 0.03837523236870766, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 749.4000244140625, "total_loss": 749.3235473632812, "entropy": 135.42190551757812, "policy_loss": -0.08412011712789536}, "num_steps_sampled": 860000, "av": {"vf_explained_var": 0.1635293811559677, "kl": 0.022330250591039658, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 747.6742553710938, "total_loss": 747.6670532226562, "entropy": 2.6472795009613037, "policy_loss": -0.008331283926963806}, "update_time_ms": 8.329, "sample_time_ms": 12117.283}, "timesteps_total": 860000, "date": "2018-12-11_04-34-48", "training_iteration": 43, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.437777996063232, "num_metric_batches_dropped": 0, "iterations_since_restore": 43, "timesteps_since_restore": 860000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f4477b8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 2060}
{"policy_reward_mean": {"adversary": -382.9507634672731, "av": 382.9507634672731}, "time_since_restore": 939.7571189403534, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 492.43, "timestamp": 1544502909, "time_total_s": 939.7571189403534, "done": false, "info": {"grad_time_ms": 8651.59, "load_time_ms": 19.259, "num_steps_trained": 880000, "adversary": {"vf_explained_var": 0.1589297205209732, "kl": 0.03993644937872887, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 757.0957641601562, "total_loss": 757.0194091796875, "entropy": 135.20260620117188, "policy_loss": -0.08424076437950134}, "num_steps_sampled": 880000, "av": {"vf_explained_var": 0.15751658380031586, "kl": 0.021420646458864212, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 756.6640625, "total_loss": 756.6547241210938, "entropy": 2.679533004760742, "policy_loss": -0.010383393615484238}, "update_time_ms": 8.38, "sample_time_ms": 12126.96}, "timesteps_total": 880000, "date": "2018-12-11_04-35-09", "training_iteration": 44, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.9283607006073, "num_metric_batches_dropped": 0, "iterations_since_restore": 44, "timesteps_since_restore": 880000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f32394a6f60>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 2106}
{"policy_reward_mean": {"adversary": -379.075335952812, "av": 379.075335952812}, "time_since_restore": 960.8013889789581, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 488.8, "timestamp": 1544502930, "time_total_s": 960.8013889789581, "done": false, "info": {"grad_time_ms": 8705.14, "load_time_ms": 18.996, "num_steps_trained": 900000, "adversary": {"vf_explained_var": 0.1830967664718628, "kl": 0.03878360986709595, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 785.3368530273438, "total_loss": 785.2611083984375, "entropy": 135.26986694335938, "policy_loss": -0.083551324903965}, "num_steps_sampled": 900000, "av": {"vf_explained_var": 0.1859072893857956, "kl": 0.023098209872841835, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 784.0361938476562, "total_loss": 784.0260620117188, "entropy": 2.680943727493286, "policy_loss": -0.011233000084757805}, "update_time_ms": 8.492, "sample_time_ms": 12098.743}, "timesteps_total": 900000, "date": "2018-12-11_04-35-30", "training_iteration": 45, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.044270038604736, "num_metric_batches_dropped": 0, "iterations_since_restore": 45, "timesteps_since_restore": 900000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f42ca20>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 2152}
{"policy_reward_mean": {"adversary": -379.3787906886301, "av": 379.3787906886301}, "time_since_restore": 981.740745306015, "episodes_this_iter": 43, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 490.9, "timestamp": 1544502951, "time_total_s": 981.740745306015, "done": false, "info": {"grad_time_ms": 8720.488, "load_time_ms": 18.676, "num_steps_trained": 920000, "adversary": {"vf_explained_var": 0.14987759292125702, "kl": 0.038869984447956085, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 778.7392578125, "total_loss": 778.6650390625, "entropy": 135.16819763183594, "policy_loss": -0.08212976902723312}, "num_steps_sampled": 920000, "av": {"vf_explained_var": 0.15379704535007477, "kl": 0.021084152162075043, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 775.8754272460938, "total_loss": 775.866943359375, "entropy": 2.632688522338867, "policy_loss": -0.009490731172263622}, "update_time_ms": 8.355, "sample_time_ms": 12074.55}, "timesteps_total": 920000, "date": "2018-12-11_04-35-51", "training_iteration": 46, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.939356327056885, "num_metric_batches_dropped": 0, "iterations_since_restore": 46, "timesteps_since_restore": 920000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f447400>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 2195}
{"policy_reward_mean": {"adversary": -375.3655526519535, "av": 375.3655526519535}, "time_since_restore": 1002.7425088882446, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 483.65, "timestamp": 1544502972, "time_total_s": 1002.7425088882446, "done": false, "info": {"grad_time_ms": 8711.423, "load_time_ms": 18.42, "num_steps_trained": 940000, "adversary": {"vf_explained_var": 0.17241837084293365, "kl": 0.03910789266228676, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 876.5863647460938, "total_loss": 876.5110473632812, "entropy": 135.36495971679688, "policy_loss": -0.08306103199720383}, "num_steps_sampled": 940000, "av": {"vf_explained_var": 0.17462553083896637, "kl": 0.02129862830042839, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 877.2879638671875, "total_loss": 877.2792358398438, "entropy": 2.628419876098633, "policy_loss": -0.00970308855175972}, "update_time_ms": 8.276, "sample_time_ms": 12084.803}, "timesteps_total": 940000, "date": "2018-12-11_04-36-12", "training_iteration": 47, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.001763582229614, "num_metric_batches_dropped": 0, "iterations_since_restore": 47, "timesteps_since_restore": 940000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f42ce48>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 2240}
{"policy_reward_mean": {"adversary": -382.57296920921885, "av": 382.57296920921885}, "time_since_restore": 1023.6945781707764, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 486.5, "timestamp": 1544502993, "time_total_s": 1023.6945781707764, "done": false, "info": {"grad_time_ms": 8740.209, "load_time_ms": 18.295, "num_steps_trained": 960000, "adversary": {"vf_explained_var": 0.17260493338108063, "kl": 0.038882724940776825, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 867.1639404296875, "total_loss": 867.0888671875, "entropy": 135.17454528808594, "policy_loss": -0.0829215869307518}, "num_steps_sampled": 960000, "av": {"vf_explained_var": 0.17353534698486328, "kl": 0.02223602868616581, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 874.6231079101562, "total_loss": 874.614990234375, "entropy": 2.6705985069274902, "policy_loss": -0.009059916250407696}, "update_time_ms": 8.647, "sample_time_ms": 12080.007}, "timesteps_total": 960000, "date": "2018-12-11_04-36-33", "training_iteration": 48, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.95206928253174, "num_metric_batches_dropped": 0, "iterations_since_restore": 48, "timesteps_since_restore": 960000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f438dd8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 2285}
{"policy_reward_mean": {"adversary": -392.1484472998584, "av": 392.1484472998584}, "time_since_restore": 1044.412213087082, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 497.36, "timestamp": 1544503013, "time_total_s": 1044.412213087082, "done": false, "info": {"grad_time_ms": 8776.776, "load_time_ms": 17.936, "num_steps_trained": 980000, "adversary": {"vf_explained_var": 0.16616417467594147, "kl": 0.03910838067531586, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 840.1366577148438, "total_loss": 840.0618286132812, "entropy": 135.19613647460938, "policy_loss": -0.08263573050498962}, "num_steps_sampled": 980000, "av": {"vf_explained_var": 0.16456279158592224, "kl": 0.025766555219888687, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 842.9529418945312, "total_loss": 842.9473266601562, "entropy": 2.6424615383148193, "policy_loss": -0.006996260955929756}, "update_time_ms": 8.636, "sample_time_ms": 12042.067}, "timesteps_total": 980000, "date": "2018-12-11_04-36-53", "training_iteration": 49, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.717634916305542, "num_metric_batches_dropped": 0, "iterations_since_restore": 49, "timesteps_since_restore": 980000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f447390>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 2330}
{"policy_reward_mean": {"adversary": -386.5166876376645, "av": 386.5166876376645}, "time_since_restore": 1065.756553888321, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 492.82, "timestamp": 1544503035, "time_total_s": 1065.756553888321, "done": false, "info": {"grad_time_ms": 8780.356, "load_time_ms": 17.538, "num_steps_trained": 1000000, "adversary": {"vf_explained_var": 0.15055082738399506, "kl": 0.03953909873962402, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 899.6478271484375, "total_loss": 899.5721435546875, "entropy": 135.23733520507812, "policy_loss": -0.08358877897262573}, "num_steps_sampled": 1000000, "av": {"vf_explained_var": 0.1510014683008194, "kl": 0.025142133235931396, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 898.1456298828125, "total_loss": 898.1356201171875, "entropy": 2.584419012069702, "policy_loss": -0.011073396541178226}, "update_time_ms": 8.685, "sample_time_ms": 12066.655}, "timesteps_total": 1000000, "date": "2018-12-11_04-37-15", "training_iteration": 50, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.344340801239014, "num_metric_batches_dropped": 0, "iterations_since_restore": 50, "timesteps_since_restore": 1000000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f42c390>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 2375}
{"policy_reward_mean": {"adversary": -377.2031116461153, "av": 377.2031116461153}, "time_since_restore": 1086.256758928299, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 481.67, "timestamp": 1544503055, "time_total_s": 1086.256758928299, "done": false, "info": {"grad_time_ms": 8787.901, "load_time_ms": 17.614, "num_steps_trained": 1020000, "adversary": {"vf_explained_var": 0.17247822880744934, "kl": 0.03931405767798424, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 958.0707397460938, "total_loss": 957.9945678710938, "entropy": 135.1257781982422, "policy_loss": -0.08399493247270584}, "num_steps_sampled": 1020000, "av": {"vf_explained_var": 0.17528554797172546, "kl": 0.02075216732919216, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 954.2889404296875, "total_loss": 954.2818603515625, "entropy": 2.749763250350952, "policy_loss": -0.008288185112178326}, "update_time_ms": 8.926, "sample_time_ms": 12039.982}, "timesteps_total": 1020000, "date": "2018-12-11_04-37-35", "training_iteration": 51, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.500205039978027, "num_metric_batches_dropped": 0, "iterations_since_restore": 51, "timesteps_since_restore": 1020000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f446908>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 2420}
{"policy_reward_mean": {"adversary": -368.55435413488516, "av": 368.55435413488516}, "time_since_restore": 1107.1311376094818, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 477.89, "timestamp": 1544503076, "time_total_s": 1107.1311376094818, "done": false, "info": {"grad_time_ms": 8770.099, "load_time_ms": 17.798, "num_steps_trained": 1040000, "adversary": {"vf_explained_var": 0.1570638120174408, "kl": 0.03907541185617447, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 975.8168334960938, "total_loss": 975.7421875, "entropy": 135.22393798828125, "policy_loss": -0.08246205747127533}, "num_steps_sampled": 1040000, "av": {"vf_explained_var": 0.1567017138004303, "kl": 0.019670696929097176, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 972.5995483398438, "total_loss": 972.5913696289062, "entropy": 2.67634654045105, "policy_loss": -0.009187069721519947}, "update_time_ms": 9.087, "sample_time_ms": 12016.324}, "timesteps_total": 1040000, "date": "2018-12-11_04-37-56", "training_iteration": 52, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.87437868118286, "num_metric_batches_dropped": 0, "iterations_since_restore": 52, "timesteps_since_restore": 1040000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f4502e8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 2464}
{"policy_reward_mean": {"adversary": -374.5319977312663, "av": 374.5319977312663}, "time_since_restore": 1128.5995717048645, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 490.35, "timestamp": 1544503098, "time_total_s": 1128.5995717048645, "done": false, "info": {"grad_time_ms": 8791.989, "load_time_ms": 17.985, "num_steps_trained": 1060000, "adversary": {"vf_explained_var": 0.1420891284942627, "kl": 0.0379067063331604, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 1119.4599609375, "total_loss": 1119.3875732421875, "entropy": 135.1074981689453, "policy_loss": -0.07973113656044006}, "num_steps_sampled": 1060000, "av": {"vf_explained_var": 0.1414015144109726, "kl": 0.02490876615047455, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1121.2196044921875, "total_loss": 1121.2113037109375, "entropy": 2.6736695766448975, "policy_loss": -0.009397700428962708}, "update_time_ms": 9.212, "sample_time_ms": 12095.63}, "timesteps_total": 1060000, "date": "2018-12-11_04-38-18", "training_iteration": 53, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.46843409538269, "num_metric_batches_dropped": 0, "iterations_since_restore": 53, "timesteps_since_restore": 1060000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f42cf60>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 2510}
{"policy_reward_mean": {"adversary": -368.51339575309646, "av": 368.51339575309646}, "time_since_restore": 1149.5179183483124, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 488.61, "timestamp": 1544503119, "time_total_s": 1149.5179183483124, "done": false, "info": {"grad_time_ms": 8810.639, "load_time_ms": 17.812, "num_steps_trained": 1080000, "adversary": {"vf_explained_var": 0.1636035293340683, "kl": 0.039039600640535355, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 1003.6142578125, "total_loss": 1003.5394897460938, "entropy": 135.15614318847656, "policy_loss": -0.08255445212125778}, "num_steps_sampled": 1080000, "av": {"vf_explained_var": 0.16329734027385712, "kl": 0.02004406414926052, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 997.677490234375, "total_loss": 997.670654296875, "entropy": 2.673851490020752, "policy_loss": -0.00778853427618742}, "update_time_ms": 9.003, "sample_time_ms": 12078.168}, "timesteps_total": 1080000, "date": "2018-12-11_04-38-39", "training_iteration": 54, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.918346643447876, "num_metric_batches_dropped": 0, "iterations_since_restore": 54, "timesteps_since_restore": 1080000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f32394a6c88>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 2556}
{"policy_reward_mean": {"adversary": -374.27157579111787, "av": 374.27157579111787}, "time_since_restore": 1170.6814322471619, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 480.89, "timestamp": 1544503140, "time_total_s": 1170.6814322471619, "done": false, "info": {"grad_time_ms": 8761.63, "load_time_ms": 18.034, "num_steps_trained": 1100000, "adversary": {"vf_explained_var": 0.14883649349212646, "kl": 0.03993877023458481, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 1063.1005859375, "total_loss": 1063.0252685546875, "entropy": 135.09011840820312, "policy_loss": -0.08330898731946945}, "num_steps_sampled": 1100000, "av": {"vf_explained_var": 0.14956027269363403, "kl": 0.023892154917120934, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1059.0352783203125, "total_loss": 1059.028076171875, "entropy": 2.6876659393310547, "policy_loss": -0.008465354330837727}, "update_time_ms": 9.138, "sample_time_ms": 12138.091}, "timesteps_total": 1100000, "date": "2018-12-11_04-39-00", "training_iteration": 55, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.163513898849487, "num_metric_batches_dropped": 0, "iterations_since_restore": 55, "timesteps_since_restore": 1100000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f446a90>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 2600}
{"policy_reward_mean": {"adversary": -370.5560497769441, "av": 370.5560497769441}, "time_since_restore": 1191.7725684642792, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 484.78, "timestamp": 1544503161, "time_total_s": 1191.7725684642792, "done": false, "info": {"grad_time_ms": 8772.193, "load_time_ms": 18.091, "num_steps_trained": 1120000, "adversary": {"vf_explained_var": 0.16859221458435059, "kl": 0.038315724581480026, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 1019.0075073242188, "total_loss": 1018.9332885742188, "entropy": 134.96839904785156, "policy_loss": -0.08183067291975021}, "num_steps_sampled": 1120000, "av": {"vf_explained_var": 0.16913463175296783, "kl": 0.022224334999918938, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1012.7828369140625, "total_loss": 1012.7752685546875, "entropy": 2.7411820888519287, "policy_loss": -0.008705847896635532}, "update_time_ms": 9.137, "sample_time_ms": 12142.399}, "timesteps_total": 1120000, "date": "2018-12-11_04-39-21", "training_iteration": 56, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.09113621711731, "num_metric_batches_dropped": 0, "iterations_since_restore": 56, "timesteps_since_restore": 1120000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f42c908>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 2646}
{"policy_reward_mean": {"adversary": -376.9569218226835, "av": 376.9569218226835}, "time_since_restore": 1212.5071549415588, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 488.23, "timestamp": 1544503182, "time_total_s": 1212.5071549415588, "done": false, "info": {"grad_time_ms": 8763.853, "load_time_ms": 18.265, "num_steps_trained": 1140000, "adversary": {"vf_explained_var": 0.1601596623659134, "kl": 0.039103373885154724, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 1034.2578125, "total_loss": 1034.182861328125, "entropy": 134.9375457763672, "policy_loss": -0.08264894038438797}, "num_steps_sampled": 1140000, "av": {"vf_explained_var": 0.15863239765167236, "kl": 0.023738933727145195, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1031.3583984375, "total_loss": 1031.3502197265625, "entropy": 2.699814796447754, "policy_loss": -0.009276136755943298}, "update_time_ms": 9.129, "sample_time_ms": 12122.719}, "timesteps_total": 1140000, "date": "2018-12-11_04-39-42", "training_iteration": 57, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.734586477279663, "num_metric_batches_dropped": 0, "iterations_since_restore": 57, "timesteps_since_restore": 1140000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f446780>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 2691}
{"policy_reward_mean": {"adversary": -374.95672403649013, "av": 374.95672403649013}, "time_since_restore": 1234.2354032993317, "episodes_this_iter": 48, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 482.71, "timestamp": 1544503203, "time_total_s": 1234.2354032993317, "done": false, "info": {"grad_time_ms": 8782.916, "load_time_ms": 18.396, "num_steps_trained": 1160000, "adversary": {"vf_explained_var": 0.16086091101169586, "kl": 0.03892652317881584, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 1093.4990234375, "total_loss": 1093.425048828125, "entropy": 134.8028106689453, "policy_loss": -0.08162359148263931}, "num_steps_sampled": 1160000, "av": {"vf_explained_var": 0.1581670045852661, "kl": 0.02499041147530079, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1097.0474853515625, "total_loss": 1097.0390625, "entropy": 2.756254196166992, "policy_loss": -0.009725330397486687}, "update_time_ms": 8.973, "sample_time_ms": 12179.9}, "timesteps_total": 1160000, "date": "2018-12-11_04-40-03", "training_iteration": 58, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.728248357772827, "num_metric_batches_dropped": 0, "iterations_since_restore": 58, "timesteps_since_restore": 1160000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f42f048>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 2739}
{"policy_reward_mean": {"adversary": -380.38774778216737, "av": 380.38774778216737}, "time_since_restore": 1254.9455223083496, "episodes_this_iter": 42, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 486.37, "timestamp": 1544503224, "time_total_s": 1254.9455223083496, "done": false, "info": {"grad_time_ms": 8770.21, "load_time_ms": 18.689, "num_steps_trained": 1180000, "adversary": {"vf_explained_var": 0.1473420262336731, "kl": 0.040539953857660294, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 1160.8570556640625, "total_loss": 1160.7806396484375, "entropy": 134.73831176757812, "policy_loss": -0.08437257260084152}, "num_steps_sampled": 1180000, "av": {"vf_explained_var": 0.14734798669815063, "kl": 0.024662774056196213, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1160.4425048828125, "total_loss": 1160.4349365234375, "entropy": 2.779094934463501, "policy_loss": -0.008964741602540016}, "update_time_ms": 8.991, "sample_time_ms": 12189.853}, "timesteps_total": 1180000, "date": "2018-12-11_04-40-24", "training_iteration": 59, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.710119009017944, "num_metric_batches_dropped": 0, "iterations_since_restore": 59, "timesteps_since_restore": 1180000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f446cc0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 2781}
{"policy_reward_mean": {"adversary": -372.14416100098225, "av": 372.14416100098225}, "time_since_restore": 1275.8464193344116, "episodes_this_iter": 49, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 483.4, "timestamp": 1544503245, "time_total_s": 1275.8464193344116, "done": false, "info": {"grad_time_ms": 8721.726, "load_time_ms": 18.797, "num_steps_trained": 1200000, "adversary": {"vf_explained_var": 0.14555087685585022, "kl": 0.03486265987157822, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1194.7486572265625, "total_loss": 1194.6776123046875, "entropy": 134.8327178955078, "policy_loss": -0.08159029483795166}, "num_steps_sampled": 1200000, "av": {"vf_explained_var": 0.14536167681217194, "kl": 0.020323874428868294, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1191.6258544921875, "total_loss": 1191.6182861328125, "entropy": 2.6916801929473877, "policy_loss": -0.008520128205418587}, "update_time_ms": 9.119, "sample_time_ms": 12192.966}, "timesteps_total": 1200000, "date": "2018-12-11_04-40-45", "training_iteration": 60, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.90089702606201, "num_metric_batches_dropped": 0, "iterations_since_restore": 60, "timesteps_since_restore": 1200000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f438208>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 2830}
{"policy_reward_mean": {"adversary": -364.8579675429524, "av": 364.8579675429524}, "time_since_restore": 1296.8187265396118, "episodes_this_iter": 43, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 484.04, "timestamp": 1544503266, "time_total_s": 1296.8187265396118, "done": false, "info": {"grad_time_ms": 8754.754, "load_time_ms": 18.657, "num_steps_trained": 1220000, "adversary": {"vf_explained_var": 0.13449612259864807, "kl": 0.03503037244081497, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1120.3668212890625, "total_loss": 1120.2967529296875, "entropy": 134.7529296875, "policy_loss": -0.08054894953966141}, "num_steps_sampled": 1220000, "av": {"vf_explained_var": 0.13106109201908112, "kl": 0.028320807963609695, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1122.70751953125, "total_loss": 1122.69970703125, "entropy": 2.7282581329345703, "policy_loss": -0.009189626201987267}, "update_time_ms": 8.928, "sample_time_ms": 12208.038}, "timesteps_total": 1220000, "date": "2018-12-11_04-41-06", "training_iteration": 61, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.972307205200195, "num_metric_batches_dropped": 0, "iterations_since_restore": 61, "timesteps_since_restore": 1220000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f323948fc88>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 2873}
{"policy_reward_mean": {"adversary": -369.735778326098, "av": 369.735778326098}, "time_since_restore": 1317.7615146636963, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 495.56, "timestamp": 1544503287, "time_total_s": 1317.7615146636963, "done": false, "info": {"grad_time_ms": 8743.151, "load_time_ms": 18.489, "num_steps_trained": 1240000, "adversary": {"vf_explained_var": 0.1380665898323059, "kl": 0.034531764686107635, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1170.492431640625, "total_loss": 1170.42041015625, "entropy": 134.6970672607422, "policy_loss": -0.08247743546962738}, "num_steps_sampled": 1240000, "av": {"vf_explained_var": 0.14071907103061676, "kl": 0.0235374104231596, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1172.6324462890625, "total_loss": 1172.6241455078125, "entropy": 2.7677037715911865, "policy_loss": -0.009385074488818645}, "update_time_ms": 8.911, "sample_time_ms": 12226.29}, "timesteps_total": 1240000, "date": "2018-12-11_04-41-27", "training_iteration": 62, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.942788124084473, "num_metric_batches_dropped": 0, "iterations_since_restore": 62, "timesteps_since_restore": 1240000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f4465f8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 2918}
{"policy_reward_mean": {"adversary": -373.8284476209572, "av": 373.8284476209572}, "time_since_restore": 1338.5892641544342, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 491.48, "timestamp": 1544503308, "time_total_s": 1338.5892641544342, "done": false, "info": {"grad_time_ms": 8730.23, "load_time_ms": 18.134, "num_steps_trained": 1260000, "adversary": {"vf_explained_var": 0.14992941915988922, "kl": 0.03534066304564476, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1171.2005615234375, "total_loss": 1171.1297607421875, "entropy": 134.68081665039062, "policy_loss": -0.08116365969181061}, "num_steps_sampled": 1260000, "av": {"vf_explained_var": 0.14438897371292114, "kl": 0.02473227120935917, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1177.808837890625, "total_loss": 1177.8009033203125, "entropy": 2.6957921981811523, "policy_loss": -0.009241432882845402}, "update_time_ms": 8.801, "sample_time_ms": 12177.459}, "timesteps_total": 1260000, "date": "2018-12-11_04-41-48", "training_iteration": 63, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.827749490737915, "num_metric_batches_dropped": 0, "iterations_since_restore": 63, "timesteps_since_restore": 1260000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f446be0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 2964}
{"policy_reward_mean": {"adversary": -372.5071990658344, "av": 372.5071990658344}, "time_since_restore": 1359.3434908390045, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 484.38, "timestamp": 1544503329, "time_total_s": 1359.3434908390045, "done": false, "info": {"grad_time_ms": 8742.26, "load_time_ms": 17.911, "num_steps_trained": 1280000, "adversary": {"vf_explained_var": 0.14658641815185547, "kl": 0.035632867366075516, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1201.6165771484375, "total_loss": 1201.54443359375, "entropy": 134.78933715820312, "policy_loss": -0.08276280015707016}, "num_steps_sampled": 1280000, "av": {"vf_explained_var": 0.15013091266155243, "kl": 0.022727439180016518, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1194.052001953125, "total_loss": 1194.044921875, "entropy": 2.697148561477661, "policy_loss": -0.008148197084665298}, "update_time_ms": 9.227, "sample_time_ms": 12150.041}, "timesteps_total": 1280000, "date": "2018-12-11_04-42-09", "training_iteration": 64, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.754226684570312, "num_metric_batches_dropped": 0, "iterations_since_restore": 64, "timesteps_since_restore": 1280000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f323948fc88>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 3009}
{"policy_reward_mean": {"adversary": -376.7281031948218, "av": 376.7281031948218}, "time_since_restore": 1379.6669826507568, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 492.13, "timestamp": 1544503349, "time_total_s": 1379.6669826507568, "done": false, "info": {"grad_time_ms": 8716.645, "load_time_ms": 17.702, "num_steps_trained": 1300000, "adversary": {"vf_explained_var": 0.1419539600610733, "kl": 0.03498643636703491, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1228.4278564453125, "total_loss": 1228.357421875, "entropy": 134.816650390625, "policy_loss": -0.08092725276947021}, "num_steps_sampled": 1300000, "av": {"vf_explained_var": 0.14283373951911926, "kl": 0.02417007088661194, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1225.2396240234375, "total_loss": 1225.232177734375, "entropy": 2.714547634124756, "policy_loss": -0.008651339448988438}, "update_time_ms": 9.318, "sample_time_ms": 12091.867}, "timesteps_total": 1300000, "date": "2018-12-11_04-42-29", "training_iteration": 65, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.32349181175232, "num_metric_batches_dropped": 0, "iterations_since_restore": 65, "timesteps_since_restore": 1300000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f450390>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 3053}
{"policy_reward_mean": {"adversary": -373.4471559550818, "av": 373.4471559550818}, "time_since_restore": 1400.635304927826, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 491.29, "timestamp": 1544503370, "time_total_s": 1400.635304927826, "done": false, "info": {"grad_time_ms": 8720.55, "load_time_ms": 17.729, "num_steps_trained": 1320000, "adversary": {"vf_explained_var": 0.13092593848705292, "kl": 0.03596855700016022, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1340.1802978515625, "total_loss": 1340.10693359375, "entropy": 134.82774353027344, "policy_loss": -0.08403044193983078}, "num_steps_sampled": 1320000, "av": {"vf_explained_var": 0.12703731656074524, "kl": 0.026591258123517036, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1336.323486328125, "total_loss": 1336.316650390625, "entropy": 2.7401368618011475, "policy_loss": -0.008078578859567642}, "update_time_ms": 9.57, "sample_time_ms": 12074.328}, "timesteps_total": 1320000, "date": "2018-12-11_04-42-50", "training_iteration": 66, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.968322277069092, "num_metric_batches_dropped": 0, "iterations_since_restore": 66, "timesteps_since_restore": 1320000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f4468d0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 3098}
{"policy_reward_mean": {"adversary": -373.51226233927815, "av": 373.51226233927815}, "time_since_restore": 1421.996917963028, "episodes_this_iter": 47, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 481.35, "timestamp": 1544503391, "time_total_s": 1421.996917963028, "done": false, "info": {"grad_time_ms": 8733.23, "load_time_ms": 17.556, "num_steps_trained": 1340000, "adversary": {"vf_explained_var": 0.14865484833717346, "kl": 0.03568629175424576, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1359.7896728515625, "total_loss": 1359.717529296875, "entropy": 134.95265197753906, "policy_loss": -0.08277954906225204}, "num_steps_sampled": 1340000, "av": {"vf_explained_var": 0.1459621787071228, "kl": 0.02527618408203125, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1355.871826171875, "total_loss": 1355.8653564453125, "entropy": 2.663266658782959, "policy_loss": -0.007689559366554022}, "update_time_ms": 9.744, "sample_time_ms": 12124.031}, "timesteps_total": 1340000, "date": "2018-12-11_04-43-11", "training_iteration": 67, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.361613035202026, "num_metric_batches_dropped": 0, "iterations_since_restore": 67, "timesteps_since_restore": 1340000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f32394886a0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 3145}
{"policy_reward_mean": {"adversary": -385.797082358524, "av": 385.797082358524}, "time_since_restore": 1442.9016425609589, "episodes_this_iter": 43, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 486.62, "timestamp": 1544503412, "time_total_s": 1442.9016425609589, "done": false, "info": {"grad_time_ms": 8696.434, "load_time_ms": 17.413, "num_steps_trained": 1360000, "adversary": {"vf_explained_var": 0.1448545604944229, "kl": 0.03603097051382065, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1301.8262939453125, "total_loss": 1301.7542724609375, "entropy": 134.89219665527344, "policy_loss": -0.08290993422269821}, "num_steps_sampled": 1360000, "av": {"vf_explained_var": 0.14227671921253204, "kl": 0.025695109739899635, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1301.3377685546875, "total_loss": 1301.3306884765625, "entropy": 2.73403000831604, "policy_loss": -0.0082557937130332}, "update_time_ms": 10.187, "sample_time_ms": 12078.632}, "timesteps_total": 1360000, "date": "2018-12-11_04-43-32", "training_iteration": 68, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.904724597930908, "num_metric_batches_dropped": 0, "iterations_since_restore": 68, "timesteps_since_restore": 1360000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f323948fc88>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 3188}
{"policy_reward_mean": {"adversary": -389.2123927316903, "av": 389.2123927316903}, "time_since_restore": 1463.9666874408722, "episodes_this_iter": 48, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 487.76, "timestamp": 1544503433, "time_total_s": 1463.9666874408722, "done": false, "info": {"grad_time_ms": 8730.871, "load_time_ms": 17.087, "num_steps_trained": 1380000, "adversary": {"vf_explained_var": 0.141714408993721, "kl": 0.0359986238181591, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1385.87646484375, "total_loss": 1385.8033447265625, "entropy": 134.8446044921875, "policy_loss": -0.08397529274225235}, "num_steps_sampled": 1380000, "av": {"vf_explained_var": 0.14217965304851532, "kl": 0.027044758200645447, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1381.6121826171875, "total_loss": 1381.6044921875, "entropy": 2.7371604442596436, "policy_loss": -0.009144210256636143}, "update_time_ms": 10.172, "sample_time_ms": 12081.646}, "timesteps_total": 1380000, "date": "2018-12-11_04-43-53", "training_iteration": 69, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.06504487991333, "num_metric_batches_dropped": 0, "iterations_since_restore": 69, "timesteps_since_restore": 1380000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f450278>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 3236}
{"policy_reward_mean": {"adversary": -380.7732319390993, "av": 380.7732319390993}, "time_since_restore": 1484.438407421112, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 484.97, "timestamp": 1544503454, "time_total_s": 1484.438407421112, "done": false, "info": {"grad_time_ms": 8729.599, "load_time_ms": 17.141, "num_steps_trained": 1400000, "adversary": {"vf_explained_var": 0.135050967335701, "kl": 0.03676416352391243, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1368.8831787109375, "total_loss": 1368.810302734375, "entropy": 134.73898315429688, "policy_loss": -0.08378566056489944}, "num_steps_sampled": 1400000, "av": {"vf_explained_var": 0.134398952126503, "kl": 0.02593988925218582, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1368.170654296875, "total_loss": 1368.1640625, "entropy": 2.705538749694824, "policy_loss": -0.007965761236846447}, "update_time_ms": 10.269, "sample_time_ms": 12039.178}, "timesteps_total": 1400000, "date": "2018-12-11_04-44-14", "training_iteration": 70, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.471719980239868, "num_metric_batches_dropped": 0, "iterations_since_restore": 70, "timesteps_since_restore": 1400000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f438f98>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 3280}
{"policy_reward_mean": {"adversary": -374.450385582078, "av": 374.450385582078}, "time_since_restore": 1505.6564826965332, "episodes_this_iter": 48, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 476.87, "timestamp": 1544503475, "time_total_s": 1505.6564826965332, "done": false, "info": {"grad_time_ms": 8687.958, "load_time_ms": 17.142, "num_steps_trained": 1420000, "adversary": {"vf_explained_var": 0.1376029998064041, "kl": 0.03596590831875801, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1461.261474609375, "total_loss": 1461.1900634765625, "entropy": 134.8625030517578, "policy_loss": -0.08206097036600113}, "num_steps_sampled": 1420000, "av": {"vf_explained_var": 0.13956086337566376, "kl": 0.029504910111427307, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1455.4202880859375, "total_loss": 1455.4124755859375, "entropy": 2.6888046264648438, "policy_loss": -0.009311087429523468}, "update_time_ms": 10.527, "sample_time_ms": 12104.12}, "timesteps_total": 1420000, "date": "2018-12-11_04-44-35", "training_iteration": 71, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.218075275421143, "num_metric_batches_dropped": 0, "iterations_since_restore": 71, "timesteps_since_restore": 1420000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f3239488b70>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 3328}
{"policy_reward_mean": {"adversary": -375.40759088678016, "av": 375.40759088678016}, "time_since_restore": 1527.020940065384, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 471.72, "timestamp": 1544503496, "time_total_s": 1527.020940065384, "done": false, "info": {"grad_time_ms": 8714.427, "load_time_ms": 17.262, "num_steps_trained": 1440000, "adversary": {"vf_explained_var": 0.1397034078836441, "kl": 0.03490051254630089, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1389.6998291015625, "total_loss": 1389.6298828125, "entropy": 134.6668243408203, "policy_loss": -0.08037630468606949}, "num_steps_sampled": 1440000, "av": {"vf_explained_var": 0.13935837149620056, "kl": 0.025400353595614433, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1385.27587890625, "total_loss": 1385.267822265625, "entropy": 2.726027727127075, "policy_loss": -0.009257900528609753}, "update_time_ms": 10.519, "sample_time_ms": 12118.697}, "timesteps_total": 1440000, "date": "2018-12-11_04-44-56", "training_iteration": 72, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.364457368850708, "num_metric_batches_dropped": 0, "iterations_since_restore": 72, "timesteps_since_restore": 1440000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f32394a6e10>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 3374}
{"policy_reward_mean": {"adversary": -375.6615759607229, "av": 375.6615759607229}, "time_since_restore": 1547.484986782074, "episodes_this_iter": 43, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 481.76, "timestamp": 1544503517, "time_total_s": 1547.484986782074, "done": false, "info": {"grad_time_ms": 8688.124, "load_time_ms": 17.244, "num_steps_trained": 1460000, "adversary": {"vf_explained_var": 0.15544837713241577, "kl": 0.03518933430314064, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1340.0362548828125, "total_loss": 1339.965576171875, "entropy": 134.5466766357422, "policy_loss": -0.0812637060880661}, "num_steps_sampled": 1460000, "av": {"vf_explained_var": 0.151414692401886, "kl": 0.025676432996988297, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1339.4346923828125, "total_loss": 1339.427490234375, "entropy": 2.855384349822998, "policy_loss": -0.008569247089326382}, "update_time_ms": 10.788, "sample_time_ms": 12108.58}, "timesteps_total": 1460000, "date": "2018-12-11_04-45-17", "training_iteration": 73, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.464046716690063, "num_metric_batches_dropped": 0, "iterations_since_restore": 73, "timesteps_since_restore": 1460000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f32394810f0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 3417}
{"policy_reward_mean": {"adversary": -368.3653441004941, "av": 368.3653441004941}, "time_since_restore": 1569.1320791244507, "episodes_this_iter": 48, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 477.17, "timestamp": 1544503539, "time_total_s": 1569.1320791244507, "done": false, "info": {"grad_time_ms": 8712.534, "load_time_ms": 17.566, "num_steps_trained": 1480000, "adversary": {"vf_explained_var": 0.15104986727237701, "kl": 0.03499092906713486, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1355.685546875, "total_loss": 1355.615234375, "entropy": 134.79409790039062, "policy_loss": -0.08069373667240143}, "num_steps_sampled": 1480000, "av": {"vf_explained_var": 0.15139611065387726, "kl": 0.026078099384903908, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1351.420654296875, "total_loss": 1351.4130859375, "entropy": 2.7020182609558105, "policy_loss": -0.008903910405933857}, "update_time_ms": 10.476, "sample_time_ms": 12171.282}, "timesteps_total": 1480000, "date": "2018-12-11_04-45-39", "training_iteration": 74, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.64709234237671, "num_metric_batches_dropped": 0, "iterations_since_restore": 74, "timesteps_since_restore": 1480000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f4506d8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 3465}
{"policy_reward_mean": {"adversary": -376.5163730182493, "av": 376.5163730182493}, "time_since_restore": 1589.6778869628906, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 485.41, "timestamp": 1544503559, "time_total_s": 1589.6778869628906, "done": false, "info": {"grad_time_ms": 8720.414, "load_time_ms": 17.663, "num_steps_trained": 1500000, "adversary": {"vf_explained_var": 0.15339389443397522, "kl": 0.03476734459400177, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1350.133056640625, "total_loss": 1350.062255859375, "entropy": 134.41416931152344, "policy_loss": -0.08109793066978455}, "num_steps_sampled": 1500000, "av": {"vf_explained_var": 0.15336544811725616, "kl": 0.026676906272768974, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1346.45263671875, "total_loss": 1346.4451904296875, "entropy": 2.858586549758911, "policy_loss": -0.008773600682616234}, "update_time_ms": 10.494, "sample_time_ms": 12184.202}, "timesteps_total": 1500000, "date": "2018-12-11_04-45-59", "training_iteration": 75, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.54580783843994, "num_metric_batches_dropped": 0, "iterations_since_restore": 75, "timesteps_since_restore": 1500000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f45b160>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 3510}
{"policy_reward_mean": {"adversary": -371.3145705301482, "av": 371.3145705301482}, "time_since_restore": 1610.3130872249603, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 490.33, "timestamp": 1544503580, "time_total_s": 1610.3130872249603, "done": false, "info": {"grad_time_ms": 8689.502, "load_time_ms": 17.377, "num_steps_trained": 1520000, "adversary": {"vf_explained_var": 0.14878623187541962, "kl": 0.03585977479815483, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1366.2032470703125, "total_loss": 1366.1341552734375, "entropy": 134.4254913330078, "policy_loss": -0.07987868785858154}, "num_steps_sampled": 1520000, "av": {"vf_explained_var": 0.15019743144512177, "kl": 0.026403065770864487, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1362.9141845703125, "total_loss": 1362.9071044921875, "entropy": 2.7987780570983887, "policy_loss": -0.00837730709463358}, "update_time_ms": 10.672, "sample_time_ms": 12182.439}, "timesteps_total": 1520000, "date": "2018-12-11_04-46-20", "training_iteration": 76, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.635200262069702, "num_metric_batches_dropped": 0, "iterations_since_restore": 76, "timesteps_since_restore": 1520000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f45bc18>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 3555}
{"policy_reward_mean": {"adversary": -373.49558217827473, "av": 373.49558217827473}, "time_since_restore": 1631.5258917808533, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 487.18, "timestamp": 1544503601, "time_total_s": 1631.5258917808533, "done": false, "info": {"grad_time_ms": 8720.147, "load_time_ms": 17.693, "num_steps_trained": 1540000, "adversary": {"vf_explained_var": 0.14503230154514313, "kl": 0.035493314266204834, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1463.5584716796875, "total_loss": 1463.4881591796875, "entropy": 134.47500610351562, "policy_loss": -0.0809221938252449}, "num_steps_sampled": 1540000, "av": {"vf_explained_var": 0.14299891889095306, "kl": 0.026250047609210014, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1464.65966796875, "total_loss": 1464.6514892578125, "entropy": 2.7453150749206543, "policy_loss": -0.009467542171478271}, "update_time_ms": 10.597, "sample_time_ms": 12136.546}, "timesteps_total": 1540000, "date": "2018-12-11_04-46-41", "training_iteration": 77, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.212804555892944, "num_metric_batches_dropped": 0, "iterations_since_restore": 77, "timesteps_since_restore": 1540000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f438c18>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 3600}
{"policy_reward_mean": {"adversary": -361.27657969518515, "av": 361.27657969518515}, "time_since_restore": 1652.6013050079346, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 476.94, "timestamp": 1544503622, "time_total_s": 1652.6013050079346, "done": false, "info": {"grad_time_ms": 8714.273, "load_time_ms": 17.659, "num_steps_trained": 1560000, "adversary": {"vf_explained_var": 0.1321910172700882, "kl": 0.03600779548287392, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1498.9158935546875, "total_loss": 1498.844970703125, "entropy": 134.3235321044922, "policy_loss": -0.08164659887552261}, "num_steps_sampled": 1560000, "av": {"vf_explained_var": 0.1271468847990036, "kl": 0.03260521590709686, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1498.1292724609375, "total_loss": 1498.12109375, "entropy": 2.776350259780884, "policy_loss": -0.00985732488334179}, "update_time_ms": 10.207, "sample_time_ms": 12159.822}, "timesteps_total": 1560000, "date": "2018-12-11_04-47-02", "training_iteration": 78, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.0754132270813, "num_metric_batches_dropped": 0, "iterations_since_restore": 78, "timesteps_since_restore": 1560000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f3239481860>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 3646}
{"policy_reward_mean": {"adversary": -354.26768890096724, "av": 354.26768890096724}, "time_since_restore": 1673.618973016739, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 471.51, "timestamp": 1544503643, "time_total_s": 1673.618973016739, "done": false, "info": {"grad_time_ms": 8696.694, "load_time_ms": 17.72, "num_steps_trained": 1580000, "adversary": {"vf_explained_var": 0.14414750039577484, "kl": 0.03625873476266861, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1513.9366455078125, "total_loss": 1513.863525390625, "entropy": 134.35069274902344, "policy_loss": -0.08396591246128082}, "num_steps_sampled": 1580000, "av": {"vf_explained_var": 0.13756994903087616, "kl": 0.022076983004808426, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1522.4923095703125, "total_loss": 1522.4853515625, "entropy": 2.763000965118408, "policy_loss": -0.008002672344446182}, "update_time_ms": 10.386, "sample_time_ms": 12172.614}, "timesteps_total": 1580000, "date": "2018-12-11_04-47-23", "training_iteration": 79, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.01766800880432, "num_metric_batches_dropped": 0, "iterations_since_restore": 79, "timesteps_since_restore": 1580000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f438a20>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 3692}
{"policy_reward_mean": {"adversary": -364.06525510191415, "av": 364.06525510191415}, "time_since_restore": 1694.5601704120636, "episodes_this_iter": 48, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 475.91, "timestamp": 1544503664, "time_total_s": 1694.5601704120636, "done": false, "info": {"grad_time_ms": 8735.549, "load_time_ms": 17.475, "num_steps_trained": 1600000, "adversary": {"vf_explained_var": 0.1424558013677597, "kl": 0.03496623411774635, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1556.310302734375, "total_loss": 1556.2401123046875, "entropy": 134.10948181152344, "policy_loss": -0.0806485265493393}, "num_steps_sampled": 1600000, "av": {"vf_explained_var": 0.14488618075847626, "kl": 0.027653995901346207, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1568.73095703125, "total_loss": 1568.72265625, "entropy": 2.8495781421661377, "policy_loss": -0.009665360674262047}, "update_time_ms": 10.208, "sample_time_ms": 12182.299}, "timesteps_total": 1600000, "date": "2018-12-11_04-47-44", "training_iteration": 80, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.941197395324707, "num_metric_batches_dropped": 0, "iterations_since_restore": 80, "timesteps_since_restore": 1600000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f3239488ef0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 3740}
{"policy_reward_mean": {"adversary": -362.54768776432394, "av": 362.54768776432394}, "time_since_restore": 1715.3947093486786, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 472.03, "timestamp": 1544503685, "time_total_s": 1715.3947093486786, "done": false, "info": {"grad_time_ms": 8746.046, "load_time_ms": 17.505, "num_steps_trained": 1620000, "adversary": {"vf_explained_var": 0.12384691089391708, "kl": 0.036636143922805786, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1495.638427734375, "total_loss": 1495.56689453125, "entropy": 134.1680450439453, "policy_loss": -0.08248414844274521}, "num_steps_sampled": 1620000, "av": {"vf_explained_var": 0.12062814831733704, "kl": 0.02770255133509636, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1501.9757080078125, "total_loss": 1501.968994140625, "entropy": 2.781801700592041, "policy_loss": -0.008282937109470367}, "update_time_ms": 10.146, "sample_time_ms": 12133.146}, "timesteps_total": 1620000, "date": "2018-12-11_04-48-05", "training_iteration": 81, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.83453893661499, "num_metric_batches_dropped": 0, "iterations_since_restore": 81, "timesteps_since_restore": 1620000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f4380f0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 3785}
{"policy_reward_mean": {"adversary": -368.62277280156127, "av": 368.62277280156127}, "time_since_restore": 1736.2736990451813, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 474.64, "timestamp": 1544503706, "time_total_s": 1736.2736990451813, "done": false, "info": {"grad_time_ms": 8728.744, "load_time_ms": 17.471, "num_steps_trained": 1640000, "adversary": {"vf_explained_var": 0.13221539556980133, "kl": 0.036098726093769073, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1530.5855712890625, "total_loss": 1530.514404296875, "entropy": 134.36192321777344, "policy_loss": -0.0820227637887001}, "num_steps_sampled": 1640000, "av": {"vf_explained_var": 0.13657131791114807, "kl": 0.03081163950264454, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1527.4427490234375, "total_loss": 1527.43505859375, "entropy": 2.7949845790863037, "policy_loss": -0.009261277504265308}, "update_time_ms": 10.409, "sample_time_ms": 12099.625}, "timesteps_total": 1640000, "date": "2018-12-11_04-48-26", "training_iteration": 82, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.878989696502686, "num_metric_batches_dropped": 0, "iterations_since_restore": 82, "timesteps_since_restore": 1640000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f447518>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 3830}
{"policy_reward_mean": {"adversary": -372.4278993298021, "av": 372.4278993298021}, "time_since_restore": 1757.245896100998, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 481.15, "timestamp": 1544503727, "time_total_s": 1757.245896100998, "done": false, "info": {"grad_time_ms": 8750.547, "load_time_ms": 17.453, "num_steps_trained": 1660000, "adversary": {"vf_explained_var": 0.13750167191028595, "kl": 0.03693927079439163, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1518.48291015625, "total_loss": 1518.4093017578125, "entropy": 134.17971801757812, "policy_loss": -0.08447878062725067}, "num_steps_sampled": 1660000, "av": {"vf_explained_var": 0.14049437642097473, "kl": 0.02929203398525715, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1508.0013427734375, "total_loss": 1507.9931640625, "entropy": 2.8841917514801025, "policy_loss": -0.009753525257110596}, "update_time_ms": 10.552, "sample_time_ms": 12128.058}, "timesteps_total": 1660000, "date": "2018-12-11_04-48-47", "training_iteration": 83, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.97219705581665, "num_metric_batches_dropped": 0, "iterations_since_restore": 83, "timesteps_since_restore": 1660000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f45b8d0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 3876}
{"policy_reward_mean": {"adversary": -368.6847443149834, "av": 368.6847443149834}, "time_since_restore": 1778.2419731616974, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 486.64, "timestamp": 1544503748, "time_total_s": 1778.2419731616974, "done": false, "info": {"grad_time_ms": 8733.12, "load_time_ms": 17.313, "num_steps_trained": 1680000, "adversary": {"vf_explained_var": 0.14980663359165192, "kl": 0.035670746117830276, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1440.986572265625, "total_loss": 1440.9154052734375, "entropy": 134.34776306152344, "policy_loss": -0.08188821375370026}, "num_steps_sampled": 1680000, "av": {"vf_explained_var": 0.14937880635261536, "kl": 0.02810956910252571, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1429.5599365234375, "total_loss": 1429.5538330078125, "entropy": 2.879427671432495, "policy_loss": -0.0074207535944879055}, "update_time_ms": 10.665, "sample_time_ms": 12080.9}, "timesteps_total": 1680000, "date": "2018-12-11_04-49-08", "training_iteration": 84, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.996077060699463, "num_metric_batches_dropped": 0, "iterations_since_restore": 84, "timesteps_since_restore": 1680000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f3239488080>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 3921}
{"policy_reward_mean": {"adversary": -360.06106508370397, "av": 360.06106508370397}, "time_since_restore": 1799.6987364292145, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 486.45, "timestamp": 1544503769, "time_total_s": 1799.6987364292145, "done": false, "info": {"grad_time_ms": 8778.713, "load_time_ms": 17.682, "num_steps_trained": 1700000, "adversary": {"vf_explained_var": 0.1394643634557724, "kl": 0.03544938191771507, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1433.7593994140625, "total_loss": 1433.6905517578125, "entropy": 134.16143798828125, "policy_loss": -0.07955115288496017}, "num_steps_sampled": 1700000, "av": {"vf_explained_var": 0.14114734530448914, "kl": 0.02613264136016369, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1431.30615234375, "total_loss": 1431.2982177734375, "entropy": 2.8986988067626953, "policy_loss": -0.009220030158758163}, "update_time_ms": 10.55, "sample_time_ms": 12126.81}, "timesteps_total": 1700000, "date": "2018-12-11_04-49-29", "training_iteration": 85, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.45676326751709, "num_metric_batches_dropped": 0, "iterations_since_restore": 85, "timesteps_since_restore": 1700000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f32393a6b70>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 3966}
{"policy_reward_mean": {"adversary": -337.8060982075013, "av": 337.8060982075013}, "time_since_restore": 1820.6751594543457, "episodes_this_iter": 50, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 466.92, "timestamp": 1544503790, "time_total_s": 1820.6751594543457, "done": false, "info": {"grad_time_ms": 8771.894, "load_time_ms": 17.852, "num_steps_trained": 1720000, "adversary": {"vf_explained_var": 0.14464952051639557, "kl": 0.03675041347742081, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1552.4677734375, "total_loss": 1552.3958740234375, "entropy": 134.1730194091797, "policy_loss": -0.08280157297849655}, "num_steps_sampled": 1720000, "av": {"vf_explained_var": 0.14802831411361694, "kl": 0.027516933158040047, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1550.976806640625, "total_loss": 1550.9676513671875, "entropy": 2.9130892753601074, "policy_loss": -0.010595366358757019}, "update_time_ms": 10.01, "sample_time_ms": 12168.738}, "timesteps_total": 1720000, "date": "2018-12-11_04-49-50", "training_iteration": 86, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.976423025131226, "num_metric_batches_dropped": 0, "iterations_since_restore": 86, "timesteps_since_restore": 1720000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f42c400>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 4016}
{"policy_reward_mean": {"adversary": -357.7664360674104, "av": 357.7664360674104}, "time_since_restore": 1841.2432384490967, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 477.16, "timestamp": 1544503811, "time_total_s": 1841.2432384490967, "done": false, "info": {"grad_time_ms": 8733.486, "load_time_ms": 18.072, "num_steps_trained": 1740000, "adversary": {"vf_explained_var": 0.1399948000907898, "kl": 0.0366080179810524, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1515.5340576171875, "total_loss": 1515.463134765625, "entropy": 134.31292724609375, "policy_loss": -0.08184026181697845}, "num_steps_sampled": 1740000, "av": {"vf_explained_var": 0.1415107250213623, "kl": 0.030416907742619514, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1516.0989990234375, "total_loss": 1516.090087890625, "entropy": 2.808417797088623, "policy_loss": -0.0104822451248765}, "update_time_ms": 9.84, "sample_time_ms": 12142.288}, "timesteps_total": 1740000, "date": "2018-12-11_04-50-11", "training_iteration": 87, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.568078994750977, "num_metric_batches_dropped": 0, "iterations_since_restore": 87, "timesteps_since_restore": 1740000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f464e80>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 4060}
{"policy_reward_mean": {"adversary": -375.8308580257745, "av": 375.8308580257745}, "time_since_restore": 1862.4102983474731, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 483.77, "timestamp": 1544503832, "time_total_s": 1862.4102983474731, "done": false, "info": {"grad_time_ms": 8741.557, "load_time_ms": 18.208, "num_steps_trained": 1760000, "adversary": {"vf_explained_var": 0.13840913772583008, "kl": 0.03572068363428116, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1533.2337646484375, "total_loss": 1533.1627197265625, "entropy": 134.3072052001953, "policy_loss": -0.08171301335096359}, "num_steps_sampled": 1760000, "av": {"vf_explained_var": 0.13778512179851532, "kl": 0.02857164293527603, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1535.68505859375, "total_loss": 1535.678466796875, "entropy": 2.7618582248687744, "policy_loss": -0.008180015720427036}, "update_time_ms": 9.747, "sample_time_ms": 12144.527}, "timesteps_total": 1760000, "date": "2018-12-11_04-50-32", "training_iteration": 88, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.167059898376465, "num_metric_batches_dropped": 0, "iterations_since_restore": 88, "timesteps_since_restore": 1760000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f446400>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 4105}
{"policy_reward_mean": {"adversary": -374.68284569457194, "av": 374.68284569457194}, "time_since_restore": 1883.2084379196167, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 485.84, "timestamp": 1544503853, "time_total_s": 1883.2084379196167, "done": false, "info": {"grad_time_ms": 8707.853, "load_time_ms": 18.367, "num_steps_trained": 1780000, "adversary": {"vf_explained_var": 0.15200664103031158, "kl": 0.036527931690216064, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1519.505126953125, "total_loss": 1519.43505859375, "entropy": 134.1865234375, "policy_loss": -0.08099715411663055}, "num_steps_sampled": 1780000, "av": {"vf_explained_var": 0.15270230174064636, "kl": 0.030508071184158325, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1530.6834716796875, "total_loss": 1530.6746826171875, "entropy": 2.80222225189209, "policy_loss": -0.010373661294579506}, "update_time_ms": 9.575, "sample_time_ms": 12154.649}, "timesteps_total": 1780000, "date": "2018-12-11_04-50-53", "training_iteration": 89, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.798139572143555, "num_metric_batches_dropped": 0, "iterations_since_restore": 89, "timesteps_since_restore": 1780000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f464390>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 4150}
{"policy_reward_mean": {"adversary": -371.3945601593735, "av": 371.3945601593735}, "time_since_restore": 1903.8934481143951, "episodes_this_iter": 43, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 482.41, "timestamp": 1544503874, "time_total_s": 1903.8934481143951, "done": false, "info": {"grad_time_ms": 8683.405, "load_time_ms": 18.629, "num_steps_trained": 1800000, "adversary": {"vf_explained_var": 0.1512245535850525, "kl": 0.036277346312999725, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1578.156982421875, "total_loss": 1578.0858154296875, "entropy": 134.20703125, "policy_loss": -0.08208806812763214}, "num_steps_sampled": 1800000, "av": {"vf_explained_var": 0.14710770547389984, "kl": 0.02827458269894123, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1584.187255859375, "total_loss": 1584.179443359375, "entropy": 2.8097102642059326, "policy_loss": -0.00929226167500019}, "update_time_ms": 9.425, "sample_time_ms": 12153.6}, "timesteps_total": 1800000, "date": "2018-12-11_04-51-14", "training_iteration": 90, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.685010194778442, "num_metric_batches_dropped": 0, "iterations_since_restore": 90, "timesteps_since_restore": 1800000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f447550>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 4193}
{"policy_reward_mean": {"adversary": -366.3456181280906, "av": 366.3456181280906}, "time_since_restore": 1925.1512122154236, "episodes_this_iter": 47, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 485.96, "timestamp": 1544503895, "time_total_s": 1925.1512122154236, "done": false, "info": {"grad_time_ms": 8671.37, "load_time_ms": 18.573, "num_steps_trained": 1820000, "adversary": {"vf_explained_var": 0.1574976146221161, "kl": 0.03779159486293793, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1679.0885009765625, "total_loss": 1679.0162353515625, "entropy": 134.0380859375, "policy_loss": -0.08343949913978577}, "num_steps_sampled": 1820000, "av": {"vf_explained_var": 0.15675079822540283, "kl": 0.0259025227278471, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1676.0653076171875, "total_loss": 1676.0572509765625, "entropy": 2.8202052116394043, "policy_loss": -0.009537230245769024}, "update_time_ms": 9.144, "sample_time_ms": 12209.547}, "timesteps_total": 1820000, "date": "2018-12-11_04-51-35", "training_iteration": 91, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.257764101028442, "num_metric_batches_dropped": 0, "iterations_since_restore": 91, "timesteps_since_restore": 1820000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f4640f0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 4240}
{"policy_reward_mean": {"adversary": -364.34920915895736, "av": 364.34920915895736}, "time_since_restore": 1945.8061990737915, "episodes_this_iter": 48, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 481.83, "timestamp": 1544503916, "time_total_s": 1945.8061990737915, "done": false, "info": {"grad_time_ms": 8622.141, "load_time_ms": 18.397, "num_steps_trained": 1840000, "adversary": {"vf_explained_var": 0.1486048847436905, "kl": 0.03687399998307228, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1625.724609375, "total_loss": 1625.6524658203125, "entropy": 134.1348876953125, "policy_loss": -0.08303922414779663}, "num_steps_sampled": 1840000, "av": {"vf_explained_var": 0.1488550901412964, "kl": 0.027992907911539078, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1621.396484375, "total_loss": 1621.38818359375, "entropy": 2.721278190612793, "policy_loss": -0.00973212905228138}, "update_time_ms": 8.686, "sample_time_ms": 12240.906}, "timesteps_total": 1840000, "date": "2018-12-11_04-51-56", "training_iteration": 92, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.65498685836792, "num_metric_batches_dropped": 0, "iterations_since_restore": 92, "timesteps_since_restore": 1840000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f450940>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 4288}
{"policy_reward_mean": {"adversary": -370.80241822062106, "av": 370.80241822062106}, "time_since_restore": 1966.4113669395447, "episodes_this_iter": 42, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 485.75, "timestamp": 1544503936, "time_total_s": 1966.4113669395447, "done": false, "info": {"grad_time_ms": 8598.219, "load_time_ms": 18.366, "num_steps_trained": 1860000, "adversary": {"vf_explained_var": 0.13724064826965332, "kl": 0.037370793521404266, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1630.5401611328125, "total_loss": 1630.46875, "entropy": 133.99472045898438, "policy_loss": -0.08272447437047958}, "num_steps_sampled": 1860000, "av": {"vf_explained_var": 0.13265572488307953, "kl": 0.027419256046414375, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1621.828125, "total_loss": 1621.8209228515625, "entropy": 2.798815965652466, "policy_loss": -0.008747806772589684}, "update_time_ms": 8.274, "sample_time_ms": 12228.906}, "timesteps_total": 1860000, "date": "2018-12-11_04-52-16", "training_iteration": 93, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.605167865753174, "num_metric_batches_dropped": 0, "iterations_since_restore": 93, "timesteps_since_restore": 1860000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f467518>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 4330}
{"policy_reward_mean": {"adversary": -369.16521332684505, "av": 369.16521332684505}, "time_since_restore": 1986.8813605308533, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 488.31, "timestamp": 1544503957, "time_total_s": 1986.8813605308533, "done": false, "info": {"grad_time_ms": 8527.85, "load_time_ms": 18.554, "num_steps_trained": 1880000, "adversary": {"vf_explained_var": 0.1580115556716919, "kl": 0.03804965689778328, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1633.1937255859375, "total_loss": 1633.1204833984375, "entropy": 133.955810546875, "policy_loss": -0.08456595987081528}, "num_steps_sampled": 1880000, "av": {"vf_explained_var": 0.158124640583992, "kl": 0.026949172839522362, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1614.497802734375, "total_loss": 1614.4918212890625, "entropy": 2.776986837387085, "policy_loss": -0.007290147244930267}, "update_time_ms": 8.118, "sample_time_ms": 12247.052}, "timesteps_total": 1880000, "date": "2018-12-11_04-52-37", "training_iteration": 94, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.469993591308594, "num_metric_batches_dropped": 0, "iterations_since_restore": 94, "timesteps_since_restore": 1880000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f323948f978>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 4375}
{"policy_reward_mean": {"adversary": -379.4092352521148, "av": 379.4092352521148}, "time_since_restore": 2007.2810328006744, "episodes_this_iter": 47, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 491.15, "timestamp": 1544503977, "time_total_s": 2007.2810328006744, "done": false, "info": {"grad_time_ms": 8464.091, "load_time_ms": 18.266, "num_steps_trained": 1900000, "adversary": {"vf_explained_var": 0.14946730434894562, "kl": 0.03685816377401352, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1601.8837890625, "total_loss": 1601.812255859375, "entropy": 133.98995971679688, "policy_loss": -0.08251933753490448}, "num_steps_sampled": 1900000, "av": {"vf_explained_var": 0.15172380208969116, "kl": 0.031018385663628578, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1580.277099609375, "total_loss": 1580.2686767578125, "entropy": 2.791057825088501, "policy_loss": -0.010003521107137203}, "update_time_ms": 8.135, "sample_time_ms": 12205.089}, "timesteps_total": 1900000, "date": "2018-12-11_04-52-57", "training_iteration": 95, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.399672269821167, "num_metric_batches_dropped": 0, "iterations_since_restore": 95, "timesteps_since_restore": 1900000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f32394a6278>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 4422}
{"policy_reward_mean": {"adversary": -386.8059972228209, "av": 386.8059972228209}, "time_since_restore": 2027.7829234600067, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 496.15, "timestamp": 1544503998, "time_total_s": 2027.7829234600067, "done": false, "info": {"grad_time_ms": 8478.499, "load_time_ms": 18.117, "num_steps_trained": 1920000, "adversary": {"vf_explained_var": 0.14544548094272614, "kl": 0.037216126918792725, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1509.1820068359375, "total_loss": 1509.1121826171875, "entropy": 133.920166015625, "policy_loss": -0.08096225559711456}, "num_steps_sampled": 1920000, "av": {"vf_explained_var": 0.14619337022304535, "kl": 0.02637660503387451, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1495.1468505859375, "total_loss": 1495.138671875, "entropy": 2.8143582344055176, "policy_loss": -0.009493725374341011}, "update_time_ms": 8.112, "sample_time_ms": 12144.511}, "timesteps_total": 1920000, "date": "2018-12-11_04-53-18", "training_iteration": 96, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.501890659332275, "num_metric_batches_dropped": 0, "iterations_since_restore": 96, "timesteps_since_restore": 1920000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f467b00>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 4466}
{"policy_reward_mean": {"adversary": -389.9913304110791, "av": 389.9913304110791}, "time_since_restore": 2048.341673374176, "episodes_this_iter": 41, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 498.44, "timestamp": 1544504018, "time_total_s": 2048.341673374176, "done": false, "info": {"grad_time_ms": 8455.784, "load_time_ms": 17.841, "num_steps_trained": 1940000, "adversary": {"vf_explained_var": 0.16212894022464752, "kl": 0.03732789307832718, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1556.3538818359375, "total_loss": 1556.283203125, "entropy": 133.90777587890625, "policy_loss": -0.0817301943898201}, "num_steps_sampled": 1940000, "av": {"vf_explained_var": 0.17029091715812683, "kl": 0.028913868591189384, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1540.1905517578125, "total_loss": 1540.18212890625, "entropy": 2.7977771759033203, "policy_loss": -0.009818373247981071}, "update_time_ms": 8.195, "sample_time_ms": 12167.859}, "timesteps_total": 1940000, "date": "2018-12-11_04-53-38", "training_iteration": 97, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.55874991416931, "num_metric_batches_dropped": 0, "iterations_since_restore": 97, "timesteps_since_restore": 1940000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f4677b8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 4507}
{"policy_reward_mean": {"adversary": -381.4189176224068, "av": 381.4189176224068}, "time_since_restore": 2069.5003910064697, "episodes_this_iter": 47, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 496.22, "timestamp": 1544504039, "time_total_s": 2069.5003910064697, "done": false, "info": {"grad_time_ms": 8440.914, "load_time_ms": 18.016, "num_steps_trained": 1960000, "adversary": {"vf_explained_var": 0.1501975953578949, "kl": 0.03763634338974953, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1566.201904296875, "total_loss": 1566.1314697265625, "entropy": 133.53793334960938, "policy_loss": -0.08175153285264969}, "num_steps_sampled": 1960000, "av": {"vf_explained_var": 0.15245802700519562, "kl": 0.027102509513497353, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1550.322509765625, "total_loss": 1550.3135986328125, "entropy": 2.8969197273254395, "policy_loss": -0.010285195894539356}, "update_time_ms": 8.106, "sample_time_ms": 12179.436}, "timesteps_total": 1960000, "date": "2018-12-11_04-53-59", "training_iteration": 98, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.1587176322937, "num_metric_batches_dropped": 0, "iterations_since_restore": 98, "timesteps_since_restore": 1960000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f467c18>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 4554}
{"policy_reward_mean": {"adversary": -373.3179329826757, "av": 373.3179329826757}, "time_since_restore": 2089.8655512332916, "episodes_this_iter": 43, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 492.83, "timestamp": 1544504060, "time_total_s": 2089.8655512332916, "done": false, "info": {"grad_time_ms": 8436.457, "load_time_ms": 18.058, "num_steps_trained": 1980000, "adversary": {"vf_explained_var": 0.14298008382320404, "kl": 0.0367136113345623, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1669.5179443359375, "total_loss": 1669.447021484375, "entropy": 133.91465759277344, "policy_loss": -0.08185505121946335}, "num_steps_sampled": 1980000, "av": {"vf_explained_var": 0.14733518660068512, "kl": 0.029957061633467674, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1650.619873046875, "total_loss": 1650.6114501953125, "entropy": 2.7467572689056396, "policy_loss": -0.010028408840298653}, "update_time_ms": 8.033, "sample_time_ms": 12142.187}, "timesteps_total": 1980000, "date": "2018-12-11_04-54-20", "training_iteration": 99, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.3651602268219, "num_metric_batches_dropped": 0, "iterations_since_restore": 99, "timesteps_since_restore": 1980000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f42f7f0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 4597}
{"policy_reward_mean": {"adversary": -376.9827211621515, "av": 376.9827211621515}, "time_since_restore": 2110.284998655319, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 495.57, "timestamp": 1544504080, "time_total_s": 2110.284998655319, "done": false, "info": {"grad_time_ms": 8413.256, "load_time_ms": 18.337, "num_steps_trained": 2000000, "adversary": {"vf_explained_var": 0.14006857573986053, "kl": 0.03717776760458946, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1652.914306640625, "total_loss": 1652.842529296875, "entropy": 133.72276306152344, "policy_loss": -0.08282540738582611}, "num_steps_sampled": 2000000, "av": {"vf_explained_var": 0.14500246942043304, "kl": 0.02731904573738575, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1637.059326171875, "total_loss": 1637.051513671875, "entropy": 2.906446695327759, "policy_loss": -0.008945667184889317}, "update_time_ms": 8.414, "sample_time_ms": 12138.952}, "timesteps_total": 2000000, "date": "2018-12-11_04-54-40", "training_iteration": 100, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.419447422027588, "num_metric_batches_dropped": 0, "iterations_since_restore": 100, "timesteps_since_restore": 2000000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f45bb70>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 4642}
{"policy_reward_mean": {"adversary": -370.4534679193055, "av": 370.4534679193055}, "time_since_restore": 2131.1579852104187, "episodes_this_iter": 48, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 487.57, "timestamp": 1544504101, "time_total_s": 2131.1579852104187, "done": false, "info": {"grad_time_ms": 8409.997, "load_time_ms": 18.568, "num_steps_trained": 2020000, "adversary": {"vf_explained_var": 0.13584820926189423, "kl": 0.037893254309892654, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1717.41943359375, "total_loss": 1717.34716796875, "entropy": 133.89073181152344, "policy_loss": -0.08353330194950104}, "num_steps_sampled": 2020000, "av": {"vf_explained_var": 0.13396313786506653, "kl": 0.031152890995144844, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1709.2335205078125, "total_loss": 1709.226806640625, "entropy": 2.7789158821105957, "policy_loss": -0.008274190127849579}, "update_time_ms": 8.364, "sample_time_ms": 12102.645}, "timesteps_total": 2020000, "date": "2018-12-11_04-55-01", "training_iteration": 101, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.872986555099487, "num_metric_batches_dropped": 0, "iterations_since_restore": 101, "timesteps_since_restore": 2020000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f42f7f0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 4690}
{"policy_reward_mean": {"adversary": -368.8361983998838, "av": 368.8361983998838}, "time_since_restore": 2151.298453092575, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 477.29, "timestamp": 1544504121, "time_total_s": 2151.298453092575, "done": false, "info": {"grad_time_ms": 8403.794, "load_time_ms": 18.635, "num_steps_trained": 2040000, "adversary": {"vf_explained_var": 0.161007359623909, "kl": 0.03718497231602669, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1748.228759765625, "total_loss": 1748.1566162109375, "entropy": 133.75401306152344, "policy_loss": -0.08308452367782593}, "num_steps_sampled": 2040000, "av": {"vf_explained_var": 0.15500132739543915, "kl": 0.023793620988726616, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1747.9493408203125, "total_loss": 1747.940673828125, "entropy": 2.8481085300445557, "policy_loss": -0.009886885061860085}, "update_time_ms": 8.459, "sample_time_ms": 12056.597}, "timesteps_total": 2040000, "date": "2018-12-11_04-55-21", "training_iteration": 102, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.140467882156372, "num_metric_batches_dropped": 0, "iterations_since_restore": 102, "timesteps_since_restore": 2040000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f464438>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 4735}
{"policy_reward_mean": {"adversary": -367.79544744868895, "av": 367.79544744868895}, "time_since_restore": 2171.749280691147, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 474.72, "timestamp": 1544504142, "time_total_s": 2171.749280691147, "done": false, "info": {"grad_time_ms": 8387.269, "load_time_ms": 19.031, "num_steps_trained": 2060000, "adversary": {"vf_explained_var": 0.15520283579826355, "kl": 0.03924208879470825, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1786.3433837890625, "total_loss": 1786.2703857421875, "entropy": 133.60824584960938, "policy_loss": -0.08438297361135483}, "num_steps_sampled": 2060000, "av": {"vf_explained_var": 0.157394140958786, "kl": 0.04765176773071289, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 1787.448974609375, "total_loss": 1787.445556640625, "entropy": 2.8893051147460938, "policy_loss": -0.005692416336387396}, "update_time_ms": 8.482, "sample_time_ms": 12056.306}, "timesteps_total": 2060000, "date": "2018-12-11_04-55-42", "training_iteration": 103, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.450827598571777, "num_metric_batches_dropped": 0, "iterations_since_restore": 103, "timesteps_since_restore": 2060000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f446be0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 4780}
{"policy_reward_mean": {"adversary": -370.2528045147537, "av": 370.2528045147537}, "time_since_restore": 2192.7692880630493, "episodes_this_iter": 47, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 481.3, "timestamp": 1544504163, "time_total_s": 2192.7692880630493, "done": false, "info": {"grad_time_ms": 8409.696, "load_time_ms": 18.806, "num_steps_trained": 2080000, "adversary": {"vf_explained_var": 0.13204292953014374, "kl": 0.03706284612417221, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1764.6700439453125, "total_loss": 1764.5985107421875, "entropy": 133.752685546875, "policy_loss": -0.08246032893657684}, "num_steps_sampled": 2080000, "av": {"vf_explained_var": 0.13300453126430511, "kl": 0.023256253451108932, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1766.691162109375, "total_loss": 1766.6824951171875, "entropy": 2.7693705558776855, "policy_loss": -0.010297762230038643}, "update_time_ms": 8.405, "sample_time_ms": 12090.136}, "timesteps_total": 2080000, "date": "2018-12-11_04-56-03", "training_iteration": 104, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.020007371902466, "num_metric_batches_dropped": 0, "iterations_since_restore": 104, "timesteps_since_restore": 2080000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f45bb00>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 4827}
{"policy_reward_mean": {"adversary": -369.4507398488182, "av": 369.4507398488182}, "time_since_restore": 2213.3069899082184, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 483.73, "timestamp": 1544504183, "time_total_s": 2213.3069899082184, "done": false, "info": {"grad_time_ms": 8399.554, "load_time_ms": 18.739, "num_steps_trained": 2100000, "adversary": {"vf_explained_var": 0.14130862057209015, "kl": 0.03815547004342079, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1708.314697265625, "total_loss": 1708.2425537109375, "entropy": 133.49293518066406, "policy_loss": -0.08348321914672852}, "num_steps_sampled": 2100000, "av": {"vf_explained_var": 0.14246657490730286, "kl": 0.021788248792290688, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1705.01123046875, "total_loss": 1705.0030517578125, "entropy": 2.8782572746276855, "policy_loss": -0.00989865604788065}, "update_time_ms": 8.305, "sample_time_ms": 12115.737}, "timesteps_total": 2100000, "date": "2018-12-11_04-56-23", "training_iteration": 105, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.537701845169067, "num_metric_batches_dropped": 0, "iterations_since_restore": 105, "timesteps_since_restore": 2100000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f446518>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 4872}
{"policy_reward_mean": {"adversary": -365.25845882533105, "av": 365.25845882533105}, "time_since_restore": 2234.274709224701, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 484.58, "timestamp": 1544504204, "time_total_s": 2234.274709224701, "done": false, "info": {"grad_time_ms": 8406.658, "load_time_ms": 18.773, "num_steps_trained": 2120000, "adversary": {"vf_explained_var": 0.14426574110984802, "kl": 0.03844025358557701, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1734.1959228515625, "total_loss": 1734.122802734375, "entropy": 133.46600341796875, "policy_loss": -0.08472251147031784}, "num_steps_sampled": 2120000, "av": {"vf_explained_var": 0.14431089162826538, "kl": 0.022791165858507156, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1729.687255859375, "total_loss": 1729.679931640625, "entropy": 2.8198766708374023, "policy_loss": -0.009023959748446941}, "update_time_ms": 8.259, "sample_time_ms": 12155.204}, "timesteps_total": 2120000, "date": "2018-12-11_04-56-44", "training_iteration": 106, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.967719316482544, "num_metric_batches_dropped": 0, "iterations_since_restore": 106, "timesteps_since_restore": 2120000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f464470>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 4917}
{"policy_reward_mean": {"adversary": -365.0826615925191, "av": 365.0826615925191}, "time_since_restore": 2254.8033590316772, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 483.5, "timestamp": 1544504225, "time_total_s": 2254.8033590316772, "done": false, "info": {"grad_time_ms": 8378.274, "load_time_ms": 18.535, "num_steps_trained": 2140000, "adversary": {"vf_explained_var": 0.14588972926139832, "kl": 0.03836904466152191, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1718.5125732421875, "total_loss": 1718.4384765625, "entropy": 133.55734252929688, "policy_loss": -0.08570988476276398}, "num_steps_sampled": 2140000, "av": {"vf_explained_var": 0.14927971363067627, "kl": 0.02478177845478058, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1710.4306640625, "total_loss": 1710.421630859375, "entropy": 2.864515542984009, "policy_loss": -0.01087673008441925}, "update_time_ms": 8.268, "sample_time_ms": 12179.379}, "timesteps_total": 2140000, "date": "2018-12-11_04-57-05", "training_iteration": 107, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.52864980697632, "num_metric_batches_dropped": 0, "iterations_since_restore": 107, "timesteps_since_restore": 2140000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f446f28>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 4962}
{"policy_reward_mean": {"adversary": -374.76891544782427, "av": 374.76891544782427}, "time_since_restore": 2275.6102867126465, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 486.55, "timestamp": 1544504246, "time_total_s": 2275.6102867126465, "done": false, "info": {"grad_time_ms": 8329.798, "load_time_ms": 18.398, "num_steps_trained": 2160000, "adversary": {"vf_explained_var": 0.1417878270149231, "kl": 0.03823598846793175, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1724.5465087890625, "total_loss": 1724.4718017578125, "entropy": 133.64422607421875, "policy_loss": -0.08618295192718506}, "num_steps_sampled": 2160000, "av": {"vf_explained_var": 0.1412310004234314, "kl": 0.02711675688624382, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1714.9222412109375, "total_loss": 1714.915283203125, "entropy": 2.771074056625366, "policy_loss": -0.009008200839161873}, "update_time_ms": 8.452, "sample_time_ms": 12191.076}, "timesteps_total": 2160000, "date": "2018-12-11_04-57-26", "training_iteration": 108, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.80692768096924, "num_metric_batches_dropped": 0, "iterations_since_restore": 108, "timesteps_since_restore": 2160000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f464b70>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 5008}
{"policy_reward_mean": {"adversary": -369.6165705373444, "av": 369.6165705373444}, "time_since_restore": 2296.377062559128, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 489.87, "timestamp": 1544504266, "time_total_s": 2296.377062559128, "done": false, "info": {"grad_time_ms": 8357.823, "load_time_ms": 18.079, "num_steps_trained": 2180000, "adversary": {"vf_explained_var": 0.1485079973936081, "kl": 0.038564860820770264, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1729.9571533203125, "total_loss": 1729.8846435546875, "entropy": 133.53207397460938, "policy_loss": -0.08411763608455658}, "num_steps_sampled": 2180000, "av": {"vf_explained_var": 0.15010906755924225, "kl": 0.023418422788381577, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1728.605224609375, "total_loss": 1728.597412109375, "entropy": 2.899958610534668, "policy_loss": -0.009703634306788445}, "update_time_ms": 8.436, "sample_time_ms": 12203.472}, "timesteps_total": 2180000, "date": "2018-12-11_04-57-46", "training_iteration": 109, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.766775846481323, "num_metric_batches_dropped": 0, "iterations_since_restore": 109, "timesteps_since_restore": 2180000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f32394a6550>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 5052}
{"policy_reward_mean": {"adversary": -366.97210077035254, "av": 366.97210077035254}, "time_since_restore": 2317.0024342536926, "episodes_this_iter": 43, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 492.72, "timestamp": 1544504287, "time_total_s": 2317.0024342536926, "done": false, "info": {"grad_time_ms": 8373.156, "load_time_ms": 17.577, "num_steps_trained": 2200000, "adversary": {"vf_explained_var": 0.15661564469337463, "kl": 0.03893723711371422, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1723.8377685546875, "total_loss": 1723.762451171875, "entropy": 133.4871368408203, "policy_loss": -0.08686066418886185}, "num_steps_sampled": 2200000, "av": {"vf_explained_var": 0.1562618911266327, "kl": 0.02722455933690071, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1733.760009765625, "total_loss": 1733.7513427734375, "entropy": 2.884552478790283, "policy_loss": -0.010729147121310234}, "update_time_ms": 8.205, "sample_time_ms": 12209.144}, "timesteps_total": 2200000, "date": "2018-12-11_04-58-07", "training_iteration": 110, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.62537169456482, "num_metric_batches_dropped": 0, "iterations_since_restore": 110, "timesteps_since_restore": 2200000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f446f28>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 5095}
{"policy_reward_mean": {"adversary": -370.8200834646295, "av": 370.8200834646295}, "time_since_restore": 2337.6089861392975, "episodes_this_iter": 47, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 487.98, "timestamp": 1544504308, "time_total_s": 2337.6089861392975, "done": false, "info": {"grad_time_ms": 8370.829, "load_time_ms": 17.666, "num_steps_trained": 2220000, "adversary": {"vf_explained_var": 0.13897477090358734, "kl": 0.039116986095905304, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1699.166259765625, "total_loss": 1699.09130859375, "entropy": 133.37254333496094, "policy_loss": -0.08631457388401031}, "num_steps_sampled": 2220000, "av": {"vf_explained_var": 0.13541488349437714, "kl": 0.025939632207155228, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1697.2340087890625, "total_loss": 1697.226806640625, "entropy": 2.9861958026885986, "policy_loss": -0.00917771551758051}, "update_time_ms": 8.248, "sample_time_ms": 12185.214}, "timesteps_total": 2220000, "date": "2018-12-11_04-58-28", "training_iteration": 111, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.60655188560486, "num_metric_batches_dropped": 0, "iterations_since_restore": 111, "timesteps_since_restore": 2220000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f4646a0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 5142}
{"policy_reward_mean": {"adversary": -380.75373965668206, "av": 380.75373965668206}, "time_since_restore": 2358.25505900383, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 494.93, "timestamp": 1544504328, "time_total_s": 2358.25505900383, "done": false, "info": {"grad_time_ms": 8404.285, "load_time_ms": 17.854, "num_steps_trained": 2240000, "adversary": {"vf_explained_var": 0.14575140178203583, "kl": 0.03922967240214348, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1667.4879150390625, "total_loss": 1667.4136962890625, "entropy": 133.3116912841797, "policy_loss": -0.08606728166341782}, "num_steps_sampled": 2240000, "av": {"vf_explained_var": 0.14079788327217102, "kl": 0.026636900380253792, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1659.6085205078125, "total_loss": 1659.60009765625, "entropy": 2.984691858291626, "policy_loss": -0.010400209575891495}, "update_time_ms": 8.223, "sample_time_ms": 12201.544}, "timesteps_total": 2240000, "date": "2018-12-11_04-58-48", "training_iteration": 112, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.64607286453247, "num_metric_batches_dropped": 0, "iterations_since_restore": 112, "timesteps_since_restore": 2240000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f467e80>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 5186}
{"policy_reward_mean": {"adversary": -361.69999277406464, "av": 361.69999277406464}, "time_since_restore": 2378.797919988632, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 487.49, "timestamp": 1544504349, "time_total_s": 2378.797919988632, "done": false, "info": {"grad_time_ms": 8396.142, "load_time_ms": 17.536, "num_steps_trained": 2260000, "adversary": {"vf_explained_var": 0.14048713445663452, "kl": 0.03936528041958809, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1745.927734375, "total_loss": 1745.853759765625, "entropy": 133.29531860351562, "policy_loss": -0.08580373227596283}, "num_steps_sampled": 2260000, "av": {"vf_explained_var": 0.1379673331975937, "kl": 0.02121591381728649, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1721.0340576171875, "total_loss": 1721.0264892578125, "entropy": 2.989962339401245, "policy_loss": -0.009419245645403862}, "update_time_ms": 8.204, "sample_time_ms": 12220.702}, "timesteps_total": 2260000, "date": "2018-12-11_04-59-09", "training_iteration": 113, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.542860984802246, "num_metric_batches_dropped": 0, "iterations_since_restore": 113, "timesteps_since_restore": 2260000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f42cf98>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 5231}
{"policy_reward_mean": {"adversary": -357.2073716858315, "av": 357.2073716858315}, "time_since_restore": 2399.7355260849, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 489.47, "timestamp": 1544504370, "time_total_s": 2399.7355260849, "done": false, "info": {"grad_time_ms": 8384.984, "load_time_ms": 17.829, "num_steps_trained": 2280000, "adversary": {"vf_explained_var": 0.1442713886499405, "kl": 0.03877054899930954, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1637.90087890625, "total_loss": 1637.8275146484375, "entropy": 133.18675231933594, "policy_loss": -0.08471836894750595}, "num_steps_sampled": 2280000, "av": {"vf_explained_var": 0.14168670773506165, "kl": 0.021714618429541588, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1607.187255859375, "total_loss": 1607.1788330078125, "entropy": 2.9418299198150635, "policy_loss": -0.010114803910255432}, "update_time_ms": 8.186, "sample_time_ms": 12222.1}, "timesteps_total": 2280000, "date": "2018-12-11_04-59-30", "training_iteration": 114, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.9376060962677, "num_metric_batches_dropped": 0, "iterations_since_restore": 114, "timesteps_since_restore": 2280000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f32394816a0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 5275}
{"policy_reward_mean": {"adversary": -367.57036044648004, "av": 367.57036044648004}, "time_since_restore": 2419.8567464351654, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 491.77, "timestamp": 1544504390, "time_total_s": 2419.8567464351654, "done": false, "info": {"grad_time_ms": 8371.129, "load_time_ms": 18.305, "num_steps_trained": 2300000, "adversary": {"vf_explained_var": 0.15396983921527863, "kl": 0.039263684302568436, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1659.4921875, "total_loss": 1659.4171142578125, "entropy": 133.12808227539062, "policy_loss": -0.08669384568929672}, "num_steps_sampled": 2300000, "av": {"vf_explained_var": 0.15409237146377563, "kl": 0.02254354953765869, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1633.034912109375, "total_loss": 1633.0263671875, "entropy": 3.018153429031372, "policy_loss": -0.01029206346720457}, "update_time_ms": 8.123, "sample_time_ms": 12193.315}, "timesteps_total": 2300000, "date": "2018-12-11_04-59-50", "training_iteration": 115, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.121220350265503, "num_metric_batches_dropped": 0, "iterations_since_restore": 115, "timesteps_since_restore": 2300000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f4641d0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 5321}
{"policy_reward_mean": {"adversary": -359.35938630059326, "av": 359.35938630059326}, "time_since_restore": 2440.527806043625, "episodes_this_iter": 47, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 485.02, "timestamp": 1544504411, "time_total_s": 2440.527806043625, "done": false, "info": {"grad_time_ms": 8335.728, "load_time_ms": 18.392, "num_steps_trained": 2320000, "adversary": {"vf_explained_var": 0.14610256254673004, "kl": 0.03829551488161087, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1611.0380859375, "total_loss": 1610.9661865234375, "entropy": 133.1788787841797, "policy_loss": -0.08332022279500961}, "num_steps_sampled": 2320000, "av": {"vf_explained_var": 0.14373399317264557, "kl": 0.02442750707268715, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1595.155517578125, "total_loss": 1595.147216796875, "entropy": 2.9838130474090576, "policy_loss": -0.010064428672194481}, "update_time_ms": 8.16, "sample_time_ms": 12199.171}, "timesteps_total": 2320000, "date": "2018-12-11_05-00-11", "training_iteration": 116, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.671059608459473, "num_metric_batches_dropped": 0, "iterations_since_restore": 116, "timesteps_since_restore": 2320000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f443b70>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 5368}
{"policy_reward_mean": {"adversary": -356.08748471480305, "av": 356.08748471480305}, "time_since_restore": 2461.3821864128113, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 484.65, "timestamp": 1544504432, "time_total_s": 2461.3821864128113, "done": false, "info": {"grad_time_ms": 8396.9, "load_time_ms": 18.368, "num_steps_trained": 2340000, "adversary": {"vf_explained_var": 0.15752741694450378, "kl": 0.03792457655072212, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1580.72412109375, "total_loss": 1580.6502685546875, "entropy": 133.09475708007812, "policy_loss": -0.08530843257904053}, "num_steps_sampled": 2340000, "av": {"vf_explained_var": 0.15604683756828308, "kl": 0.022500336170196533, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1565.87548828125, "total_loss": 1565.86669921875, "entropy": 3.030028820037842, "policy_loss": -0.010610079392790794}, "update_time_ms": 8.01, "sample_time_ms": 12172.477}, "timesteps_total": 2340000, "date": "2018-12-11_05-00-32", "training_iteration": 117, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.8543803691864, "num_metric_batches_dropped": 0, "iterations_since_restore": 117, "timesteps_since_restore": 2340000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f446908>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 5414}
{"policy_reward_mean": {"adversary": -339.3484889263734, "av": 339.3484889263734}, "time_since_restore": 2482.3662614822388, "episodes_this_iter": 47, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 473.09, "timestamp": 1544504453, "time_total_s": 2482.3662614822388, "done": false, "info": {"grad_time_ms": 8390.857, "load_time_ms": 18.107, "num_steps_trained": 2360000, "adversary": {"vf_explained_var": 0.12709416449069977, "kl": 0.038976456969976425, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1704.0762939453125, "total_loss": 1704.001220703125, "entropy": 133.22015380859375, "policy_loss": -0.08674752712249756}, "num_steps_sampled": 2360000, "av": {"vf_explained_var": 0.12741251289844513, "kl": 0.022335529327392578, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1703.3680419921875, "total_loss": 1703.3585205078125, "entropy": 2.948225259780884, "policy_loss": -0.01101888157427311}, "update_time_ms": 7.835, "sample_time_ms": 12200.693}, "timesteps_total": 2360000, "date": "2018-12-11_05-00-53", "training_iteration": 118, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.98407506942749, "num_metric_batches_dropped": 0, "iterations_since_restore": 118, "timesteps_since_restore": 2360000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f4437f0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 5461}
{"policy_reward_mean": {"adversary": -358.4444363007398, "av": 358.4444363007398}, "time_since_restore": 2502.872210264206, "episodes_this_iter": 43, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 481.69, "timestamp": 1544504473, "time_total_s": 2502.872210264206, "done": false, "info": {"grad_time_ms": 8367.871, "load_time_ms": 18.375, "num_steps_trained": 2380000, "adversary": {"vf_explained_var": 0.13909359276294708, "kl": 0.0384274497628212, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1533.480712890625, "total_loss": 1533.4071044921875, "entropy": 133.25782775878906, "policy_loss": -0.08530328422784805}, "num_steps_sampled": 2380000, "av": {"vf_explained_var": 0.14069700241088867, "kl": 0.023185987025499344, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1540.3724365234375, "total_loss": 1540.363037109375, "entropy": 3.0202996730804443, "policy_loss": -0.011171042919158936}, "update_time_ms": 7.9, "sample_time_ms": 12196.361}, "timesteps_total": 2380000, "date": "2018-12-11_05-01-13", "training_iteration": 119, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.505948781967163, "num_metric_batches_dropped": 0, "iterations_since_restore": 119, "timesteps_since_restore": 2380000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f42ff98>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 5504}
{"policy_reward_mean": {"adversary": -365.23546656876783, "av": 365.23546656876783}, "time_since_restore": 2523.4478871822357, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 488.03, "timestamp": 1544504494, "time_total_s": 2523.4478871822357, "done": false, "info": {"grad_time_ms": 8343.439, "load_time_ms": 18.482, "num_steps_trained": 2400000, "adversary": {"vf_explained_var": 0.15424945950508118, "kl": 0.0387643501162529, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1562.6654052734375, "total_loss": 1562.592041015625, "entropy": 133.1682586669922, "policy_loss": -0.08498851209878922}, "num_steps_sampled": 2400000, "av": {"vf_explained_var": 0.15143969655036926, "kl": 0.024074899032711983, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1558.0303955078125, "total_loss": 1558.0220947265625, "entropy": 3.052582263946533, "policy_loss": -0.010002197697758675}, "update_time_ms": 7.852, "sample_time_ms": 12215.696}, "timesteps_total": 2400000, "date": "2018-12-11_05-01-34", "training_iteration": 120, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.575676918029785, "num_metric_batches_dropped": 0, "iterations_since_restore": 120, "timesteps_since_restore": 2400000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f443470>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 5549}
{"policy_reward_mean": {"adversary": -348.32536837044324, "av": 348.32536837044324}, "time_since_restore": 2543.8621878623962, "episodes_this_iter": 49, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 474.94, "timestamp": 1544504514, "time_total_s": 2543.8621878623962, "done": false, "info": {"grad_time_ms": 8345.391, "load_time_ms": 18.307, "num_steps_trained": 2420000, "adversary": {"vf_explained_var": 0.16188757121562958, "kl": 0.03822261095046997, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1581.3135986328125, "total_loss": 1581.2421875, "entropy": 133.0486297607422, "policy_loss": -0.08288181573152542}, "num_steps_sampled": 2420000, "av": {"vf_explained_var": 0.1665671169757843, "kl": 0.021681345999240875, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1567.5509033203125, "total_loss": 1567.5430908203125, "entropy": 3.1248011589050293, "policy_loss": -0.00929039902985096}, "update_time_ms": 8.208, "sample_time_ms": 12194.168}, "timesteps_total": 2420000, "date": "2018-12-11_05-01-54", "training_iteration": 121, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.414300680160522, "num_metric_batches_dropped": 0, "iterations_since_restore": 121, "timesteps_since_restore": 2420000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f443a58>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 5598}
{"policy_reward_mean": {"adversary": -338.15698188802133, "av": 338.15698188802133}, "time_since_restore": 2564.9413044452667, "episodes_this_iter": 49, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 457.68, "timestamp": 1544504535, "time_total_s": 2564.9413044452667, "done": false, "info": {"grad_time_ms": 8362.306, "load_time_ms": 18.335, "num_steps_trained": 2440000, "adversary": {"vf_explained_var": 0.14148885011672974, "kl": 0.038872141391038895, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1623.119140625, "total_loss": 1623.046630859375, "entropy": 133.1062774658203, "policy_loss": -0.08416301757097244}, "num_steps_sampled": 2440000, "av": {"vf_explained_var": 0.14425669610500336, "kl": 0.028646107763051987, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1622.2587890625, "total_loss": 1622.2491455078125, "entropy": 3.0783209800720215, "policy_loss": -0.011703521013259888}, "update_time_ms": 8.186, "sample_time_ms": 12220.992}, "timesteps_total": 2440000, "date": "2018-12-11_05-02-15", "training_iteration": 122, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.079116582870483, "num_metric_batches_dropped": 0, "iterations_since_restore": 122, "timesteps_since_restore": 2440000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f32394a6dd8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 5647}
{"policy_reward_mean": {"adversary": -363.9855315492896, "av": 363.9855315492896}, "time_since_restore": 2585.359841823578, "episodes_this_iter": 43, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 471.5, "timestamp": 1544504556, "time_total_s": 2585.359841823578, "done": false, "info": {"grad_time_ms": 8355.002, "load_time_ms": 18.218, "num_steps_trained": 2460000, "adversary": {"vf_explained_var": 0.1496160924434662, "kl": 0.03829962760210037, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1490.832275390625, "total_loss": 1490.7606201171875, "entropy": 133.30650329589844, "policy_loss": -0.08306979387998581}, "num_steps_sampled": 2460000, "av": {"vf_explained_var": 0.14970707893371582, "kl": 0.0248140599578619, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1486.988037109375, "total_loss": 1486.9805908203125, "entropy": 2.9764769077301025, "policy_loss": -0.0093763442710042}, "update_time_ms": 8.172, "sample_time_ms": 12215.218}, "timesteps_total": 2460000, "date": "2018-12-11_05-02-36", "training_iteration": 123, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.418537378311157, "num_metric_batches_dropped": 0, "iterations_since_restore": 123, "timesteps_since_restore": 2460000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f443128>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 5690}
{"policy_reward_mean": {"adversary": -369.82324360651285, "av": 369.82324360651285}, "time_since_restore": 2606.2814304828644, "episodes_this_iter": 49, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 483.49, "timestamp": 1544504577, "time_total_s": 2606.2814304828644, "done": false, "info": {"grad_time_ms": 8344.587, "load_time_ms": 17.861, "num_steps_trained": 2480000, "adversary": {"vf_explained_var": 0.15874244272708893, "kl": 0.03899921476840973, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1539.4869384765625, "total_loss": 1539.415283203125, "entropy": 133.1388397216797, "policy_loss": -0.08345001935958862}, "num_steps_sampled": 2480000, "av": {"vf_explained_var": 0.16167545318603516, "kl": 0.020618749782443047, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1535.794921875, "total_loss": 1535.7860107421875, "entropy": 3.0187127590179443, "policy_loss": -0.010251162573695183}, "update_time_ms": 8.106, "sample_time_ms": 12225.052}, "timesteps_total": 2480000, "date": "2018-12-11_05-02-57", "training_iteration": 124, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.9215886592865, "num_metric_batches_dropped": 0, "iterations_since_restore": 124, "timesteps_since_restore": 2480000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f4640b8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 5739}
{"policy_reward_mean": {"adversary": -363.4419872771112, "av": 363.4419872771112}, "time_since_restore": 2627.035568714142, "episodes_this_iter": 43, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 484.99, "timestamp": 1544504597, "time_total_s": 2627.035568714142, "done": false, "info": {"grad_time_ms": 8362.293, "load_time_ms": 17.231, "num_steps_trained": 2500000, "adversary": {"vf_explained_var": 0.15747594833374023, "kl": 0.038437433540821075, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1482.5889892578125, "total_loss": 1482.517822265625, "entropy": 132.93885803222656, "policy_loss": -0.08279838413000107}, "num_steps_sampled": 2500000, "av": {"vf_explained_var": 0.15709251165390015, "kl": 0.022773876786231995, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1477.0767822265625, "total_loss": 1477.0684814453125, "entropy": 3.0893917083740234, "policy_loss": -0.009935705922544003}, "update_time_ms": 8.317, "sample_time_ms": 12271.613}, "timesteps_total": 2500000, "date": "2018-12-11_05-03-17", "training_iteration": 125, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.754138231277466, "num_metric_batches_dropped": 0, "iterations_since_restore": 125, "timesteps_since_restore": 2500000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f464a90>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 5782}
{"policy_reward_mean": {"adversary": -357.39182220183386, "av": 357.39182220183386}, "time_since_restore": 2647.4813594818115, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 485.16, "timestamp": 1544504618, "time_total_s": 2647.4813594818115, "done": false, "info": {"grad_time_ms": 8365.87, "load_time_ms": 17.055, "num_steps_trained": 2520000, "adversary": {"vf_explained_var": 0.15032389760017395, "kl": 0.03885493054986, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1728.103515625, "total_loss": 1728.0302734375, "entropy": 132.71949768066406, "policy_loss": -0.08489133417606354}, "num_steps_sampled": 2520000, "av": {"vf_explained_var": 0.1478465348482132, "kl": 0.024617500603199005, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1720.1146240234375, "total_loss": 1720.1068115234375, "entropy": 3.128032922744751, "policy_loss": -0.009953034110367298}, "update_time_ms": 8.363, "sample_time_ms": 12245.698}, "timesteps_total": 2520000, "date": "2018-12-11_05-03-38", "training_iteration": 126, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.445790767669678, "num_metric_batches_dropped": 0, "iterations_since_restore": 126, "timesteps_since_restore": 2520000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f467780>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 5828}
{"policy_reward_mean": {"adversary": -347.413364331004, "av": 347.413364331004}, "time_since_restore": 2668.229231595993, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 484.76, "timestamp": 1544504639, "time_total_s": 2668.229231595993, "done": false, "info": {"grad_time_ms": 8342.75, "load_time_ms": 16.995, "num_steps_trained": 2540000, "adversary": {"vf_explained_var": 0.13574786484241486, "kl": 0.03923992067575455, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1640.5596923828125, "total_loss": 1640.48681640625, "entropy": 132.8642120361328, "policy_loss": -0.08472137898206711}, "num_steps_sampled": 2540000, "av": {"vf_explained_var": 0.13488930463790894, "kl": 0.024803515523672104, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1623.941650390625, "total_loss": 1623.934814453125, "entropy": 3.071854829788208, "policy_loss": -0.008804368786513805}, "update_time_ms": 8.551, "sample_time_ms": 12258.279}, "timesteps_total": 2540000, "date": "2018-12-11_05-03-59", "training_iteration": 127, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.74787211418152, "num_metric_batches_dropped": 0, "iterations_since_restore": 127, "timesteps_since_restore": 2540000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f450a58>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 5873}
{"policy_reward_mean": {"adversary": -361.8199274184213, "av": 361.8199274184213}, "time_since_restore": 2688.8074429035187, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 489.29, "timestamp": 1544504659, "time_total_s": 2688.8074429035187, "done": false, "info": {"grad_time_ms": 8363.241, "load_time_ms": 17.272, "num_steps_trained": 2560000, "adversary": {"vf_explained_var": 0.14502575993537903, "kl": 0.03962274268269539, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1719.2122802734375, "total_loss": 1719.1378173828125, "entropy": 132.85870361328125, "policy_loss": -0.08657066524028778}, "num_steps_sampled": 2560000, "av": {"vf_explained_var": 0.14879855513572693, "kl": 0.021250750869512558, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1706.851318359375, "total_loss": 1706.8427734375, "entropy": 3.1264848709106445, "policy_loss": -0.010091160424053669}, "update_time_ms": 8.554, "sample_time_ms": 12195.281}, "timesteps_total": 2560000, "date": "2018-12-11_05-04-19", "training_iteration": 128, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.578211307525635, "num_metric_batches_dropped": 0, "iterations_since_restore": 128, "timesteps_since_restore": 2560000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f464208>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 5918}
{"policy_reward_mean": {"adversary": -371.7372284135131, "av": 371.7372284135131}, "time_since_restore": 2709.453389644623, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 490.58, "timestamp": 1544504680, "time_total_s": 2709.453389644623, "done": false, "info": {"grad_time_ms": 8378.484, "load_time_ms": 17.444, "num_steps_trained": 2580000, "adversary": {"vf_explained_var": 0.15900497138500214, "kl": 0.03967861458659172, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1649.9432373046875, "total_loss": 1649.8687744140625, "entropy": 132.947998046875, "policy_loss": -0.0862300768494606}, "num_steps_sampled": 2580000, "av": {"vf_explained_var": 0.16288791596889496, "kl": 0.02283267118036747, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1637.5325927734375, "total_loss": 1637.524658203125, "entropy": 3.021660089492798, "policy_loss": -0.009601318277418613}, "update_time_ms": 8.525, "sample_time_ms": 12193.618}, "timesteps_total": 2580000, "date": "2018-12-11_05-04-40", "training_iteration": 129, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.645946741104126, "num_metric_batches_dropped": 0, "iterations_since_restore": 129, "timesteps_since_restore": 2580000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f467940>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 5963}
{"policy_reward_mean": {"adversary": -351.6505250903676, "av": 351.6505250903676}, "time_since_restore": 2730.639623403549, "episodes_this_iter": 47, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 486.17, "timestamp": 1544504701, "time_total_s": 2730.639623403549, "done": false, "info": {"grad_time_ms": 8413.711, "load_time_ms": 17.797, "num_steps_trained": 2600000, "adversary": {"vf_explained_var": 0.13476695120334625, "kl": 0.03964903578162193, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1681.267578125, "total_loss": 1681.1934814453125, "entropy": 132.70616149902344, "policy_loss": -0.08573407679796219}, "num_steps_sampled": 2600000, "av": {"vf_explained_var": 0.1378365308046341, "kl": 0.022053761407732964, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1673.14599609375, "total_loss": 1673.1375732421875, "entropy": 3.090604066848755, "policy_loss": -0.010188190266489983}, "update_time_ms": 8.552, "sample_time_ms": 12217.274}, "timesteps_total": 2600000, "date": "2018-12-11_05-05-01", "training_iteration": 130, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 21.18623375892639, "num_metric_batches_dropped": 0, "iterations_since_restore": 130, "timesteps_since_restore": 2600000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f4672b0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 6010}
{"policy_reward_mean": {"adversary": -337.18389265351544, "av": 337.18389265351544}, "time_since_restore": 2751.5130348205566, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 479.82, "timestamp": 1544504722, "time_total_s": 2751.5130348205566, "done": false, "info": {"grad_time_ms": 8395.375, "load_time_ms": 17.951, "num_steps_trained": 2620000, "adversary": {"vf_explained_var": 0.14048510789871216, "kl": 0.03886564448475838, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1612.2542724609375, "total_loss": 1612.181640625, "entropy": 132.7461395263672, "policy_loss": -0.08450543880462646}, "num_steps_sampled": 2620000, "av": {"vf_explained_var": 0.13962343335151672, "kl": 0.02445642091333866, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1611.0089111328125, "total_loss": 1610.999755859375, "entropy": 3.079289436340332, "policy_loss": -0.010993140749633312}, "update_time_ms": 8.191, "sample_time_ms": 12282.671}, "timesteps_total": 2620000, "date": "2018-12-11_05-05-22", "training_iteration": 131, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.873411417007446, "num_metric_batches_dropped": 0, "iterations_since_restore": 131, "timesteps_since_restore": 2620000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f443f28>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 6055}
{"policy_reward_mean": {"adversary": -348.80317427101994, "av": 348.80317427101994}, "time_since_restore": 2772.312695503235, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 478.51, "timestamp": 1544504743, "time_total_s": 2772.312695503235, "done": false, "info": {"grad_time_ms": 8368.821, "load_time_ms": 18.016, "num_steps_trained": 2640000, "adversary": {"vf_explained_var": 0.13190290331840515, "kl": 0.03958059474825859, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1688.720703125, "total_loss": 1688.64599609375, "entropy": 132.7390899658203, "policy_loss": -0.08646564930677414}, "num_steps_sampled": 2640000, "av": {"vf_explained_var": 0.13755369186401367, "kl": 0.02281211130321026, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1687.0921630859375, "total_loss": 1687.082275390625, "entropy": 3.0555810928344727, "policy_loss": -0.011619538068771362}, "update_time_ms": 8.298, "sample_time_ms": 12280.621}, "timesteps_total": 2640000, "date": "2018-12-11_05-05-43", "training_iteration": 132, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.799660682678223, "num_metric_batches_dropped": 0, "iterations_since_restore": 132, "timesteps_since_restore": 2640000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f323949d3c8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 6100}
{"policy_reward_mean": {"adversary": -345.91542522003016, "av": 345.91542522003016}, "time_since_restore": 2793.162166118622, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 483.29, "timestamp": 1544504764, "time_total_s": 2793.162166118622, "done": false, "info": {"grad_time_ms": 8385.548, "load_time_ms": 17.979, "num_steps_trained": 2660000, "adversary": {"vf_explained_var": 0.133529931306839, "kl": 0.04026329144835472, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.29999998211860657, "vf_loss": 1786.153076171875, "total_loss": 1786.0772705078125, "entropy": 132.600830078125, "policy_loss": -0.08812740445137024}, "num_steps_sampled": 2660000, "av": {"vf_explained_var": 0.13008823990821838, "kl": 0.023206818848848343, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1790.277587890625, "total_loss": 1790.2681884765625, "entropy": 3.045647621154785, "policy_loss": -0.011210573837161064}, "update_time_ms": 8.298, "sample_time_ms": 12307.521}, "timesteps_total": 2660000, "date": "2018-12-11_05-06-04", "training_iteration": 133, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.849470615386963, "num_metric_batches_dropped": 0, "iterations_since_restore": 133, "timesteps_since_restore": 2660000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f447b70>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 6145}
{"policy_reward_mean": {"adversary": -360.71874499494226, "av": 360.71874499494226}, "time_since_restore": 2813.8069055080414, "episodes_this_iter": 47, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 484.11, "timestamp": 1544504784, "time_total_s": 2813.8069055080414, "done": false, "info": {"grad_time_ms": 8379.444, "load_time_ms": 18.129, "num_steps_trained": 2680000, "adversary": {"vf_explained_var": 0.14842917025089264, "kl": 0.033526454120874405, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.45000001788139343, "vf_loss": 1699.4500732421875, "total_loss": 1699.3802490234375, "entropy": 132.6259307861328, "policy_loss": -0.08507660031318665}, "num_steps_sampled": 2680000, "av": {"vf_explained_var": 0.1480475515127182, "kl": 0.022816935554146767, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1696.291259765625, "total_loss": 1696.2816162109375, "entropy": 3.066657543182373, "policy_loss": -0.0110904760658741}, "update_time_ms": 8.438, "sample_time_ms": 12285.792}, "timesteps_total": 2680000, "date": "2018-12-11_05-06-24", "training_iteration": 134, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.644739389419556, "num_metric_batches_dropped": 0, "iterations_since_restore": 134, "timesteps_since_restore": 2680000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f3bc8d0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 6192}
{"policy_reward_mean": {"adversary": -349.2888157459544, "av": 349.2888157459544}, "time_since_restore": 2834.0470650196075, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 479.43, "timestamp": 1544504805, "time_total_s": 2834.0470650196075, "done": false, "info": {"grad_time_ms": 8367.87, "load_time_ms": 18.629, "num_steps_trained": 2700000, "adversary": {"vf_explained_var": 0.13914139568805695, "kl": 0.03368665650486946, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.45000001788139343, "vf_loss": 1688.8680419921875, "total_loss": 1688.7978515625, "entropy": 132.3446502685547, "policy_loss": -0.08523493260145187}, "num_steps_sampled": 2700000, "av": {"vf_explained_var": 0.14516277611255646, "kl": 0.023799395188689232, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1678.4541015625, "total_loss": 1678.44677734375, "entropy": 3.2025463581085205, "policy_loss": -0.009245728142559528}, "update_time_ms": 8.304, "sample_time_ms": 12245.121}, "timesteps_total": 2700000, "date": "2018-12-11_05-06-45", "training_iteration": 135, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.240159511566162, "num_metric_batches_dropped": 0, "iterations_since_restore": 135, "timesteps_since_restore": 2700000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f4676d8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 6237}
{"policy_reward_mean": {"adversary": -360.53679719303676, "av": 360.53679719303676}, "time_since_restore": 2854.760236263275, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 482.69, "timestamp": 1544504825, "time_total_s": 2854.760236263275, "done": false, "info": {"grad_time_ms": 8372.23, "load_time_ms": 18.631, "num_steps_trained": 2720000, "adversary": {"vf_explained_var": 0.15764082968235016, "kl": 0.032525189220905304, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.45000001788139343, "vf_loss": 1677.2994384765625, "total_loss": 1677.2320556640625, "entropy": 132.56866455078125, "policy_loss": -0.08201993256807327}, "num_steps_sampled": 2720000, "av": {"vf_explained_var": 0.1608055830001831, "kl": 0.019774574786424637, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1687.2313232421875, "total_loss": 1687.221923828125, "entropy": 3.121115207672119, "policy_loss": -0.011080573312938213}, "update_time_ms": 8.316, "sample_time_ms": 12267.214}, "timesteps_total": 2720000, "date": "2018-12-11_05-07-05", "training_iteration": 136, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.713171243667603, "num_metric_batches_dropped": 0, "iterations_since_restore": 136, "timesteps_since_restore": 2720000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f443a20>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 6283}
{"policy_reward_mean": {"adversary": -352.46617442501594, "av": 352.46617442501594}, "time_since_restore": 2875.4135506153107, "episodes_this_iter": 48, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 469.99, "timestamp": 1544504846, "time_total_s": 2875.4135506153107, "done": false, "info": {"grad_time_ms": 8326.851, "load_time_ms": 18.774, "num_steps_trained": 2740000, "adversary": {"vf_explained_var": 0.1534051150083542, "kl": 0.033838462084531784, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.45000001788139343, "vf_loss": 1676.5384521484375, "total_loss": 1676.4693603515625, "entropy": 132.36544799804688, "policy_loss": -0.08419500291347504}, "num_steps_sampled": 2740000, "av": {"vf_explained_var": 0.1530117392539978, "kl": 0.02256743796169758, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1698.3609619140625, "total_loss": 1698.3505859375, "entropy": 3.177635669708252, "policy_loss": -0.01190140936523676}, "update_time_ms": 8.143, "sample_time_ms": 12302.341}, "timesteps_total": 2740000, "date": "2018-12-11_05-07-26", "training_iteration": 137, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.653314352035522, "num_metric_batches_dropped": 0, "iterations_since_restore": 137, "timesteps_since_restore": 2740000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f443320>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 6331}
{"policy_reward_mean": {"adversary": -347.53100773241647, "av": 347.53100773241647}, "time_since_restore": 2895.645288467407, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 468.15, "timestamp": 1544504866, "time_total_s": 2895.645288467407, "done": false, "info": {"grad_time_ms": 8333.571, "load_time_ms": 18.687, "num_steps_trained": 2760000, "adversary": {"vf_explained_var": 0.15056639909744263, "kl": 0.033435747027397156, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.45000001788139343, "vf_loss": 1658.3184814453125, "total_loss": 1658.2501220703125, "entropy": 132.4853973388672, "policy_loss": -0.08333255350589752}, "num_steps_sampled": 2760000, "av": {"vf_explained_var": 0.1509474217891693, "kl": 0.022624632343649864, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1669.1492919921875, "total_loss": 1669.140380859375, "entropy": 3.141449451446533, "policy_loss": -0.010793986730277538}, "update_time_ms": 8.101, "sample_time_ms": 12262.151}, "timesteps_total": 2760000, "date": "2018-12-11_05-07-46", "training_iteration": 138, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.231737852096558, "num_metric_batches_dropped": 0, "iterations_since_restore": 138, "timesteps_since_restore": 2760000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f3239488f98>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 6376}
{"policy_reward_mean": {"adversary": -351.7103069816238, "av": 351.7103069816238}, "time_since_restore": 2916.073306798935, "episodes_this_iter": 49, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 472.77, "timestamp": 1544504887, "time_total_s": 2916.073306798935, "done": false, "info": {"grad_time_ms": 8275.558, "load_time_ms": 18.232, "num_steps_trained": 2780000, "adversary": {"vf_explained_var": 0.1880733221769333, "kl": 0.033942244946956635, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.45000001788139343, "vf_loss": 1703.715576171875, "total_loss": 1703.646240234375, "entropy": 132.6169891357422, "policy_loss": -0.08474281430244446}, "num_steps_sampled": 2780000, "av": {"vf_explained_var": 0.1842953860759735, "kl": 0.020443901419639587, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1707.80810546875, "total_loss": 1707.798095703125, "entropy": 3.0284693241119385, "policy_loss": -0.011485659517347813}, "update_time_ms": 8.089, "sample_time_ms": 12299.964}, "timesteps_total": 2780000, "date": "2018-12-11_05-08-07", "training_iteration": 139, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.42801833152771, "num_metric_batches_dropped": 0, "iterations_since_restore": 139, "timesteps_since_restore": 2780000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f45b7f0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 6425}
{"policy_reward_mean": {"adversary": -346.4787752952914, "av": 346.4787752952914}, "time_since_restore": 2936.3390810489655, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 474.07, "timestamp": 1544504907, "time_total_s": 2936.3390810489655, "done": false, "info": {"grad_time_ms": 8235.482, "load_time_ms": 17.887, "num_steps_trained": 2800000, "adversary": {"vf_explained_var": 0.16737064719200134, "kl": 0.03355075418949127, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.45000001788139343, "vf_loss": 1644.6951904296875, "total_loss": 1644.6258544921875, "entropy": 132.4966278076172, "policy_loss": -0.08435190469026566}, "num_steps_sampled": 2800000, "av": {"vf_explained_var": 0.16591234505176544, "kl": 0.022105595096945763, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1652.349853515625, "total_loss": 1652.3411865234375, "entropy": 3.122905731201172, "policy_loss": -0.010500019416213036}, "update_time_ms": 8.131, "sample_time_ms": 12249.927}, "timesteps_total": 2800000, "date": "2018-12-11_05-08-27", "training_iteration": 140, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.265774250030518, "num_metric_batches_dropped": 0, "iterations_since_restore": 140, "timesteps_since_restore": 2800000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f323946dfd0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 6469}
{"policy_reward_mean": {"adversary": -356.48977149823514, "av": 356.48977149823514}, "time_since_restore": 2956.3144590854645, "episodes_this_iter": 45, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 482.09, "timestamp": 1544504927, "time_total_s": 2956.3144590854645, "done": false, "info": {"grad_time_ms": 8254.481, "load_time_ms": 17.678, "num_steps_trained": 2820000, "adversary": {"vf_explained_var": 0.15941382944583893, "kl": 0.03446591645479202, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.45000001788139343, "vf_loss": 1595.3663330078125, "total_loss": 1595.2969970703125, "entropy": 132.50816345214844, "policy_loss": -0.08477514237165451}, "num_steps_sampled": 2820000, "av": {"vf_explained_var": 0.1643064171075821, "kl": 0.021005779504776, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1604.3321533203125, "total_loss": 1604.323974609375, "entropy": 3.1005187034606934, "policy_loss": -0.009714994579553604}, "update_time_ms": 8.142, "sample_time_ms": 12140.808}, "timesteps_total": 2820000, "date": "2018-12-11_05-08-47", "training_iteration": 141, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 19.975378036499023, "num_metric_batches_dropped": 0, "iterations_since_restore": 141, "timesteps_since_restore": 2820000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f4647b8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 6514}
{"policy_reward_mean": {"adversary": -368.4102714827995, "av": 368.4102714827995}, "time_since_restore": 2976.5603189468384, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 485.56, "timestamp": 1544504947, "time_total_s": 2976.5603189468384, "done": false, "info": {"grad_time_ms": 8243.684, "load_time_ms": 17.451, "num_steps_trained": 2840000, "adversary": {"vf_explained_var": 0.16849051415920258, "kl": 0.03338399529457092, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.45000001788139343, "vf_loss": 1685.8297119140625, "total_loss": 1685.7615966796875, "entropy": 132.5372772216797, "policy_loss": -0.08305515348911285}, "num_steps_sampled": 2840000, "av": {"vf_explained_var": 0.1688191443681717, "kl": 0.02251633070409298, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1709.125, "total_loss": 1709.1162109375, "entropy": 3.118547201156616, "policy_loss": -0.010650265961885452}, "update_time_ms": 8.149, "sample_time_ms": 12096.365}, "timesteps_total": 2840000, "date": "2018-12-11_05-09-07", "training_iteration": 142, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.2458598613739, "num_metric_batches_dropped": 0, "iterations_since_restore": 142, "timesteps_since_restore": 2840000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f45b8d0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 6560}
{"policy_reward_mean": {"adversary": -359.30231814867625, "av": 359.30231814867625}, "time_since_restore": 2996.8993237018585, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 490.03, "timestamp": 1544504968, "time_total_s": 2996.8993237018585, "done": false, "info": {"grad_time_ms": 8257.714, "load_time_ms": 17.722, "num_steps_trained": 2860000, "adversary": {"vf_explained_var": 0.16131198406219482, "kl": 0.03348410502076149, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.45000001788139343, "vf_loss": 1581.5963134765625, "total_loss": 1581.527099609375, "entropy": 132.54522705078125, "policy_loss": -0.08420165628194809}, "num_steps_sampled": 2860000, "av": {"vf_explained_var": 0.16066420078277588, "kl": 0.021177655085921288, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1608.2452392578125, "total_loss": 1608.2362060546875, "entropy": 3.0651774406433105, "policy_loss": -0.010648190043866634}, "update_time_ms": 8.128, "sample_time_ms": 12030.117}, "timesteps_total": 2860000, "date": "2018-12-11_05-09-28", "training_iteration": 143, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.33900475502014, "num_metric_batches_dropped": 0, "iterations_since_restore": 143, "timesteps_since_restore": 2860000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f45b048>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 6604}
{"policy_reward_mean": {"adversary": -347.2057805111976, "av": 347.2057805111976}, "time_since_restore": 3017.511369228363, "episodes_this_iter": 49, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 483.95, "timestamp": 1544504988, "time_total_s": 3017.511369228363, "done": false, "info": {"grad_time_ms": 8256.708, "load_time_ms": 17.54, "num_steps_trained": 2880000, "adversary": {"vf_explained_var": 0.14890724420547485, "kl": 0.033636368811130524, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.45000001788139343, "vf_loss": 1676.8670654296875, "total_loss": 1676.7989501953125, "entropy": 132.47280883789062, "policy_loss": -0.08327145129442215}, "num_steps_sampled": 2880000, "av": {"vf_explained_var": 0.15278743207454681, "kl": 0.02202020026743412, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1711.276611328125, "total_loss": 1711.2659912109375, "entropy": 3.1049201488494873, "policy_loss": -0.01229469757527113}, "update_time_ms": 8.208, "sample_time_ms": 12028.501}, "timesteps_total": 2880000, "date": "2018-12-11_05-09-48", "training_iteration": 144, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.612045526504517, "num_metric_batches_dropped": 0, "iterations_since_restore": 144, "timesteps_since_restore": 2880000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f323948f208>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 6653}
{"policy_reward_mean": {"adversary": -356.90217344352146, "av": 356.90217344352146}, "time_since_restore": 3037.8783383369446, "episodes_this_iter": 42, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 481.16, "timestamp": 1544505009, "time_total_s": 3037.8783383369446, "done": false, "info": {"grad_time_ms": 8246.139, "load_time_ms": 17.205, "num_steps_trained": 2900000, "adversary": {"vf_explained_var": 0.1621033400297165, "kl": 0.033170949667692184, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.45000001788139343, "vf_loss": 1539.7093505859375, "total_loss": 1539.641845703125, "entropy": 132.62973022460938, "policy_loss": -0.08245939761400223}, "num_steps_sampled": 2900000, "av": {"vf_explained_var": 0.16196312010288239, "kl": 0.022137967869639397, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1574.8463134765625, "total_loss": 1574.837646484375, "entropy": 3.092336893081665, "policy_loss": -0.010318395681679249}, "update_time_ms": 8.113, "sample_time_ms": 12052.877}, "timesteps_total": 2900000, "date": "2018-12-11_05-10-09", "training_iteration": 145, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.366969108581543, "num_metric_batches_dropped": 0, "iterations_since_restore": 145, "timesteps_since_restore": 2900000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f3c4c88>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 6695}
{"policy_reward_mean": {"adversary": -357.45500504220536, "av": 357.45500504220536}, "time_since_restore": 3058.857579231262, "episodes_this_iter": 49, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 479.5, "timestamp": 1544505030, "time_total_s": 3058.857579231262, "done": false, "info": {"grad_time_ms": 8237.477, "load_time_ms": 17.245, "num_steps_trained": 2920000, "adversary": {"vf_explained_var": 0.1624494194984436, "kl": 0.034339673817157745, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.45000001788139343, "vf_loss": 1777.7135009765625, "total_loss": 1777.644287109375, "entropy": 132.56211853027344, "policy_loss": -0.08457067608833313}, "num_steps_sampled": 2920000, "av": {"vf_explained_var": 0.16118595004081726, "kl": 0.02399384416639805, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1807.3125, "total_loss": 1807.3016357421875, "entropy": 3.1238365173339844, "policy_loss": -0.012919065542519093}, "update_time_ms": 8.067, "sample_time_ms": 12088.078}, "timesteps_total": 2920000, "date": "2018-12-11_05-10-30", "training_iteration": 146, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.979240894317627, "num_metric_batches_dropped": 0, "iterations_since_restore": 146, "timesteps_since_restore": 2920000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f38dc88>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 6744}
{"policy_reward_mean": {"adversary": -347.6330345555689, "av": 347.6330345555689}, "time_since_restore": 3078.8621180057526, "episodes_this_iter": 48, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 462.59, "timestamp": 1544505050, "time_total_s": 3078.8621180057526, "done": false, "info": {"grad_time_ms": 8225.987, "load_time_ms": 17.14, "num_steps_trained": 2940000, "adversary": {"vf_explained_var": 0.13298499584197998, "kl": 0.034469861537218094, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.45000001788139343, "vf_loss": 1714.906005859375, "total_loss": 1714.837158203125, "entropy": 132.43438720703125, "policy_loss": -0.08454389870166779}, "num_steps_sampled": 2940000, "av": {"vf_explained_var": 0.12959957122802734, "kl": 0.022858763113617897, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1747.1177978515625, "total_loss": 1747.109375, "entropy": 3.178266763687134, "policy_loss": -0.010054432787001133}, "update_time_ms": 8.046, "sample_time_ms": 12035.916}, "timesteps_total": 2940000, "date": "2018-12-11_05-10-50", "training_iteration": 147, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.004538774490356, "num_metric_batches_dropped": 0, "iterations_since_restore": 147, "timesteps_since_restore": 2940000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f32394816d8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 6792}
{"policy_reward_mean": {"adversary": -351.5215582616127, "av": 351.5215582616127}, "time_since_restore": 3099.173497915268, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 471.9, "timestamp": 1544505070, "time_total_s": 3099.173497915268, "done": false, "info": {"grad_time_ms": 8194.76, "load_time_ms": 17.023, "num_steps_trained": 2960000, "adversary": {"vf_explained_var": 0.1556323915719986, "kl": 0.03417074307799339, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.45000001788139343, "vf_loss": 1586.0052490234375, "total_loss": 1585.937255859375, "entropy": 132.09152221679688, "policy_loss": -0.08346254378557205}, "num_steps_sampled": 2960000, "av": {"vf_explained_var": 0.15763354301452637, "kl": 0.021633286029100418, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1610.66943359375, "total_loss": 1610.660888671875, "entropy": 3.22528076171875, "policy_loss": -0.010455322451889515}, "update_time_ms": 8.181, "sample_time_ms": 12075.731}, "timesteps_total": 2960000, "date": "2018-12-11_05-11-10", "training_iteration": 148, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 20.31137990951538, "num_metric_batches_dropped": 0, "iterations_since_restore": 148, "timesteps_since_restore": 2960000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f324f3c44a8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 6838}
{"policy_reward_mean": {"adversary": -350.46158026171025, "av": 350.46158026171025}, "time_since_restore": 3117.019319295883, "episodes_this_iter": 44, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 484.33, "timestamp": 1544505088, "time_total_s": 3117.019319295883, "done": false, "info": {"grad_time_ms": 8031.481, "load_time_ms": 17.017, "num_steps_trained": 2980000, "adversary": {"vf_explained_var": 0.16363050043582916, "kl": 0.033268045634031296, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.45000001788139343, "vf_loss": 1504.8155517578125, "total_loss": 1504.74755859375, "entropy": 132.0026092529297, "policy_loss": -0.08282793313264847}, "num_steps_sampled": 2980000, "av": {"vf_explained_var": 0.16378076374530792, "kl": 0.022046979516744614, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1529.5093994140625, "total_loss": 1529.4996337890625, "entropy": 3.2573750019073486, "policy_loss": -0.011483794078230858}, "update_time_ms": 8.261, "sample_time_ms": 11981.194}, "timesteps_total": 2980000, "date": "2018-12-11_05-11-28", "training_iteration": 149, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 17.845821380615234, "num_metric_batches_dropped": 0, "iterations_since_restore": 149, "timesteps_since_restore": 2980000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f323946dbe0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 6882}
{"policy_reward_mean": {"adversary": -350.1035226341898, "av": 350.1035226341898}, "time_since_restore": 3134.996942281723, "episodes_this_iter": 46, "custom_metrics": {}, "episode_reward_mean": 0.0, "episode_reward_max": 0.0, "timesteps_this_iter": 20000, "experiment_id": "72734abc1b8a41c18326f862030756f1", "node_ip": "172.31.31.96", "episode_len_mean": 479.91, "timestamp": 1544505106, "time_total_s": 3134.996942281723, "done": true, "info": {"grad_time_ms": 7832.51, "load_time_ms": 16.787, "num_steps_trained": 3000000, "adversary": {"vf_explained_var": 0.15988324582576752, "kl": 0.033879633992910385, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.45000001788139343, "vf_loss": 1611.9476318359375, "total_loss": 1611.8795166015625, "entropy": 132.3827667236328, "policy_loss": -0.08329344540834427}, "num_steps_sampled": 3000000, "av": {"vf_explained_var": 0.1575266271829605, "kl": 0.02417806163430214, "cur_lr": 9.999999747378752e-05, "cur_kl_coeff": 0.07499999552965164, "vf_loss": 1631.6258544921875, "total_loss": 1631.6153564453125, "entropy": 3.146751880645752, "policy_loss": -0.012411930598318577}, "update_time_ms": 7.979, "sample_time_ms": 11952.764}, "timesteps_total": 3000000, "date": "2018-12-11_05-11-46", "training_iteration": 150, "hostname": "ip-172-31-31-96", "pid": 3340, "episode_reward_min": 0.0, "time_this_iter_s": 17.977622985839844, "num_metric_batches_dropped": 0, "iterations_since_restore": 150, "timesteps_since_restore": 3000000, "config": {"clip_rewards": null, "num_workers": 10, "optimizer": {}, "observation_filter": "NoFilter", "collect_metrics_timeout": 180, "gamma": 0.999, "train_batch_size": 20000, "use_gae": true, "vf_clip_param": 10.0, "num_cpus_per_worker": 1, "num_envs_per_worker": 1, "vf_share_layers": false, "sample_async": false, "num_gpus_per_worker": 0, "monitor": false, "entropy_coeff": 0.0, "sgd_minibatch_size": 128, "model": {"dim": 84, "lstm_cell_size": 256, "zero_mean": true, "squash_to_range": false, "fcnet_activation": "tanh", "use_lstm": false, "framestack": true, "custom_preprocessor": null, "conv_activation": "relu", "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "conv_filters": null, "custom_options": {}, "grayscale": false, "custom_model": null}, "horizon": 500, "env": "MultiAgentUDSSCMergeEnvReset-v0", "num_cpus_for_driver": 1, "sample_batch_size": 200, "vf_loss_coeff": 1.0, "preprocessor_pref": "deepmind", "clip_param": 0.3, "lambda": 0.97, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.2,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_25\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "log_level": "INFO", "custom_resources_per_worker": {}, "num_sgd_iter": 10, "kl_coeff": 0.2, "clip_actions": false, "num_gpus": 0, "synchronize_filters": true, "kl_target": 0.02, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f323938bf28>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "lr": 0.0001, "batch_mode": "truncate_episodes", "callbacks": {"on_sample_end": null, "on_episode_end": null, "on_train_result": null, "on_episode_start": null, "on_episode_step": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true}, "lr_schedule": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "simple_optimizer": false}, "episodes_total": 6928}
